CREATE FUNCTION [laxreports].[GetCustomFieldTableIntegerValue]
(
	@TABLEID char(36),
	@COLUMNID char(36),
	@OBJECTID char(36),
	@MODULEID int,
	@ROWNUMBER int
)
RETURNS INT
AS
BEGIN
	DECLARE @value int;

	SELECT TOP 1 @value = col.INTVALUE 
		FROM [$(EnerGovDatabase)].dbo.CUSTOMSAVERTBLCOL_INT col 
		INNER JOIN [$(EnerGovDatabase)].dbo.CUSTOMFIELDTABLECOLUMNREF colref ON col.CFTABLECOLUMNREFID = colref.CUSTOMFIELDTABLECOLUMNREFID
		WHERE col.OBJECTID = @OBJECTID AND col.ROWNUMBER = @ROWNUMBER AND colref.CUSTOMFIELDTABLEID = @TABLEID AND colref.CUSTOMFIELDCOLUMNTEMPLATEID = @COLUMNID;

	RETURN @value;

END
