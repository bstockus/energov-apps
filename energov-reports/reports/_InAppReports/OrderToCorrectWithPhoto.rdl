<?xml version="1.0" encoding="utf-8"?>
<Report MustUnderstand="df" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns:df="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition/defaultfontfamily">
  <df:DefaultFontFamily>Segoe UI</df:DefaultFontFamily>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="EnerGov">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString>Data Source=lax-sql1\ENERGOV;Initial Catalog=energov_prod</ConnectString>
        <IntegratedSecurity>true</IntegratedSecurity>
      </ConnectionProperties>
      <rd:SecurityType>Integrated</rd:SecurityType>
      <rd:DataSourceID>f259dc36-27e0-4a1a-84a4-a3947f2802b0</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <DataSets>
    <DataSet Name="CaseViolationsDataSet">
      <Query>
        <DataSourceName>EnerGov</DataSourceName>
        <QueryParameters>
          <QueryParameter Name="@CODECASEID">
            <Value>=Parameters!CODECASEID.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <CommandText>SELECT
    cc.CMCODECASEID,
    cv.CMVIOLATIONID,
    FORMAT(cv.CITATIONISSUEDATE, 'MM/dd/yyyy') + N': ' + cmc.CODENUMBER + N' [' + cvs.NAME + N']' AS Description
FROM [dbo].[CMCODECASE] cc
INNER JOIN [dbo].[CMCODEWFSTEP] cwfs ON cc.CMCODECASEID = cwfs.CMCODECASEID
INNER JOIN [dbo].[CMCODEWFACTIONSTEP] cwfas ON cwfs.CMCODEWFSTEPID = cwfas.CMCODEWFSTEPID
INNER JOIN [dbo].[CMVIOLATION] cv ON cwfas.CMCODEWFACTIONSTEPID = cv.CMCODEWFACTIONID
INNER JOIN [dbo].[CMCODE] cmc ON cv.CMCODEID = cmc.CMCODEID
INNER JOIN [dbo].[CMVIOLATIONSTATUS] cvs ON cv.CMVIOLATIONSTATUSID = cvs.CMVIOLATIONSTATUSID
WHERE cc.CMCODECASEID = @CODECASEID
ORDER BY cv.CITATIONISSUEDATE DESC;</CommandText>
      </Query>
      <Fields>
        <Field Name="CMCODECASEID">
          <DataField>CMCODECASEID</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="CMVIOLATIONID">
          <DataField>CMVIOLATIONID</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Description">
          <DataField>Description</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="FirstCaseViolationsDataSet">
      <Query>
        <DataSourceName>EnerGov</DataSourceName>
        <QueryParameters>
          <QueryParameter Name="@CODECASEID">
            <Value>=Parameters!CODECASEID.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <CommandText>SELECT TOP 1
    cc.CMCODECASEID,
    cv.CMVIOLATIONID,
    FORMAT(cv.CITATIONISSUEDATE, 'MM/dd/yyyy') + N': ' + cmc.CODENUMBER + N' [' + cvs.NAME + N']' AS Description
FROM [dbo].[CMCODECASE] cc
INNER JOIN [dbo].[CMCODEWFSTEP] cwfs ON cc.CMCODECASEID = cwfs.CMCODECASEID
INNER JOIN [dbo].[CMCODEWFACTIONSTEP] cwfas ON cwfs.CMCODEWFSTEPID = cwfas.CMCODEWFSTEPID
INNER JOIN [dbo].[CMVIOLATION] cv ON cwfas.CMCODEWFACTIONSTEPID = cv.CMCODEWFACTIONID
INNER JOIN [dbo].[CMCODE] cmc ON cv.CMCODEID = cmc.CMCODEID
INNER JOIN [dbo].[CMVIOLATIONSTATUS] cvs ON cv.CMVIOLATIONSTATUSID = cvs.CMVIOLATIONSTATUSID
WHERE cc.CMCODECASEID = @CODECASEID
ORDER BY cv.CITATIONISSUEDATE DESC;</CommandText>
      </Query>
      <Fields>
        <Field Name="CMCODECASEID">
          <DataField>CMCODECASEID</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="CMVIOLATIONID">
          <DataField>CMVIOLATIONID</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Description">
          <DataField>Description</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="ViolationsDataSet">
      <Query>
        <DataSourceName>EnerGov</DataSourceName>
        <QueryParameters>
          <QueryParameter Name="@CODECASEID">
            <Value>=Parameters!CODECASEID.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@AttachmentIds">
            <Value>=Parameters!AttachmentIds.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@VIOLATIONID">
            <Value>=Parameters!VIOLATIONID.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <CommandText>WITH CaseAttachments AS (
    SELECT
        @CODECASEID AS CodeCaseId,
        att.FILENAME,
        att.TCMDOCID,
        att.TCMDOCSTATUSID,
        att.ADDEDON,
        att.NOTES,
        ROW_NUMBER() OVER (ORDER BY att.ADDEDON) AS RowNumber
    FROM ATTACHMENT att
    WHERE att.ATTACHMENTID IN (@AttachmentIds)
), GroupedCaseAttachments AS (
    SELECT
        atts.CodeCaseId AS CodeCaseId,
        leftAtts.TCMDOCID AS LeftTCMDocumentId,
        leftAtts.FILENAME AS LeftTCMFileName,
        leftAtts.NOTES AS LeftTCMNotes,
        leftAtts.ADDEDON AS LeftTCMAddedOn,
        rightAtts.TCMDOCID AS RightTCMDocumentId,
        rightAtts.FILENAME AS RightTCMFileName,
        rightAtts.NOTES AS RightTCMNotes,
        rightAtts.ADDEDON AS RightTCMAddedOn
    FROM CaseAttachments atts
    LEFT OUTER JOIN CaseAttachments leftAtts ON leftAtts.RowNumber = atts.RowNumber
    LEFT OUTER JOIN CaseAttachments rightAtts ON rightAtts.RowNumber = atts.RowNumber + 1
    WHERE atts.RowNumber % 2 = 1
), OrderedViolations AS (
    SELECT
        cc.CMCODECASEID AS CodeCaseId,
        cv.CMVIOLATIONID AS ViolationId,
        ROW_NUMBER() OVER (ORDER BY cwfas.STARTDATE ASC, cv.CMVIOLATIONID) AS InstanceNumber
    FROM [dbo].[CMCODECASE] cc
	INNER JOIN [dbo].[CMCODEWFSTEP] cwfs ON cc.CMCODECASEID = cwfs.CMCODECASEID
	INNER JOIN [dbo].[CMCODEWFACTIONSTEP] cwfas ON cwfs.CMCODEWFSTEPID = cwfas.CMCODEWFSTEPID
	INNER JOIN [dbo].[CMVIOLATION] cv ON cwfas.CMCODEWFACTIONSTEPID = cv.CMCODEWFACTIONID
    WHERE cc.CMCODECASEID = @CODECASEID
), ReleventContacts AS (
    SELECT TOP 1
        cmcc.GLOBALENTITYID
    FROM [dbo].[CMCODECASECONTACT] cmcc
    WHERE cmcc.CMCODECASEID = @CODECASEID AND cmcc.CMCODECASECONTACTTYPEID = '3AB42CBB-7DA8-403F-91F3-5F5669386180'
), ReleventContactInfo AS (
    SELECT
        @CODECASEID AS CodeCaseId,
        IIF(cccge.ISCOMPANY = 1, cccge.GLOBALENTITYNAME, cccge.FIRSTNAME + ' ' + cccge.LASTNAME) AS OwnerName,
        LTRIM(RTRIM(
                LTRIM(RTRIM(ma.ADDRESSLINE1)) + ' ' +
                LTRIM(RTRIM(
                    LTRIM(RTRIM(ma.ADDRESSLINE2)) + ' ' +
                    LTRIM(RTRIM(
                        LTRIM(RTRIM(ma.PREDIRECTION)) + ' ' +
                        LTRIM(RTRIM(ma.STREETTYPE)) + ' ' +
                            LTRIM(RTRIM(ma.POSTDIRECTION)))))))) AS MailingAddressLine1,
        LTRIM(RTRIM(
                LTRIM(RTRIM(ma.UNITORSUITE)) + ' ' +
                LTRIM(RTRIM(
                    LTRIM(RTRIM(ma.ADDRESSLINE3)))))) AS MailingAddressLine2,
        LTRIM(RTRIM(
                LTRIM(RTRIM(ma.CITY)) + ', ' +
                LTRIM(RTRIM(
                    LTRIM(RTRIM(ma.STATE)) + ' ' +
                    LTRIM(RTRIM(
                            LTRIM(RTRIM(ma.POSTALCODE)))))))) AS MailingAddressLine3
    FROM ReleventContacts cmcc
    INNER JOIN [dbo].[GLOBALENTITY] cccge ON cmcc.GLOBALENTITYID = cccge.GLOBALENTITYID
    INNER JOIN [dbo].[GLOBALENTITYMAILINGADDRESS] gema ON cccge.GLOBALENTITYID = gema.GLOBALENTITYID AND gema.MAIN = 1
    INNER JOIN [dbo].[MAILINGADDRESS] ma ON gema.MAILINGADDRESSID = ma.MAILINGADDRESSID
)
SELECT
		cc.CMCODECASEID AS CodeCaseId,
		cv.CMVIOLATIONID AS ViolationId,
		cc.CASENUMBER AS CaseNumber,
		ov.InstanceNumber AS ViolationInstanceNumber,
		caseAtts.LeftTCMDocumentId,
		caseAtts.LeftTCMFileName,
        caseAtts.LeftTCMNotes,
        caseAtts.LeftTCMAddedOn,
		caseAtts.RightTCMDocumentId,
		caseAtts.RightTCMFileName,
        caseAtts.RightTCMNotes,
        caseAtts.RightTCMAddedOn,
		rci.MailingAddressLine1,
		rci.MailingAddressLine2,
		rci.MailingAddressLine3,
		rci.OwnerName,
		vlc.LetterText,
		vlc.LetterTitle,
		cv.CORRECTIVEACTION,
		cv.CITATIONISSUEDATE,
		cv.COMPLIANCEDATE,
		(SELECT TOP 1 SVALUE FROM [dbo].[CUSTOMFIELDPICKLISTITEM] WHERE [GCUSTOMFIELDPICKLISTITEM] = cmvcf.MethodOfServing) AS "MethodOfServing",
		ISNULL(cmvcf.DateOTCMailed, cv.CITATIONISSUEDATE) AS "DateOTCMailed",
		(SELECT TOP 1 ins.InspectorSignatureImage FROM laxreports.InspectorSignatures ins
			WHERE ins.InspectorUserId = ISNULL(vlc.OverrideSignature, (SELECT TOP 1 cwfas.LASTCHANGEDBY FROM dbo.CMCODEWFACTIONSTEP cwfas
			INNER JOIN dbo.CMCODEWFSTEP cwfs ON cwfas.CMCODEWFSTEPID = cwfs.CMCODEWFSTEPID
			WHERE cwfas.NAME = 'Issue OTC' AND cwfas.WORKFLOWSTATUSID = 1 AND cwfs.CMCODECASEID = @CODECASEID))) AS "InspectorSignatureImage",
		ISNULL((SELECT TOP 1 cwfas.ENDDATE FROM dbo.CMCODEWFACTIONSTEP cwfas
			INNER JOIN dbo.CMCODEWFSTEP cwfs ON cwfas.CMCODEWFSTEPID = cwfs.CMCODEWFSTEPID
			WHERE cwfas.NAME = 'Issue OTC' AND cwfas.WORKFLOWSTATUSID = 1 AND cwfs.CMCODECASEID = @CODECASEID), cv.CITATIONISSUEDATE) AS "PermitApprovedDate",
		(SELECT TOP 1 u.FNAME FROM dbo.USERS u
			WHERE u.SUSERGUID = ISNULL(vlc.OverrideSignature, (SELECT TOP 1 cwfas.LASTCHANGEDBY FROM dbo.CMCODEWFACTIONSTEP cwfas
			INNER JOIN dbo.CMCODEWFSTEP cwfs ON cwfas.CMCODEWFSTEPID = cwfs.CMCODEWFSTEPID
			WHERE cwfas.NAME = 'Issue OTC' AND cwfas.WORKFLOWSTATUSID = 1 AND cwfs.CMCODECASEID = @CODECASEID))) AS "InspectorFirstName",
		(SELECT TOP 1 u.LNAME FROM dbo.USERS u
			WHERE u.SUSERGUID = ISNULL(vlc.OverrideSignature, (SELECT TOP 1 cwfas.LASTCHANGEDBY FROM dbo.CMCODEWFACTIONSTEP cwfas
			INNER JOIN dbo.CMCODEWFSTEP cwfs ON cwfas.CMCODEWFSTEPID = cwfs.CMCODEWFSTEPID
			WHERE cwfas.NAME = 'Issue OTC' AND cwfas.WORKFLOWSTATUSID = 1 AND cwfs.CMCODECASEID = @CODECASEID))) AS "InspectorLastName",
		(SELECT TOP 1 u.PHONE FROM dbo.USERS u
			WHERE u.SUSERGUID = ISNULL(vlc.OverrideSignature, (SELECT TOP 1 cwfas.LASTCHANGEDBY FROM dbo.CMCODEWFACTIONSTEP cwfas
			INNER JOIN dbo.CMCODEWFSTEP cwfs ON cwfas.CMCODEWFSTEPID = cwfs.CMCODEWFSTEPID
			WHERE cwfas.NAME = 'Issue OTC' AND cwfas.WORKFLOWSTATUSID = 1 AND cwfs.CMCODECASEID = @CODECASEID))) AS "InspectorPhoneNumber",
		(SELECT TOP 1 u.EMAIL FROM dbo.USERS u
			WHERE u.SUSERGUID = ISNULL(vlc.OverrideSignature, (SELECT TOP 1 cwfas.LASTCHANGEDBY FROM dbo.CMCODEWFACTIONSTEP cwfas
			INNER JOIN dbo.CMCODEWFSTEP cwfs ON cwfas.CMCODEWFSTEPID = cwfs.CMCODEWFSTEPID
			WHERE cwfas.NAME = 'Issue OTC' AND cwfas.WORKFLOWSTATUSID = 1 AND cwfs.CMCODECASEID = @CODECASEID))) AS "InspectorEmailAddress",
		cmvcf.AdministrativeCodeSection,
		cmvcf.AdditionalOTCText,
		(SELECT TOP 1 cfpli.SVALUE FROM dbo.CUSTOMSAVERCODEMANAGEMENTMS cscmms
			INNER JOIN dbo.CUSTOMFIELDPICKLISTITEM cfpli ON cscmms.CUSTOMFIELDPICKLISTITEMID = cfpli.GCUSTOMFIELDPICKLISTITEM
			WHERE cscmms.ID = cv.CMVIOLATIONID AND cscmms.CUSTOMFIELDPICKLISTITEMID = '448583f5-2cf8-43c6-bd94-9b321a0fe714') AS "GarbageSection1",
		(SELECT TOP 1 cfpli.SVALUE FROM dbo.CUSTOMSAVERCODEMANAGEMENTMS cscmms
			INNER JOIN dbo.CUSTOMFIELDPICKLISTITEM cfpli ON cscmms.CUSTOMFIELDPICKLISTITEMID = cfpli.GCUSTOMFIELDPICKLISTITEM
			WHERE cscmms.ID = cv.CMVIOLATIONID AND cscmms.CUSTOMFIELDPICKLISTITEMID = '9a601e4f-d816-450a-9e2e-ea8a251ed4eb') AS "GarbageSection2",
		(SELECT TOP 1 cfpli.SVALUE FROM dbo.CUSTOMSAVERCODEMANAGEMENTMS cscmms
			INNER JOIN dbo.CUSTOMFIELDPICKLISTITEM cfpli ON cscmms.CUSTOMFIELDPICKLISTITEMID = cfpli.GCUSTOMFIELDPICKLISTITEM
			WHERE cscmms.ID = cv.CMVIOLATIONID AND cscmms.CUSTOMFIELDPICKLISTITEMID = 'b6eff5ae-aef0-4c3d-a6b2-b90a0d06f656') AS "GarbageSection3",
		(SELECT TOP 1 cfpli.SVALUE FROM dbo.CUSTOMSAVERCODEMANAGEMENTMS cscmms
			INNER JOIN dbo.CUSTOMFIELDPICKLISTITEM cfpli ON cscmms.CUSTOMFIELDPICKLISTITEMID = cfpli.GCUSTOMFIELDPICKLISTITEM
			WHERE cscmms.ID = cv.CMVIOLATIONID AND cscmms.CUSTOMFIELDPICKLISTITEMID = 'ec867c1d-a359-4834-ba95-f3a7d8b2965c') AS "GarbageSection4",
		(SELECT TOP 1 cfpli.SVALUE FROM dbo.CUSTOMSAVERCODEMANAGEMENTMS cscmms
			INNER JOIN dbo.CUSTOMFIELDPICKLISTITEM cfpli ON cscmms.CUSTOMFIELDPICKLISTITEMID = cfpli.GCUSTOMFIELDPICKLISTITEM
			WHERE cscmms.ID = cv.CMVIOLATIONID AND cscmms.CUSTOMFIELDPICKLISTITEMID = cmvcf.NotarizedBy) AS "NotarizedBy",
		cmcf.RentalProperty AS "RentalProperty",
		(SELECT TOP 1 LTRIM(RTRIM(
                LTRIM(RTRIM(ma.ADDRESSLINE1)) + ' ' +
                LTRIM(RTRIM(
                    LTRIM(RTRIM(ma.ADDRESSLINE2)) + ' ' +
                    LTRIM(RTRIM(
                        LTRIM(RTRIM(ma.PREDIRECTION)) + ' ' +
                        LTRIM(RTRIM(ma.STREETTYPE)) + ' ' +
                            LTRIM(RTRIM(ma.POSTDIRECTION
                                ))
                            ))
                        ))

                )) FROM CMCODECASEADDRESS cmcca
		    INNER JOIN MAILINGADDRESS ma ON cmcca.MAILINGADDRESSID = ma.MAILINGADDRESSID
		    WHERE cmcca.CMCODECASEID = cc.CMCODECASEID AND cmcca.MAIN = 1) AS Address,
        (SELECT TOP 1 par.PARCELNUMBER FROM CMCODECASEPARCEL cmccp
            INNER JOIN PARCEL par ON cmccp.PARCELID = par.PARCELID
            WHERE cmccp.CMCODECASEID = cc.CMCODECASEID AND cmccp.[PRIMARY] = 1) AS Parcel,
        (SELECT COUNT(*) FROM CaseAttachments ca WHERE ca.CodeCaseId = cc.CMCODECASEID) AS AttachmentCount
	FROM [dbo].[CMCODECASE] cc
	INNER JOIN [dbo].[CMCODEWFSTEP] cwfs ON cc.CMCODECASEID = cwfs.CMCODECASEID
	INNER JOIN [dbo].[CMCODEWFACTIONSTEP] cwfas ON cwfs.CMCODEWFSTEPID = cwfas.CMCODEWFSTEPID
	INNER JOIN [dbo].[CMVIOLATION] cv ON cwfas.CMCODEWFACTIONSTEPID = cv.CMCODEWFACTIONID
	LEFT OUTER JOIN [dbo].[CUSTOMSAVERCODEMANAGEMENT] cmcf ON cc.CMCODECASEID = cmcf.ID
	LEFT OUTER JOIN [dbo].[CUSTOMSAVERCODEMANAGEMENT] cmvcf ON cv.CMVIOLATIONID = cmvcf.ID
	LEFT OUTER JOIN laxreports.ViolationLetterContents vlc ON cv.CMCODEREVISIONID = vlc.CodeRevisionId
	INNER JOIN ReleventContactInfo rci ON rci.CodeCaseId = cc.CMCODECASEID
	LEFT OUTER JOIN GroupedCaseAttachments caseAtts ON caseAtts.CodeCaseId = @CODECASEID
	INNER JOIN OrderedViolations ov ON ov.CodeCaseId = cc.CMCODECASEID AND ov.ViolationId = cv.CMVIOLATIONID
	WHERE cv.CMVIOLATIONID = @VIOLATIONID;</CommandText>
      </Query>
      <Fields>
        <Field Name="CodeCaseId">
          <DataField>CodeCaseId</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="ViolationId">
          <DataField>ViolationId</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="CaseNumber">
          <DataField>CaseNumber</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="ViolationInstanceNumber">
          <DataField>ViolationInstanceNumber</DataField>
          <rd:TypeName>System.Int64</rd:TypeName>
        </Field>
        <Field Name="LeftTCMDocumentId">
          <DataField>LeftTCMDocumentId</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="LeftTCMFileName">
          <DataField>LeftTCMFileName</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="LeftTCMNotes">
          <DataField>LeftTCMNotes</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="LeftTCMAddedOn">
          <DataField>LeftTCMAddedOn</DataField>
          <rd:TypeName>System.DateTime</rd:TypeName>
        </Field>
        <Field Name="RightTCMDocumentId">
          <DataField>RightTCMDocumentId</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="RightTCMFileName">
          <DataField>RightTCMFileName</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="RightTCMNotes">
          <DataField>RightTCMNotes</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="RightTCMAddedOn">
          <DataField>RightTCMAddedOn</DataField>
          <rd:TypeName>System.DateTime</rd:TypeName>
        </Field>
        <Field Name="MailingAddressLine1">
          <DataField>MailingAddressLine1</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="MailingAddressLine2">
          <DataField>MailingAddressLine2</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="MailingAddressLine3">
          <DataField>MailingAddressLine3</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="OwnerName">
          <DataField>OwnerName</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="LetterText">
          <DataField>LetterText</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="LetterTitle">
          <DataField>LetterTitle</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="CORRECTIVEACTION">
          <DataField>CORRECTIVEACTION</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="CITATIONISSUEDATE">
          <DataField>CITATIONISSUEDATE</DataField>
          <rd:TypeName>System.DateTime</rd:TypeName>
        </Field>
        <Field Name="COMPLIANCEDATE">
          <DataField>COMPLIANCEDATE</DataField>
          <rd:TypeName>System.DateTime</rd:TypeName>
        </Field>
        <Field Name="MethodOfServing">
          <DataField>MethodOfServing</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="DateOTCMailed">
          <DataField>DateOTCMailed</DataField>
          <rd:TypeName>System.DateTime</rd:TypeName>
        </Field>
        <Field Name="InspectorSignatureImage">
          <DataField>InspectorSignatureImage</DataField>
          <rd:TypeName>System.Byte[]</rd:TypeName>
        </Field>
        <Field Name="PermitApprovedDate">
          <DataField>PermitApprovedDate</DataField>
          <rd:TypeName>System.DateTime</rd:TypeName>
        </Field>
        <Field Name="InspectorFirstName">
          <DataField>InspectorFirstName</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="InspectorLastName">
          <DataField>InspectorLastName</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="InspectorPhoneNumber">
          <DataField>InspectorPhoneNumber</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="InspectorEmailAddress">
          <DataField>InspectorEmailAddress</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="AdministrativeCodeSection">
          <DataField>AdministrativeCodeSection</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="AdditionalOTCText">
          <DataField>AdditionalOTCText</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="GarbageSection1">
          <DataField>GarbageSection1</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="GarbageSection2">
          <DataField>GarbageSection2</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="GarbageSection3">
          <DataField>GarbageSection3</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="GarbageSection4">
          <DataField>GarbageSection4</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="NotarizedBy">
          <DataField>NotarizedBy</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="RentalProperty">
          <DataField>RentalProperty</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Address">
          <DataField>Address</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Parcel">
          <DataField>Parcel</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="AttachmentCount">
          <DataField>AttachmentCount</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="HeadersDataSet">
      <Query>
        <DataSourceName>EnerGov</DataSourceName>
        <QueryParameters>
          <QueryParameter Name="@VIOLATIONID">
            <Value>=Parameters!VIOLATIONID.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <CommandText>SELECT TOP 1
		cc.CMCODECASEID AS CodeCaseId,
		cv.CMVIOLATIONID AS ViolationId,
		cc.CASENUMBER AS CaseNumber,
		vlc.DepartmentHeaderId AS DepartmentHeaderType,
		(SELECT TOP 1 dhi.HeaderImage FROM [laxreports].[DepartmentHeaderImages] dhi WHERE dhi.HeaderId = dh.LeftLogoType) AS DepartmentHeaderLeftLogoImage,
		(SELECT TOP 1 dhi.HeaderImage FROM [laxreports].[DepartmentHeaderImages] dhi WHERE dhi.HeaderId = dh.RightLogoType) AS DepartmentHeaderRightLogoImage,
		dh.MainText AS DepartmentHeaderMainText,
		dh.SubMainText AS DepartmentHeaderSubMainText,
		dh.LeftTextLine1 AS DepartmentHeaderLeftTextLine1,
		dh.LeftTextLine2 AS DepartmentHeaderLeftTextLine2,
		dh.RightTextLine1 AS DepartmentHeaderRightTextLine1,
		dh.RightTextLine2 AS DepartmentHeaderRightTextLine2
	FROM [dbo].[CMCODECASE] cc
	INNER JOIN [dbo].[CMCODEWFSTEP] cwfs ON cc.CMCODECASEID = cwfs.CMCODECASEID
	INNER JOIN [dbo].[CMCODEWFACTIONSTEP] cwfas ON cwfs.CMCODEWFSTEPID = cwfas.CMCODEWFSTEPID
	INNER JOIN [dbo].[CMVIOLATION] cv ON cwfas.CMCODEWFACTIONSTEPID = cv.CMCODEWFACTIONID
	LEFT OUTER JOIN [dbo].[CUSTOMSAVERCODEMANAGEMENT] cmcf ON cc.CMCODECASEID = cmcf.ID
	LEFT OUTER JOIN [dbo].[CUSTOMSAVERCODEMANAGEMENT] cmvcf ON cv.CMVIOLATIONID = cmvcf.ID
	LEFT OUTER JOIN laxreports.ViolationLetterContents vlc ON cv.CMCODEREVISIONID = vlc.CodeRevisionId
	LEFT OUTER JOIN laxreports.DepartmentHeaders dh ON vlc.DepartmentHeaderId = dh.Id
	WHERE cv.CMVIOLATIONID = @VIOLATIONID;</CommandText>
      </Query>
      <Fields>
        <Field Name="CodeCaseId">
          <DataField>CodeCaseId</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="ViolationId">
          <DataField>ViolationId</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="CaseNumber">
          <DataField>CaseNumber</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="DepartmentHeaderType">
          <DataField>DepartmentHeaderType</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="DepartmentHeaderLeftLogoImage">
          <DataField>DepartmentHeaderLeftLogoImage</DataField>
          <rd:TypeName>System.Byte[]</rd:TypeName>
        </Field>
        <Field Name="DepartmentHeaderRightLogoImage">
          <DataField>DepartmentHeaderRightLogoImage</DataField>
          <rd:TypeName>System.Byte[]</rd:TypeName>
        </Field>
        <Field Name="DepartmentHeaderMainText">
          <DataField>DepartmentHeaderMainText</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="DepartmentHeaderSubMainText">
          <DataField>DepartmentHeaderSubMainText</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="DepartmentHeaderLeftTextLine1">
          <DataField>DepartmentHeaderLeftTextLine1</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="DepartmentHeaderLeftTextLine2">
          <DataField>DepartmentHeaderLeftTextLine2</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="DepartmentHeaderRightTextLine1">
          <DataField>DepartmentHeaderRightTextLine1</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="DepartmentHeaderRightTextLine2">
          <DataField>DepartmentHeaderRightTextLine2</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="AttachmentsDataSet">
      <Query>
        <DataSourceName>EnerGov</DataSourceName>
        <QueryParameters>
          <QueryParameter Name="@CODECASEID">
            <Value>=Parameters!CODECASEID.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <CommandText>WITH ParentIds AS (
    SELECT
        cmcc.CMCODECASEID AS CodeCaseId,
        cmcc.CMCODECASEID AS ParentId,
        'Code Case' AS SourceDescription
    FROM CMCODECASE cmcc
    WHERE cmcc.CMCODECASEID = @CODECASEID

    UNION ALL
    SELECT
        cmcc.CMCODECASEID AS CodeCaseId,
        ccix.IMINSPECTIONID AS ParentId,
        'Inspection ' + imi.INSPECTIONNUMBER + ' on ' + FORMAT(imi.ACTUALSTARTDATE, 'MM/dd/yyyy') AS SourceDescription
    FROM CMCODECASEINSPECTIONXREF ccix
    INNER JOIN IMINSPECTION imi ON ccix.IMINSPECTIONID = imi.IMINSPECTIONID
    INNER JOIN CMCODECASE cmcc ON ccix.CMCODECASEID = cmcc.CMCODECASEID
    WHERe cmcc.CMCODECASEID = @CODECASEID
)
    SELECT
        att.ATTACHMENTID AS AttachmentId,
        att.FILENAME + ': ' + FORMAT(att.ADDEDON, 'MM/dd/yyyy hh:mm tt') + ' from ' + pids.SourceDescription AS Description
    FROM ATTACHMENT att
    INNER JOIN ParentIds pids ON pids.ParentId = att.PARENTID
    WHERE att.ATTACHMENTGROUPID = '8cd8c9c2-ab97-9026-b1d9-22bb8887f710'
    ORDER BY att.ADDEDON</CommandText>
      </Query>
      <Fields>
        <Field Name="AttachmentId">
          <DataField>AttachmentId</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Description">
          <DataField>Description</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
  </DataSets>
  <ReportSections>
    <ReportSection>
      <Body>
        <ReportItems>
          <Tablix Name="Tablix1">
            <TablixBody>
              <TablixColumns>
                <TablixColumn>
                  <Width>7.5in</Width>
                </TablixColumn>
              </TablixColumns>
              <TablixRows>
                <TablixRow>
                  <Height>4.5631in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Rectangle Name="Rectangle2">
                          <ReportItems>
                            <Textbox Name="Textbox2">
                              <CanGrow>true</CanGrow>
                              <KeepTogether>true</KeepTogether>
                              <Paragraphs>
                                <Paragraph>
                                  <TextRuns>
                                    <TextRun>
                                      <Value>=First(Fields!DepartmentHeaderMainText.Value, "HeadersDataSet")</Value>
                                      <Style>
                                        <FontFamily>Arial Rounded MT Bold</FontFamily>
                                        <FontSize>12pt</FontSize>
                                        <FontWeight>Bold</FontWeight>
                                      </Style>
                                    </TextRun>
                                  </TextRuns>
                                  <Style>
                                    <TextAlign>Center</TextAlign>
                                  </Style>
                                </Paragraph>
                                <Paragraph>
                                  <TextRuns>
                                    <TextRun>
                                      <Value>=First(Fields!DepartmentHeaderSubMainText.Value, "HeadersDataSet")</Value>
                                      <Style>
                                        <FontFamily>Arial</FontFamily>
                                        <FontSize>12pt</FontSize>
                                        <FontWeight>Normal</FontWeight>
                                      </Style>
                                    </TextRun>
                                  </TextRuns>
                                  <Style>
                                    <TextAlign>Center</TextAlign>
                                  </Style>
                                </Paragraph>
                              </Paragraphs>
                              <rd:DefaultName>Textbox2</rd:DefaultName>
                              <Top>0in</Top>
                              <Left>1.06944in</Left>
                              <Height>0.56619in</Height>
                              <Width>5.36111in</Width>
                              <Style>
                                <Border>
                                  <Style>None</Style>
                                </Border>
                                <VerticalAlign>Bottom</VerticalAlign>
                                <PaddingLeft>2pt</PaddingLeft>
                                <PaddingRight>2pt</PaddingRight>
                                <PaddingTop>2pt</PaddingTop>
                                <PaddingBottom>2pt</PaddingBottom>
                              </Style>
                            </Textbox>
                            <Textbox Name="Textbox3">
                              <CanGrow>true</CanGrow>
                              <KeepTogether>true</KeepTogether>
                              <Paragraphs>
                                <Paragraph>
                                  <TextRuns>
                                    <TextRun>
                                      <Value>=First(Fields!DepartmentHeaderLeftTextLine1.Value, "HeadersDataSet")</Value>
                                      <Style>
                                        <FontFamily>Arial</FontFamily>
                                        <FontSize>9pt</FontSize>
                                      </Style>
                                    </TextRun>
                                  </TextRuns>
                                  <Style />
                                </Paragraph>
                                <Paragraph>
                                  <TextRuns>
                                    <TextRun>
                                      <Value>=First(Fields!DepartmentHeaderLeftTextLine2.Value, "HeadersDataSet")</Value>
                                      <Style>
                                        <FontFamily>Arial</FontFamily>
                                        <FontSize>9pt</FontSize>
                                      </Style>
                                    </TextRun>
                                  </TextRuns>
                                  <Style />
                                </Paragraph>
                              </Paragraphs>
                              <rd:DefaultName>Textbox3</rd:DefaultName>
                              <Top>0.58008in</Top>
                              <Left>1.06944in</Left>
                              <Height>0.43382in</Height>
                              <Width>2.44444in</Width>
                              <ZIndex>1</ZIndex>
                              <Style>
                                <Border>
                                  <Style>None</Style>
                                </Border>
                                <VerticalAlign>Bottom</VerticalAlign>
                                <PaddingLeft>2pt</PaddingLeft>
                                <PaddingRight>2pt</PaddingRight>
                                <PaddingTop>2pt</PaddingTop>
                                <PaddingBottom>2pt</PaddingBottom>
                              </Style>
                            </Textbox>
                            <Textbox Name="Textbox5">
                              <CanGrow>true</CanGrow>
                              <KeepTogether>true</KeepTogether>
                              <Paragraphs>
                                <Paragraph>
                                  <TextRuns>
                                    <TextRun>
                                      <Value>=Fields!LetterTitle.Value</Value>
                                      <Style>
                                        <FontFamily>Arial Black</FontFamily>
                                        <FontSize>14pt</FontSize>
                                        <FontWeight>Bold</FontWeight>
                                      </Style>
                                    </TextRun>
                                  </TextRuns>
                                  <Style>
                                    <TextAlign>Center</TextAlign>
                                  </Style>
                                </Paragraph>
                              </Paragraphs>
                              <rd:DefaultName>Textbox5</rd:DefaultName>
                              <Top>1.08334in</Top>
                              <Left>0.12825in</Left>
                              <Height>0.7111in</Height>
                              <Width>7.23016in</Width>
                              <ZIndex>2</ZIndex>
                              <Style>
                                <Border>
                                  <Style>None</Style>
                                </Border>
                                <PaddingLeft>2pt</PaddingLeft>
                                <PaddingRight>2pt</PaddingRight>
                                <PaddingTop>2pt</PaddingTop>
                                <PaddingBottom>2pt</PaddingBottom>
                              </Style>
                            </Textbox>
                            <Textbox Name="Textbox34">
                              <CanGrow>true</CanGrow>
                              <KeepTogether>true</KeepTogether>
                              <Paragraphs>
                                <Paragraph>
                                  <TextRuns>
                                    <TextRun>
                                      <Value>=Fields!OwnerName.Value</Value>
                                      <Style>
                                        <FontFamily>Arial</FontFamily>
                                        <FontSize>14pt</FontSize>
                                        <FontWeight>Bold</FontWeight>
                                      </Style>
                                    </TextRun>
                                  </TextRuns>
                                  <Style />
                                </Paragraph>
                                <Paragraph>
                                  <TextRuns>
                                    <TextRun>
                                      <Value>=Fields!MailingAddressLine1.Value + vbcrlf + IIF(Not(IsNothing(Fields!MailingAddressLine2.Value)) And Len(Fields!MailingAddressLine2.Value) &gt; 0, Fields!MailingAddressLine2.Value + vbcrlf, "") + Fields!MailingAddressLine3.Value</Value>
                                      <Style>
                                        <FontFamily>Arial</FontFamily>
                                        <FontSize>14pt</FontSize>
                                      </Style>
                                    </TextRun>
                                  </TextRuns>
                                  <Style />
                                </Paragraph>
                              </Paragraphs>
                              <rd:DefaultName>Textbox34</rd:DefaultName>
                              <Top>1.86389in</Top>
                              <Left>0.5in</Left>
                              <Height>1.06111in</Height>
                              <Width>4in</Width>
                              <ZIndex>3</ZIndex>
                              <Style>
                                <Border>
                                  <Style>None</Style>
                                </Border>
                                <PaddingLeft>2pt</PaddingLeft>
                                <PaddingRight>2pt</PaddingRight>
                                <PaddingTop>2pt</PaddingTop>
                                <PaddingBottom>2pt</PaddingBottom>
                              </Style>
                            </Textbox>
                            <Image Name="Image7">
                              <Source>Database</Source>
                              <Value>=First(Fields!DepartmentHeaderRightLogoImage.Value, "HeadersDataSet")</Value>
                              <MIMEType>image/png</MIMEType>
                              <Sizing>FitProportional</Sizing>
                              <Left>6.475in</Left>
                              <Height>1in</Height>
                              <Width>1in</Width>
                              <ZIndex>4</ZIndex>
                              <Style>
                                <Border>
                                  <Style>None</Style>
                                </Border>
                              </Style>
                            </Image>
                            <Image Name="PoliceDeptLogo">
                              <Source>Database</Source>
                              <Value>=First(Fields!DepartmentHeaderLeftLogoImage.Value, "HeadersDataSet")</Value>
                              <MIMEType>image/png</MIMEType>
                              <Sizing>FitProportional</Sizing>
                              <Left>0.025in</Left>
                              <Height>1in</Height>
                              <Width>1in</Width>
                              <ZIndex>5</ZIndex>
                              <Style>
                                <Border>
                                  <Style>None</Style>
                                </Border>
                              </Style>
                            </Image>
                            <Textbox Name="Textbox4">
                              <CanGrow>true</CanGrow>
                              <KeepTogether>true</KeepTogether>
                              <Paragraphs>
                                <Paragraph>
                                  <TextRuns>
                                    <TextRun>
                                      <Value>=First(Fields!DepartmentHeaderRightTextLine1.Value, "HeadersDataSet")</Value>
                                      <Style>
                                        <FontFamily>Arial</FontFamily>
                                        <FontSize>9pt</FontSize>
                                      </Style>
                                    </TextRun>
                                  </TextRuns>
                                  <Style>
                                    <TextAlign>Right</TextAlign>
                                  </Style>
                                </Paragraph>
                                <Paragraph>
                                  <TextRuns>
                                    <TextRun>
                                      <Value>=First(Fields!DepartmentHeaderRightTextLine2.Value, "HeadersDataSet")</Value>
                                      <Style>
                                        <FontFamily>Arial</FontFamily>
                                        <FontSize>9pt</FontSize>
                                      </Style>
                                    </TextRun>
                                  </TextRuns>
                                  <Style>
                                    <TextAlign>Right</TextAlign>
                                  </Style>
                                </Paragraph>
                              </Paragraphs>
                              <rd:DefaultName>Textbox3</rd:DefaultName>
                              <Top>0.56619in</Top>
                              <Left>3.97222in</Left>
                              <Height>0.44771in</Height>
                              <Width>2.45834in</Width>
                              <ZIndex>6</ZIndex>
                              <Style>
                                <Border>
                                  <Style>None</Style>
                                </Border>
                                <VerticalAlign>Bottom</VerticalAlign>
                                <PaddingLeft>2pt</PaddingLeft>
                                <PaddingRight>2pt</PaddingRight>
                                <PaddingTop>2pt</PaddingTop>
                                <PaddingBottom>2pt</PaddingBottom>
                              </Style>
                            </Textbox>
                            <Textbox Name="Textbox6">
                              <CanGrow>true</CanGrow>
                              <KeepTogether>true</KeepTogether>
                              <Paragraphs>
                                <Paragraph>
                                  <TextRuns>
                                    <TextRun>
                                      <Value>Case Reference Number: </Value>
                                      <Style>
                                        <FontFamily>Arial Narrow</FontFamily>
                                        <FontSize>8pt</FontSize>
                                      </Style>
                                    </TextRun>
                                    <TextRun>
                                      <Value>=Fields!CaseNumber.Value &amp; "-" &amp; Fields!ViolationInstanceNumber.Value</Value>
                                      <Style>
                                        <FontFamily>Arial Narrow</FontFamily>
                                        <FontSize>8pt</FontSize>
                                        <FontWeight>Bold</FontWeight>
                                      </Style>
                                    </TextRun>
                                  </TextRuns>
                                  <Style />
                                </Paragraph>
                                <Paragraph>
                                  <TextRuns>
                                    <TextRun>
                                      <Value>Property Address: </Value>
                                      <Style>
                                        <FontFamily>Arial Narrow</FontFamily>
                                        <FontSize>8pt</FontSize>
                                        <FontWeight>Normal</FontWeight>
                                      </Style>
                                    </TextRun>
                                    <TextRun>
                                      <Value>=Fields!Address.Value</Value>
                                      <MarkupType>HTML</MarkupType>
                                      <Style>
                                        <FontFamily>Arial Narrow</FontFamily>
                                        <FontSize>8pt</FontSize>
                                        <FontWeight>Bold</FontWeight>
                                      </Style>
                                    </TextRun>
                                  </TextRuns>
                                  <Style />
                                </Paragraph>
                                <Paragraph>
                                  <TextRuns>
                                    <TextRun>
                                      <Value>Property Parcel: </Value>
                                      <MarkupType>HTML</MarkupType>
                                      <Style>
                                        <FontFamily>Arial Narrow</FontFamily>
                                        <FontSize>8pt</FontSize>
                                      </Style>
                                    </TextRun>
                                    <TextRun>
                                      <Value>=Fields!Parcel.Value</Value>
                                      <MarkupType>HTML</MarkupType>
                                      <Style>
                                        <FontFamily>Arial Narrow</FontFamily>
                                        <FontSize>8pt</FontSize>
                                        <FontWeight>Bold</FontWeight>
                                      </Style>
                                    </TextRun>
                                  </TextRuns>
                                  <Style />
                                </Paragraph>
                              </Paragraphs>
                              <rd:DefaultName>Textbox6</rd:DefaultName>
                              <Top>1.86389in</Top>
                              <Left>4.6719in</Left>
                              <Height>1.06111in</Height>
                              <Width>2.68651in</Width>
                              <ZIndex>7</ZIndex>
                              <Style>
                                <Border>
                                  <Style>None</Style>
                                </Border>
                                <PaddingLeft>2pt</PaddingLeft>
                                <PaddingRight>2pt</PaddingRight>
                                <PaddingTop>2pt</PaddingTop>
                                <PaddingBottom>2pt</PaddingBottom>
                              </Style>
                            </Textbox>
                            <Textbox Name="Textbox7">
                              <CanGrow>true</CanGrow>
                              <Paragraphs>
                                <Paragraph>
                                  <TextRuns>
                                    <TextRun>
                                      <Value>=Replace(
	Replace(
		Replace(
			Replace(
				Replace(
					Replace(
						Replace(
							Replace(
								Replace(
									Fields!LetterText.Value, 
									"{AdministrativeCodeSection}", 
									IIF(
										IsNothing(Fields!AdministrativeCodeSection.Value), 
										".", 
										" and pursuant to s.Comm. " &amp; Fields!AdministrativeCodeSection.Value &amp; " of the Wisconsin Administrative Code." &amp; 
											IIF(
												IsNothing(Fields!AdditionalOTCText.Value), 
												"", 
												"&lt;/p&gt;&lt;p&gt;&amp;nbsp;&lt;/p&gt;&lt;p&gt;" &amp; Fields!AdditionalOTCText.Value
											)
										)
									),
								"{AdditionalOTCText}",
								IIF(
									IsNothing(Fields!AdditionalOTCText.Value), 
									"", 
									"&lt;/p&gt;&lt;p&gt;&amp;nbsp;&lt;/p&gt;&lt;p&gt;" &amp; Fields!AdditionalOTCText.Value
								)
							),
							"{InspectorsPhoneNumber}",
							Fields!InspectorPhoneNumber.Value),
						"{GarbageMunicipalCodeSections}",
						"&lt;ul&gt;" &amp;
							IIF(IsNothing(Fields!GarbageSection1.Value), "", "&lt;li&gt;" &amp; Fields!GarbageSection1.Value &amp; "&lt;/li&gt;") &amp;
							IIF(IsNothing(Fields!GarbageSection2.Value), "", "&lt;li&gt;" &amp; Fields!GarbageSection2.Value &amp; "&lt;/li&gt;") &amp;
							IIF(IsNothing(Fields!GarbageSection3.Value), "", "&lt;li&gt;" &amp; Fields!GarbageSection3.Value &amp; "&lt;/li&gt;") &amp;
							IIF(IsNothing(Fields!GarbageSection4.Value), "", "&lt;li&gt;" &amp; Fields!GarbageSection4.Value &amp; "&lt;/li&gt;") &amp;
						"&lt;/ul&gt;"),
					"{InspectorLastName}",
					Fields!InspectorLastName.Value),
				"{InspectorFirstName}",
				Fields!InspectorFirstName.Value),
			"{ViolationComments}",
			Fields!CORRECTIVEACTION.Value),
		"{ComplyByDate}",
		FormatDateTime(Fields!COMPLIANCEDATE.Value, DateFormat.ShortDate)),
	"&lt;p&gt;&amp;nbsp;&lt;/p&gt;",
	"")</Value>
                                      <MarkupType>HTML</MarkupType>
                                      <Style>
                                        <FontFamily>Georgia</FontFamily>
                                        <FontSize>9pt</FontSize>
                                      </Style>
                                    </TextRun>
                                  </TextRuns>
                                  <Style />
                                </Paragraph>
                                <Paragraph>
                                  <TextRuns>
                                    <TextRun>
                                      <Value />
                                      <MarkupType>HTML</MarkupType>
                                      <Style>
                                        <FontFamily>Georgia</FontFamily>
                                        <FontSize>9pt</FontSize>
                                      </Style>
                                    </TextRun>
                                  </TextRuns>
                                  <Style />
                                </Paragraph>
                                <Paragraph>
                                  <TextRuns>
                                    <TextRun>
                                      <Value>This order was served </Value>
                                      <MarkupType>HTML</MarkupType>
                                      <Style>
                                        <FontFamily>Georgia</FontFamily>
                                        <FontSize>9pt</FontSize>
                                      </Style>
                                    </TextRun>
                                    <TextRun>
                                      <Value>=Fields!MethodOfServing.Value</Value>
                                      <MarkupType>HTML</MarkupType>
                                      <Style>
                                        <FontFamily>Georgia</FontFamily>
                                        <FontSize>9pt</FontSize>
                                      </Style>
                                    </TextRun>
                                    <TextRun>
                                      <Value>  on </Value>
                                      <MarkupType>HTML</MarkupType>
                                      <Style>
                                        <FontFamily>Georgia</FontFamily>
                                        <FontSize>9pt</FontSize>
                                      </Style>
                                    </TextRun>
                                    <TextRun>
                                      <Value>=Fields!DateOTCMailed.Value</Value>
                                      <MarkupType>HTML</MarkupType>
                                      <Style>
                                        <FontFamily>Georgia</FontFamily>
                                        <FontSize>9pt</FontSize>
                                        <Format>M/d/yyyy</Format>
                                      </Style>
                                    </TextRun>
                                    <TextRun>
                                      <Value>.</Value>
                                      <MarkupType>HTML</MarkupType>
                                      <Style>
                                        <FontFamily>Georgia</FontFamily>
                                        <FontSize>9pt</FontSize>
                                        <Format>M/d/yyyy</Format>
                                      </Style>
                                    </TextRun>
                                  </TextRuns>
                                  <Style />
                                </Paragraph>
                              </Paragraphs>
                              <rd:DefaultName>Textbox7</rd:DefaultName>
                              <Top>3.11437in</Top>
                              <Left>0.12825in</Left>
                              <Height>0.61541in</Height>
                              <Width>7.23016in</Width>
                              <ZIndex>8</ZIndex>
                              <Style>
                                <Border>
                                  <Style>None</Style>
                                </Border>
                                <PaddingLeft>2pt</PaddingLeft>
                                <PaddingRight>2pt</PaddingRight>
                                <PaddingTop>2pt</PaddingTop>
                                <PaddingBottom>2pt</PaddingBottom>
                              </Style>
                            </Textbox>
                            <Image Name="Image5">
                              <Source>Database</Source>
                              <Value>=Fields!InspectorSignatureImage.Value</Value>
                              <MIMEType>image/png</MIMEType>
                              <Sizing>FitProportional</Sizing>
                              <Top>3.93972in</Top>
                              <Left>1.01389in</Left>
                              <Height>0.5in</Height>
                              <Width>3.62175in</Width>
                              <ZIndex>9</ZIndex>
                              <Style>
                                <Border>
                                  <Style>None</Style>
                                </Border>
                              </Style>
                            </Image>
                            <Line Name="Line1">
                              <Top>3.8425in</Top>
                              <Left>0.13417in</Left>
                              <Height>0in</Height>
                              <Width>7.22424in</Width>
                              <ZIndex>10</ZIndex>
                              <Style>
                                <Border>
                                  <Style>Solid</Style>
                                </Border>
                              </Style>
                            </Line>
                            <Textbox Name="Textbox18">
                              <CanGrow>true</CanGrow>
                              <KeepTogether>true</KeepTogether>
                              <Paragraphs>
                                <Paragraph>
                                  <TextRuns>
                                    <TextRun>
                                      <Value>Inspector:</Value>
                                      <Style />
                                    </TextRun>
                                  </TextRuns>
                                  <Style />
                                </Paragraph>
                              </Paragraphs>
                              <rd:DefaultName>Textbox18</rd:DefaultName>
                              <Top>3.93972in</Top>
                              <Left>0.155in</Left>
                              <Height>0.25in</Height>
                              <Width>0.71528in</Width>
                              <ZIndex>11</ZIndex>
                              <Style>
                                <Border>
                                  <Style>None</Style>
                                </Border>
                                <PaddingLeft>2pt</PaddingLeft>
                                <PaddingRight>2pt</PaddingRight>
                                <PaddingTop>2pt</PaddingTop>
                                <PaddingBottom>2pt</PaddingBottom>
                              </Style>
                            </Textbox>
                            <Textbox Name="Textbox19">
                              <CanGrow>true</CanGrow>
                              <KeepTogether>true</KeepTogether>
                              <Paragraphs>
                                <Paragraph>
                                  <TextRuns>
                                    <TextRun>
                                      <Value>By </Value>
                                      <Style />
                                    </TextRun>
                                    <TextRun>
                                      <Value>=Fields!InspectorFirstName.Value</Value>
                                      <Style />
                                    </TextRun>
                                    <TextRun>
                                      <Value> on </Value>
                                      <Style />
                                    </TextRun>
                                    <TextRun>
                                      <Value>=Fields!CITATIONISSUEDATE.Value</Value>
                                      <Style>
                                        <Format>M/d/yyyy</Format>
                                      </Style>
                                    </TextRun>
                                  </TextRuns>
                                  <Style />
                                </Paragraph>
                              </Paragraphs>
                              <rd:DefaultName>Textbox19</rd:DefaultName>
                              <Top>3.93972in</Top>
                              <Left>4.70508in</Left>
                              <Height>0.5in</Height>
                              <Width>2.65333in</Width>
                              <ZIndex>12</ZIndex>
                              <Style>
                                <Border>
                                  <Style>None</Style>
                                </Border>
                                <PaddingLeft>2pt</PaddingLeft>
                                <PaddingRight>2pt</PaddingRight>
                                <PaddingTop>2pt</PaddingTop>
                                <PaddingBottom>2pt</PaddingBottom>
                              </Style>
                            </Textbox>
                          </ReportItems>
                          <KeepTogether>true</KeepTogether>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                          </Style>
                        </Rectangle>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.11508in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Rectangle Name="Rectangle3">
                          <PageBreak>
                            <BreakLocation>End</BreakLocation>
                          </PageBreak>
                          <KeepTogether>true</KeepTogether>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                          </Style>
                        </Rectangle>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>2.4in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Tablix Name="Tablix2">
                          <TablixBody>
                            <TablixColumns>
                              <TablixColumn>
                                <Width>3.75in</Width>
                              </TablixColumn>
                              <TablixColumn>
                                <Width>3.75in</Width>
                              </TablixColumn>
                            </TablixColumns>
                            <TablixRows>
                              <TablixRow>
                                <Height>2.4in</Height>
                                <TablixCells>
                                  <TablixCell>
                                    <CellContents>
                                      <Rectangle Name="Rectangle6">
                                        <ReportItems>
                                          <Image Name="Image1">
                                            <Source>External</Source>
                                            <Value>="https://energov-apps.cityoflacrosse.org/TcmIntegration/FetchTcmDocumentAsImage?docId=" &amp; Fields!LeftTCMDocumentId.Value &amp; "&amp;width=500"</Value>
                                            <Sizing>Fit</Sizing>
                                            <Height>2in</Height>
                                            <Width>3.75in</Width>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                            </Style>
                                          </Image>
                                          <Textbox Name="Textbox29">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value>=Fields!LeftTCMFileName.Value</Value>
                                                    <Style>
                                                      <FontFamily>Arial</FontFamily>
                                                      <FontSize>8pt</FontSize>
                                                      <FontWeight>Bold</FontWeight>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value>=Fields!LeftTCMNotes.Value</Value>
                                                    <Style>
                                                      <FontStyle>Italic</FontStyle>
                                                      <FontFamily>Arial Narrow</FontFamily>
                                                      <FontSize>7pt</FontSize>
                                                      <FontWeight>Normal</FontWeight>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>Textbox29</rd:DefaultName>
                                            <Top>2in</Top>
                                            <Height>0.4in</Height>
                                            <Width>3.75in</Width>
                                            <ZIndex>1</ZIndex>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </ReportItems>
                                        <KeepTogether>true</KeepTogether>
                                        <Visibility>
                                          <Hidden>=IsNothing(Fields!LeftTCMDocumentId.Value)</Hidden>
                                        </Visibility>
                                        <Style>
                                          <Border>
                                            <Style>None</Style>
                                          </Border>
                                        </Style>
                                      </Rectangle>
                                    </CellContents>
                                  </TablixCell>
                                  <TablixCell>
                                    <CellContents>
                                      <Rectangle Name="Rectangle7">
                                        <ReportItems>
                                          <Image Name="Image3">
                                            <Source>External</Source>
                                            <Value>="https://energov-apps.cityoflacrosse.org/TcmIntegration/FetchTcmDocumentAsImage?docId=" &amp; Fields!RightTCMDocumentId.Value &amp; "&amp;width=500"</Value>
                                            <Sizing>Fit</Sizing>
                                            <Height>2in</Height>
                                            <Width>3.75in</Width>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                            </Style>
                                          </Image>
                                          <Textbox Name="Textbox30">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value>=Fields!RightTCMFileName.Value</Value>
                                                    <Style>
                                                      <FontFamily>Arial</FontFamily>
                                                      <FontSize>8pt</FontSize>
                                                      <FontWeight>Bold</FontWeight>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value>=Fields!RightTCMNotes.Value</Value>
                                                    <Style>
                                                      <FontStyle>Italic</FontStyle>
                                                      <FontFamily>Arial Narrow</FontFamily>
                                                      <FontSize>7pt</FontSize>
                                                      <FontWeight>Normal</FontWeight>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>Textbox30</rd:DefaultName>
                                            <Top>2in</Top>
                                            <Height>0.4in</Height>
                                            <Width>3.75in</Width>
                                            <ZIndex>1</ZIndex>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </ReportItems>
                                        <KeepTogether>true</KeepTogether>
                                        <Visibility>
                                          <Hidden>=IsNothing(Fields!RightTCMDocumentId.Value)</Hidden>
                                        </Visibility>
                                        <Style>
                                          <Border>
                                            <Style>None</Style>
                                          </Border>
                                        </Style>
                                      </Rectangle>
                                    </CellContents>
                                  </TablixCell>
                                </TablixCells>
                              </TablixRow>
                            </TablixRows>
                          </TablixBody>
                          <TablixColumnHierarchy>
                            <TablixMembers>
                              <TablixMember />
                              <TablixMember />
                            </TablixMembers>
                          </TablixColumnHierarchy>
                          <TablixRowHierarchy>
                            <TablixMembers>
                              <TablixMember>
                                <Group Name="Details" />
                                <TablixMembers>
                                  <TablixMember />
                                </TablixMembers>
                                <KeepTogether>true</KeepTogether>
                              </TablixMember>
                            </TablixMembers>
                          </TablixRowHierarchy>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                          </Style>
                        </Tablix>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
              </TablixRows>
            </TablixBody>
            <TablixColumnHierarchy>
              <TablixMembers>
                <TablixMember />
              </TablixMembers>
            </TablixColumnHierarchy>
            <TablixRowHierarchy>
              <TablixMembers>
                <TablixMember>
                  <Group Name="InspectionNumber">
                    <GroupExpressions>
                      <GroupExpression>=Fields!CodeCaseId.Value</GroupExpression>
                    </GroupExpressions>
                  </Group>
                  <SortExpressions>
                    <SortExpression>
                      <Value>=Fields!CaseNumber.Value</Value>
                    </SortExpression>
                  </SortExpressions>
                  <TablixMembers>
                    <TablixMember />
                    <TablixMember>
                      <Visibility>
                        <Hidden>=Fields!AttachmentCount.Value = 0</Hidden>
                      </Visibility>
                    </TablixMember>
                    <TablixMember>
                      <Visibility>
                        <Hidden>=Fields!AttachmentCount.Value = 0</Hidden>
                      </Visibility>
                    </TablixMember>
                  </TablixMembers>
                </TablixMember>
              </TablixMembers>
            </TablixRowHierarchy>
            <DataSetName>ViolationsDataSet</DataSetName>
            <Height>7.07818in</Height>
            <Width>7.5in</Width>
            <Style>
              <Border>
                <Style>None</Style>
              </Border>
            </Style>
          </Tablix>
        </ReportItems>
        <Height>7.17818in</Height>
        <Style>
          <Border>
            <Style>None</Style>
          </Border>
        </Style>
      </Body>
      <Width>7.5in</Width>
      <Page>
        <PageFooter>
          <Height>0.25in</Height>
          <PrintOnFirstPage>true</PrintOnFirstPage>
          <PrintOnLastPage>true</PrintOnLastPage>
          <ReportItems>
            <Textbox Name="Textbox31">
              <CanGrow>true</CanGrow>
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Label>ExecTime</Label>
                      <Value>=Globals!ExecutionTime</Value>
                      <Style>
                        <FontSize>6pt</FontSize>
                        <Format>g</Format>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style>
                    <TextAlign>Right</TextAlign>
                  </Style>
                </Paragraph>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Label>PgNbr</Label>
                      <Value>=Globals!PageNumber</Value>
                      <Style>
                        <FontSize>6pt</FontSize>
                      </Style>
                    </TextRun>
                    <TextRun>
                      <Value>/</Value>
                      <Style>
                        <FontSize>6pt</FontSize>
                      </Style>
                    </TextRun>
                    <TextRun>
                      <Label>TotPgs</Label>
                      <Value>=Globals!TotalPages</Value>
                      <Style>
                        <FontSize>6pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style>
                    <TextAlign>Right</TextAlign>
                  </Style>
                </Paragraph>
              </Paragraphs>
              <rd:DefaultName>Textbox31</rd:DefaultName>
              <Top>0.01389in</Top>
              <Left>3.75in</Left>
              <Height>0.16829in</Height>
              <Width>3.75in</Width>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <VerticalAlign>Bottom</VerticalAlign>
                <PaddingLeft>2pt</PaddingLeft>
                <PaddingRight>2pt</PaddingRight>
                <PaddingTop>2pt</PaddingTop>
                <PaddingBottom>2pt</PaddingBottom>
              </Style>
            </Textbox>
            <Textbox Name="Textbox32">
              <CanGrow>true</CanGrow>
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Label>RptName</Label>
                      <Value>=Globals!ReportFolder &amp; "/" &amp; Globals!ReportName</Value>
                      <Style>
                        <FontFamily>Arial</FontFamily>
                        <FontSize>6pt</FontSize>
                        <Format>g</Format>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style />
                </Paragraph>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value>=Parameters!CODECASEID.Value</Value>
                      <Style>
                        <FontFamily>Arial</FontFamily>
                        <FontSize>6pt</FontSize>
                      </Style>
                    </TextRun>
                    <TextRun>
                      <Value>//</Value>
                      <Style>
                        <FontFamily>Arial</FontFamily>
                        <FontSize>6pt</FontSize>
                      </Style>
                    </TextRun>
                    <TextRun>
                      <Value>=Parameters!VIOLATIONID.Value</Value>
                      <Style>
                        <FontFamily>Arial</FontFamily>
                        <FontSize>6pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style />
                </Paragraph>
              </Paragraphs>
              <rd:DefaultName>Textbox31</rd:DefaultName>
              <Top>0.01389in</Top>
              <Height>0.16829in</Height>
              <Width>3.75in</Width>
              <ZIndex>1</ZIndex>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <VerticalAlign>Bottom</VerticalAlign>
                <PaddingLeft>2pt</PaddingLeft>
                <PaddingRight>2pt</PaddingRight>
                <PaddingTop>2pt</PaddingTop>
                <PaddingBottom>2pt</PaddingBottom>
              </Style>
            </Textbox>
          </ReportItems>
          <Style>
            <Border>
              <Style>None</Style>
            </Border>
          </Style>
        </PageFooter>
        <LeftMargin>0.5in</LeftMargin>
        <RightMargin>0.5in</RightMargin>
        <TopMargin>0.5in</TopMargin>
        <BottomMargin>0.5in</BottomMargin>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <ReportParameters>
    <ReportParameter Name="CODECASEID">
      <DataType>String</DataType>
      <Prompt>CODECASEID</Prompt>
    </ReportParameter>
    <ReportParameter Name="VIOLATIONID">
      <DataType>String</DataType>
      <DefaultValue>
        <DataSetReference>
          <DataSetName>FirstCaseViolationsDataSet</DataSetName>
          <ValueField>CMVIOLATIONID</ValueField>
        </DataSetReference>
      </DefaultValue>
      <Prompt>Violation</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>CaseViolationsDataSet</DataSetName>
          <ValueField>CMVIOLATIONID</ValueField>
          <LabelField>Description</LabelField>
        </DataSetReference>
      </ValidValues>
    </ReportParameter>
    <ReportParameter Name="AttachmentIds">
      <DataType>String</DataType>
      <DefaultValue>
        <DataSetReference>
          <DataSetName>AttachmentsDataSet</DataSetName>
          <ValueField>AttachmentId</ValueField>
        </DataSetReference>
      </DefaultValue>
      <Prompt>Attachment(s)</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>AttachmentsDataSet</DataSetName>
          <ValueField>AttachmentId</ValueField>
          <LabelField>Description</LabelField>
        </DataSetReference>
      </ValidValues>
      <MultiValue>true</MultiValue>
    </ReportParameter>
  </ReportParameters>
  <ReportParametersLayout>
    <GridLayoutDefinition>
      <NumberOfColumns>1</NumberOfColumns>
      <NumberOfRows>3</NumberOfRows>
      <CellDefinitions>
        <CellDefinition>
          <ColumnIndex>0</ColumnIndex>
          <RowIndex>0</RowIndex>
          <ParameterName>CODECASEID</ParameterName>
        </CellDefinition>
        <CellDefinition>
          <ColumnIndex>0</ColumnIndex>
          <RowIndex>1</RowIndex>
          <ParameterName>VIOLATIONID</ParameterName>
        </CellDefinition>
        <CellDefinition>
          <ColumnIndex>0</ColumnIndex>
          <RowIndex>2</RowIndex>
          <ParameterName>AttachmentIds</ParameterName>
        </CellDefinition>
      </CellDefinitions>
    </GridLayoutDefinition>
  </ReportParametersLayout>
  <rd:ReportUnitType>Inch</rd:ReportUnitType>
  <rd:ReportID>be1566e5-5bf2-4a64-b9da-f470d5cf6abe</rd:ReportID>
</Report>