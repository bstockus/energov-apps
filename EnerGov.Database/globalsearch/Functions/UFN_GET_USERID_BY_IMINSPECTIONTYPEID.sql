CREATE FUNCTION [globalsearch].[UFN_GET_USERID_BY_IMINSPECTIONTYPEID]
(
	@IMINSPECTIONTYPEID CHAR(36)
)
RETURNS TABLE
AS
RETURN
	SELECT DISTINCT
		[IMINSPECTORTYPEUSER].[USERID] 
	FROM [dbo].[IMINSPECTORTYPEUSER] WITH (NOLOCK)
		INNER JOIN [dbo].[IMINSPECTORTYPE] WITH (NOLOCK) 
			ON [IMINSPECTORTYPEUSER].[INSPECTORTYPEID]=[IMINSPECTORTYPE].[IMINSPECTORTYPEID]
		INNER JOIN [dbo].[IMINSPECTORTYPEINSPECTIONTYPE] WITH (NOLOCK)
			ON [IMINSPECTORTYPE].[IMINSPECTORTYPEID]  =[IMINSPECTORTYPEINSPECTIONTYPE].[IMINSPECTORTYPEID]
	WHERE [IMINSPECTORTYPEINSPECTIONTYPE].[IMINSPECTIONTYPEID]=@IMINSPECTIONTYPEID