CREATE PROCEDURE [incidentrequest].[USP_IMINSPECTION_SEARCH]
(
@UniqueIDs RecordIDs READONLY
)
AS
BEGIN
	SELECT 
		[IMINSPECTION].[IMINSPECTIONID],
		IMINSPECTION.INSPECTIONNUMBER ,
		IMINSPECTIONTYPE.[NAME] IMINSPECTIONTYPENAME,
		IMINSPECTIONSTATUS.STATUSNAME IMINSPECTIONSTATUSNAME,
		COALESCE(PARCEL.PARCELNUMBER, '') MAINPARCEL,
		COALESCE(MAILINGADDRESS.ADDRESSLINE1, '') ADDRESSLINE1,
		COALESCE(MAILINGADDRESS.ADDRESSLINE2, '') ADDRESSLINE2,
		COALESCE(MAILINGADDRESS.ADDRESSLINE3, '') ADDRESSLINE3,
		COALESCE(MAILINGADDRESS.PREDIRECTION, '') PREDIRECTION,
		COALESCE(MAILINGADDRESS.STREETTYPE, '') STREETTYPE,
		COALESCE(MAILINGADDRESS.POSTDIRECTION, '') POSTDIRECTION,
		COALESCE(MAILINGADDRESS.UNITORSUITE, '') UNITORSUITE,
		COALESCE(MAILINGADDRESS.CITY, '') CITY,
		COALESCE(MAILINGADDRESS.STATE, '') STATE,
		COALESCE(MAILINGADDRESS.POSTALCODE, '') POSTALCODE,
		IMINSPECTION.REQUESTEDDATE,
		IMINSPECTION.SCHEDULEDSTARTDATE,
		IMINSPECTION.SCHEDULEDENDDATE,
		IMINSPECTION.ACTUALSTARTDATE,
		IMINSPECTION.ACTUALENDDATE,
		IMINSPECTIONSTATUS.INDICATESSUCCESS ISSUCCESSFLAG,
		IMINSPECTIONSTATUS.EXTEND_EXPIRE_DATE ISEXTENDEXPIREDATEFLAG,
		IMINSPECTIONSTATUS.CANCELLEDFLAG ISCANCELLEDFLAG,
		IMINSPECTIONSTATUS.INVIOLATIONFLAG ISINVIOLATIONFLAG,
		IMINSPECTIONSTATUS.OUTOFVIOLATIONFLAG ISOUTOFVIOLATIONFLAG,
		IMINSPECTIONSTATUS.PARTIALPASS ISPARTIALPASSFLAG,
		IMINSPECTIONSTATUS.REINSPECTIONFLAG ISREINSPECTIONFLAG,
		IMINSPECTIONSTATUS.SCHEDULEDFLAG ISSCHEDULEDFLAG,
		IMINSPECTIONSTATUS.WAITFLAG ISWAITFLAG
	FROM 
		[IMINSPECTION]
	INNER JOIN @UniqueIDs IMINSPECTIONIDs ON [IMINSPECTION].[IMINSPECTIONID] = IMINSPECTIONIDs.RECORDID
	INNER JOIN [IMINSPECTIONTYPE] ON [IMINSPECTION].[IMINSPECTIONTYPEID] = [IMINSPECTIONTYPE].[IMINSPECTIONTYPEID]
	INNER JOIN [IMINSPECTIONSTATUS] ON [IMINSPECTION].[IMINSPECTIONSTATUSID] = [IMINSPECTIONSTATUS].[IMINSPECTIONSTATUSID]
	LEFT JOIN [IMINSPECTIONPARCEL] ON [IMINSPECTION].[IMINSPECTIONID] = [IMINSPECTIONPARCEL].[IMINSPECTIONID]
	AND [IMINSPECTIONPARCEL].[MAIN] = 1
	LEFT JOIN [PARCEL] ON [IMINSPECTIONPARCEL].[PARCELID] = [PARCEL].[PARCELID]
	LEFT JOIN [IMINSPECTIONADDRESS]	ON [IMINSPECTION].[IMINSPECTIONID] = [IMINSPECTIONADDRESS].[IMINSPECTIONID]
	AND [IMINSPECTIONADDRESS].[MAIN] = 1
	LEFT JOIN [MAILINGADDRESS] ON [IMINSPECTIONADDRESS].[MAILINGADDRESSID] = [MAILINGADDRESS].[MAILINGADDRESSID]
END