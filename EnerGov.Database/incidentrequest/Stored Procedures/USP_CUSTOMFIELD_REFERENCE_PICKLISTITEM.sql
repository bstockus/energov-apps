/*
  Find ComboBox items to get picked item
*/

CREATE PROCEDURE [incidentrequest].[USP_CUSTOMFIELD_REFERENCE_PICKLISTITEM]
	@LayoutId CHAR(36)
AS
BEGIN

	SET NOCOUNT ON;

	SELECT [CUSTOMFIELDOBJECT].[GCUSTOMFIELD],
	       [CUSTOMFIELDPICKLISTITEM].[FKGCUSTOMFIELDPICKLIST],
		   [CUSTOMFIELDPICKLISTITEM].[GCUSTOMFIELDPICKLISTITEM], 
		   [CUSTOMFIELDPICKLISTITEM].[SVALUE],
		   [CUSTOMFIELDPICKLIST].[BALLOWMULTIPLESELECTIONS]
	FROM [CUSTOMFIELDLAYOUT]
	JOIN [CUSTOMFIELDOBJECT] ON [CUSTOMFIELDLAYOUT].[GCUSTOMFIELDLAYOUTS] = [CUSTOMFIELDOBJECT].[FKGCUSTOMFIELDLAYOUT]
	JOIN [CUSTOMFIELDPICKLIST] ON [CUSTOMFIELDOBJECT].[GCUSTOMFIELD] = [CUSTOMFIELDPICKLIST].[FKGCUSTOMFIELD]
	JOIN [CUSTOMFIELDPICKLISTITEM] ON [CUSTOMFIELDPICKLIST].[GCUSTOMFIELDPICKLIST] = [CUSTOMFIELDPICKLISTITEM].[FKGCUSTOMFIELDPICKLIST]
	WHERE [CUSTOMFIELDLAYOUT].[GCUSTOMFIELDLAYOUTS] = @LayoutId
	AND [CUSTOMFIELDPICKLIST].[BALLOWMULTIPLESELECTIONS] = 0
	ORDER BY [CUSTOMFIELDPICKLISTITEM].[FKGCUSTOMFIELDPICKLIST], [CUSTOMFIELDPICKLISTITEM].[IORDER]

END