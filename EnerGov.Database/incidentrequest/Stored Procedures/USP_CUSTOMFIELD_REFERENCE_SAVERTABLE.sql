/*
  Find Table Names for Custom Field
*/

CREATE PROCEDURE [incidentrequest].[USP_CUSTOMFIELD_REFERENCE_SAVERTABLE]
	@CustomSaverTableName AS VARCHAR(100)
AS
BEGIN

	SET NOCOUNT ON;

	SELECT [TABLE_NAME] FROM [INFORMATION_SCHEMA].[TABLES]
	WHERE [TABLE_NAME] LIKE @CustomSaverTableName + '%'
	AND [TABLE_NAME] NOT LIKE '%WS'
	AND EXISTS ( SELECT 'X' 
				 FROM [INFORMATION_SCHEMA].[COLUMNS]
				 WHERE [COLUMN_NAME] != 'ID'
				 AND [INFORMATION_SCHEMA].[TABLES].[TABLE_NAME] = [INFORMATION_SCHEMA].[COLUMNS].[TABLE_NAME] )
	ORDER BY [TABLE_NAME]

END