CREATE PROCEDURE [events].[USP_EVENTQUEUE_GET_CODECASECONTACT]
(
@UNIQUEIDS RecordIDs READONLY
)
AS
BEGIN
	SELECT 
		[CMCODECASECONTACT].[CMCODECASEID],
		[CMCODECASECONTACT].[ISBILLING],
		[GLOBALENTITY].[GLOBALENTITYID],
		[GLOBALENTITY].[GLOBALENTITYNAME],
		[GLOBALENTITY].[FIRSTNAME],
		[GLOBALENTITY].[MIDDLENAME],
		[GLOBALENTITY].[LASTNAME],
		[CMCODECASECONTACTTYPE].NAME AS [CONTACTTYPENAME],
		[CMCONTACTTYPESYSTEM].NAME AS [SYSTEMCONTACTTYPENAME]
	FROM [dbo].[CMCODECASECONTACT] WITH(NOLOCK)
	INNER JOIN @UNIQUEIDS AS [CMCODECASEIDs] ON [dbo].[CMCODECASECONTACT].[CMCODECASEID] = [CMCODECASEIDs].[RECORDID]
	INNER JOIN [dbo].[GLOBALENTITY] WITH(NOLOCK) ON [dbo].[GLOBALENTITY].[GLOBALENTITYID] = [dbo].[CMCODECASECONTACT].[GLOBALENTITYID]
	INNER JOIN [dbo].[CMCODECASECONTACTTYPE] WITH(NOLOCK) ON [dbo].[CMCODECASECONTACTTYPE].[CMCODECASECONTACTTYPEID] = [dbo].[CMCODECASECONTACT].[CMCODECASECONTACTTYPEID]
	LEFT JOIN [dbo].[CMCONTACTTYPESYSTEM] WITH(NOLOCK) ON [dbo].[CMCONTACTTYPESYSTEM].[CMCONTACTTYPESYSTEMID] = [dbo].[CMCODECASECONTACTTYPE].[CMCONTACTTYPESYSTEMID]
END