CREATE PROCEDURE [events].[USP_CODECASE_PAIDEVENT_SELECT_LOOKUP]
(
	@CODECASEID AS CHAR(36) = ''
)
AS
BEGIN  
	SELECT 
		[CAINVOICE].CAINVOICEID INVOICEID,
		[CAINVOICE].INVOICENUMBER,
		COALESCE(SUM([CACOMPUTEDFEE].AMOUNTPAIDTODATE), 0.00) TOTALPAID
	FROM [dbo].[CMCODECASEFEE] 
	INNER JOIN [dbo].[CACOMPUTEDFEE] ON [dbo].[CMCODECASEFEE].CACOMPUTEDFEEID = [dbo].[CACOMPUTEDFEE].CACOMPUTEDFEEID
	INNER JOIN [dbo].[CAINVOICEFEE]  ON [dbo].[CAINVOICEFEE].CACOMPUTEDFEEID = [dbo].[CACOMPUTEDFEE].CACOMPUTEDFEEID
	INNER JOIN [dbo].[CAINVOICE] ON [dbo].[CAINVOICE].CAINVOICEID = [dbo].[CAINVOICEFEE].CAINVOICEID
	WHERE [CMCODECASEFEE].CMCODECASEID = @CODECASEID
	GROUP BY [dbo].[CAINVOICE].CAINVOICEID, [dbo].[CAINVOICE].INVOICENUMBER
	ORDER BY [CAINVOICE].INVOICENUMBER
END