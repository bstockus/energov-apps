CREATE PROCEDURE [communitydevelopmentsetup].[USP_PLPLANTYPEWORKCLASS_GETBYPARENTID]
(
	@PLPLANTYPEID CHAR(36)
)
AS
BEGIN
SET NOCOUNT ON;
SELECT 
	[dbo].[PLPLANTYPEWORKCLASS].[PLPLANTYPEWORKCLASSID],
	[dbo].[PLPLANTYPEWORKCLASS].[PLPLANTYPEID],
	[dbo].[PLPLANTYPEWORKCLASS].[PLPLANWORKCLASSID],
	[dbo].[PLPLANTYPEWORKCLASS].[WFTEMPLATEID],
	[dbo].[PLPLANTYPEWORKCLASS].[CUSTOMFIELDLAYOUTID],
	[dbo].[PLPLANTYPEWORKCLASS].[CAFEETEMPLATEID],
	[dbo].[PLPLANTYPEWORKCLASS].[ONLINECUSTOMFIELDLAYOUTID],
	[dbo].[PLPLANTYPEWORKCLASS].[INTERNETFLAG],
	[dbo].[PLPLANTYPEWORKCLASS].[PLPLANCAPAPPLICATIONTYPEID],
	[dbo].[PLPLANTYPEWORKCLASS].[ISCAPADDRESSREQUIRED],
	[dbo].[PLPLANTYPEWORKCLASS].[PLREVIEWITEMCAPVISIBILITYID],
	[dbo].[PLPLANTYPEWORKCLASS].[FILESETID],
	[dbo].[PLPLANTYPEWORKCLASS].[DEFAULTCASEASSIGNEDTO], 
	[dbo].[PLPLANWORKCLASS].[NAME] AS WORKCLASSNAME,
	[dbo].[WFTEMPLATE].[NAME] AS TEMMPLATENAME, 
	[dbo].[PLPLANCAPAPPLICATIONTYPE].[NAME] AS APPLICATIONTYPE,
	[dbo].[CUSTOMFIELDLAYOUT].[SNAME] AS CUSTOMFIELDLAYOUT,
	[ONLINECUSTOMFIELDLAYOUT].[SNAME] AS ONLINECUSTOMFIELDLAYOUT,
	[FEESTEMPLATE].[CAFEETEMPLATENAME],
	[dbo].[PLREVIEWITEMCAPVISIBILITY].[NAME] AS REVIEWITEMCAPVISIBILITY, 
	[dbo].[FILESET].[NAME] AS FILESET,
	[USERS].[LNAME] + COALESCE(', ' + [USERS].[FNAME], '') AS USERNAME
FROM [dbo].[PLPLANTYPEWORKCLASS]
INNER JOIN [dbo].[PLPLANWORKCLASS] 
	ON [PLPLANWORKCLASS].[PLPLANWORKCLASSID] = [dbo].[PLPLANTYPEWORKCLASS].[PLPLANWORKCLASSID]
INNER JOIN [dbo].[WFTEMPLATE] 
	ON [WFTEMPLATE].[WFTEMPLATEID] = [dbo].[PLPLANTYPEWORKCLASS].[WFTEMPLATEID]
INNER JOIN [dbo].[PLPLANCAPAPPLICATIONTYPE] 
	ON [PLPLANCAPAPPLICATIONTYPE].[PLPLANCAPAPPLICATIONTYPEID] = [dbo].[PLPLANTYPEWORKCLASS].[PLPLANCAPAPPLICATIONTYPEID]
LEFT JOIN [dbo].[CUSTOMFIELDLAYOUT] 
	ON [CUSTOMFIELDLAYOUT].[GCUSTOMFIELDLAYOUTS] = [dbo].[PLPLANTYPEWORKCLASS].[CUSTOMFIELDLAYOUTID]
LEFT JOIN [dbo].[CUSTOMFIELDLAYOUT] [ONLINECUSTOMFIELDLAYOUT]
	ON [ONLINECUSTOMFIELDLAYOUT].[GCUSTOMFIELDLAYOUTS] = [dbo].[PLPLANTYPEWORKCLASS].[ONLINECUSTOMFIELDLAYOUTID]
INNER JOIN [dbo].[PLREVIEWITEMCAPVISIBILITY] 
	ON [PLREVIEWITEMCAPVISIBILITY].[PLREVIEWITEMCAPVISIBILITYID] = [dbo].[PLPLANTYPEWORKCLASS].[PLREVIEWITEMCAPVISIBILITYID]
LEFT JOIN [dbo].[CAFEETEMPLATE] [FEESTEMPLATE]
	ON [FEESTEMPLATE].[CAFEETEMPLATEID] = [dbo].[PLPLANTYPEWORKCLASS].[CAFEETEMPLATEID]
LEFT JOIN [dbo].[FILESET]
	ON [FILESET].[FILESETID] = [dbo].[PLPLANTYPEWORKCLASS].[FILESETID]
LEFT JOIN [USERS]
	ON [USERS].[SUSERGUID] = [PLPLANTYPEWORKCLASS].[DEFAULTCASEASSIGNEDTO]
WHERE
	[dbo].[PLPLANTYPEWORKCLASS].[PLPLANTYPEID] = @PLPLANTYPEID
ORDER BY [dbo].[PLPLANWORKCLASS].[NAME]
END