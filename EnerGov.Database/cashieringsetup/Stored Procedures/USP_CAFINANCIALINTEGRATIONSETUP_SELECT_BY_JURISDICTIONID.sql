CREATE PROCEDURE [cashieringsetup].[USP_CAFINANCIALINTEGRATIONSETUP_SELECT_BY_JURISDICTIONID]
(
	@JURISDICTIONID AS CHAR(36) = NULL
)
AS
SET NOCOUNT ON;
SELECT 
	[dbo].[CAFINANCIALINTEGRATIONSETUP].[NAME],
	[dbo].[CAFINANCIALINTEGRATIONSETUP].[WEBSERVICEURL],
	[dbo].[CAFINANCIALINTEGRATIONSETUP].[USERNAME],
	[dbo].[CAFINANCIALINTEGRATIONSETUP].[PASSWORD],
	[dbo].[CAFINANCIALINTEGRATIONSETUP].[WORKSTATION],
	[dbo].[CAFINANCIALINTEGRATIONSETUP].[FIELDVALUESLAYOUTVERSION],
	[dbo].[CAFINANCIALINTEGRATIONSETUP].[CHARGEINPUTFLDID],
	[dbo].[CAFINANCIALINTEGRATIONSETUP].[CHARGEINPUTFLDNAME],
	[dbo].[CAFINANCIALINTEGRATIONSETUP].[ARCODE],
	[dbo].[CAFINANCIALINTEGRATIONSETUP].[CAFINANCIALINTEGRATIONTYPEID],
	[dbo].[CAFINANCIALINTEGRATIONSETUP].[TENANTNAME],
	[dbo].[CAFINANCIALINTEGRATIONSETUP].[DOMAINNAME],
	[dbo].[CAFINANCIALINTEGRATIONSETUP].[GRANTTYPE],
	[dbo].[CAFINANCIALINTEGRATIONSETUP].[CLIENTID],
	[dbo].[CAFINANCIALINTEGRATIONSETUP].[CLIENTSECRET],
	[dbo].[CAFINANCIALINTEGRATIONSETUP].[CAFINANCIALINTEGRATIONSETUPID]
FROM [dbo].[CAFINANCIALINTEGRATIONSETUP]
WHERE (CASE 
			WHEN (NOT EXISTS(SELECT 1 FROM JURISDICTION WHERE JURISDICTIONID = @JURISDICTIONID AND CAFINANCIALINTEGRATIONSETUPID IS NOT NULL)) 
				 AND [dbo].[CAFINANCIALINTEGRATIONSETUP].[ISDEFAULT] = 1
			THEN 1 
			WHEN [dbo].[CAFINANCIALINTEGRATIONSETUP].[CAFINANCIALINTEGRATIONSETUPID] = (SELECT TOP 1 CAFINANCIALINTEGRATIONSETUPID FROM JURISDICTION WHERE JURISDICTIONID = @JURISDICTIONID) 
			THEN 1 
			ELSE 0 
		END) = 1