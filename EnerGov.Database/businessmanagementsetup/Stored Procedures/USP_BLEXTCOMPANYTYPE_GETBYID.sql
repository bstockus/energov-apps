CREATE PROCEDURE [businessmanagementsetup].[USP_BLEXTCOMPANYTYPE_GETBYID]
(
	@BLEXTCOMPANYTYPEID CHAR(36)
)
AS
BEGIN
SET NOCOUNT ON;
SELECT 
	[dbo].[BLEXTCOMPANYTYPE].[BLEXTCOMPANYTYPEID],
	[dbo].[BLEXTCOMPANYTYPE].[NAME],
	[dbo].[BLEXTCOMPANYTYPE].[DESCRIPTION],
	[dbo].[BLEXTCOMPANYTYPE].[BLEINFORMATID],
	[dbo].[BLEXTCOMPANYTYPE].[CUSTOMFIELDLAYOUTID],
	[dbo].[BLEXTCOMPANYTYPE].[CANAPPLYONLINE],
	[dbo].[BLEXTCOMPANYTYPE].[DEFAULTWEBAPPLYSTATUSID],
	[dbo].[BLEXTCOMPANYTYPE].[ONLINECUSTOMFIELDLAYOUTID],
	[dbo].[BLEXTCOMPANYTYPE].[MANAGEBUSINESSTYPECODES],
	[dbo].[BLEXTCOMPANYTYPE].[REQUIREBUSINESSTYPECODES],
	[dbo].[BLEXTCOMPANYTYPE].[CAPADDRESSREQUIRED],
	(SELECT TOP 1 [dbo].[ATTACHMENTREQFILEREF].[ATTACHMENTGROUPID] FROM [dbo].[ATTACHMENTREQFILEREF]
	WHERE [dbo].[ATTACHMENTREQFILEREF].[OBJECTTYPEID] = [dbo].[BLEXTCOMPANYTYPE].[BLEXTCOMPANYTYPEID]) AS [ATTACHMENTGROUPID],
	[dbo].[BLEXTCOMPANYTYPE].[LASTCHANGEDBY],
	[dbo].[BLEXTCOMPANYTYPE].[LASTCHANGEDON],
	[dbo].[BLEXTCOMPANYTYPE].[ROWVERSION],
	[dbo].[BLEXTCOMPANYTYPE].[BLEXTCOMPANYTYPEMODULEID],
    (SELECT [businessmanagementsetup].[USF_HAS_BLEXTCOMPANYTYPE_USED_BY_BLEXTCOMPANYTYPEID]([dbo].[BLEXTCOMPANYTYPE].[BLEXTCOMPANYTYPEID])) AS HASUSED,
	[dbo].[BLEXTCOMPANYTYPE].[CAFEETEMPLATEID]
FROM [dbo].[BLEXTCOMPANYTYPE]
WHERE
	[dbo].[BLEXTCOMPANYTYPE].[BLEXTCOMPANYTYPEID] = @BLEXTCOMPANYTYPEID  

	EXEC [businessmanagementsetup].[USP_BLCONTACTTYPEREF_GETBYPARENTID] @BLEXTCOMPANYTYPEID
	EXEC [businessmanagementsetup].[USP_ATTACHMENTREQFILEREF_GETBYPARENTID] @BLEXTCOMPANYTYPEID

END