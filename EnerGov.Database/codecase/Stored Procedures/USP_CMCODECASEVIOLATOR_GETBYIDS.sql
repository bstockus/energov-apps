CREATE PROCEDURE [codecase].[USP_CMCODECASEVIOLATOR_GETBYIDS]
	@CMCODECASELIST RecordIDs READONLY,
	@ROLEID AS CHAR(36)
AS
	BEGIN
	SELECT	
	[CMCODECASECONTACT].[CMCODECASEID],
	[CMCODECASECONTACT].[GLOBALENTITYID],
	[GLOBALENTITY].[LASTNAME],
	[GLOBALENTITY].[GLOBALENTITYNAME],						
	[GLOBALENTITY].[FIRSTNAME],
	VIOLATORTYPENAME = (SELECT TOP 1 [dbo].[CMCODECASECONTACTTYPE].[NAME]
		FROM [dbo].[CMCODECASECONTACTTYPE] 	
		WHERE [dbo].[CMCODECASECONTACTTYPE].[CMCONTACTTYPESYSTEMID] = 2  --FOR 'VIOLATION'
		AND [CMCODECASECONTACT].[CMCODECASEID] = [CMCODECASELIST].[RECORDID]),
	[CMCODECASECONTACTTYPE].[CMCODECASECONTACTTYPEID],	
	ISHIDDENCONTACT = (SELECT [codecase].[UFN_CHECK_CODECASE_HIDDENCONTACT] ([CMCODECASECONTACT].[CMCODECASECONTACTTYPEID], @ROLEID))
	FROM [dbo].[CMCODECASECONTACT]
			JOIN [dbo].[GLOBALENTITY] ON [CMCODECASECONTACT].[GLOBALENTITYID] = [GLOBALENTITY].[GLOBALENTITYID]
			JOIN [dbo].[CMCODECASECONTACTTYPE] ON [CMCODECASECONTACTTYPE].[CMCODECASECONTACTTYPEID] = [CMCODECASECONTACT].[CMCODECASECONTACTTYPEID]
			JOIN @CMCODECASELIST CMCODECASELIST ON [CMCODECASECONTACT].[CMCODECASEID] = [CMCODECASELIST].[RECORDID]
	WHERE [CMCODECASECONTACTTYPE].[CMCONTACTTYPESYSTEMID] = 2  --FOR 'VIOLATION'
END