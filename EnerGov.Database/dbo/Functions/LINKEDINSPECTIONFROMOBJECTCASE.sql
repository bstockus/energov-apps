CREATE FUNCTION [DBO].[LINKEDINSPECTIONFROMOBJECTCASE]
(	
	@ENTITY_ID char(36),
	@USER_ID char(36)
)
RETURNS TABLE 
AS
RETURN 
(
	SELECT IMINSPECTIONID from IMINSPECTION 
	INNER JOIN PMPERMITOBJECT ON [IMINSPECTION].[LINKID] = [PMPERMITOBJECT].[PMPERMITID]
	INNER JOIN GETUSERVISIBLERECORDTYPES(@USER_ID) u on IMINSPECTION.IMINSPECTIONTYPEID = u.RECORDTYPEID
	where [PMPERMITOBJECT].[OMOBJECTID] = @ENTITY_ID
	UNION ALL
	SELECT IMINSPECTIONID from IMINSPECTION 
	INNER JOIN PLPLANOBJECT ON [IMINSPECTION].[LINKID] = [PLPLANOBJECT].[PLPLANID]
	INNER JOIN GETUSERVISIBLERECORDTYPES(@USER_ID) u on IMINSPECTION.IMINSPECTIONTYPEID = u.RECORDTYPEID
	where [PLPLANOBJECT].[OMOBJECTID] = @ENTITY_ID
)