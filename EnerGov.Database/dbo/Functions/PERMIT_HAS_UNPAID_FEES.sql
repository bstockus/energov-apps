

CREATE FUNCTION [dbo].[PERMIT_HAS_UNPAID_FEES]
(
	@PMPERMIT_ID CHAR(36)
)
RETURNS BIT
AS
BEGIN
	DECLARE @RESULT AS BIT
	SET @RESULT = 0
	
	IF (EXISTS(SELECT * FROM PMPERMITFEE 
					INNER JOIN CACOMPUTEDFEE ON CACOMPUTEDFEE.CACOMPUTEDFEEID = PMPERMITFEE.CACOMPUTEDFEEID
					WHERE PMPERMITFEE.PMPERMITID = @PMPERMIT_ID AND CACOMPUTEDFEE.CASTATUSID IN (6,7,8)))
	BEGIN
		SET @RESULT = 1
	END

	RETURN @RESULT
END
