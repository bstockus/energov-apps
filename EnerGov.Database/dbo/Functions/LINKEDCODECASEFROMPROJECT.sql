CREATE FUNCTION DBO.LINKEDCODECASEFROMPROJECT
(	
	@ENTITY_ID char(36),
	@USER_ID char(36)
)
RETURNS TABLE 
AS
RETURN 
(
	Select CMCODECASE.CMCODECASEID, 1 AS ISCHILD, 0 AS ISPARENT FROM PRPROJECTCODECASE
	INNER JOIN CMCODECASE ON PRPROJECTCODECASE.CMCODECASEID = CMCODECASE.CMCODECASEID 
	INNER JOIN GETUSERVISIBLERECORDTYPES(@USER_ID) u on CMCODECASE.CMCASETYPEID = u.RECORDTYPEID
	WHERE(PRPROJECTCODECASE.PRPROJECTID = @ENTITY_ID)
)