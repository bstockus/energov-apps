CREATE TABLE [dbo].[SESSIONRECORD] (
    [SESSIONID]  CHAR (36) NOT NULL,
    [FORMID]     CHAR (36) NOT NULL,
    [RECORDID]   CHAR (36) NOT NULL,
    [ROWVERSION] INT       NOT NULL,
    [ISEDIT]     BIT       CONSTRAINT [DF_SessionRecord_IsEdit] DEFAULT ((0)) NOT NULL,
    [ACTIVETIME] DATETIME  NOT NULL,
    [USERID]     CHAR (36) NOT NULL,
    CONSTRAINT [PK_SessionRecord_1] PRIMARY KEY CLUSTERED ([SESSIONID] ASC, [FORMID] ASC, [RECORDID] ASC) WITH (FILLFACTOR = 80),
    CONSTRAINT [FK_SessionRecord_Sessions] FOREIGN KEY ([SESSIONID]) REFERENCES [dbo].[SESSIONS] ([SESSIONID]) ON DELETE CASCADE,
    CONSTRAINT [FK_SessionRecord_Users] FOREIGN KEY ([USERID]) REFERENCES [dbo].[USERS] ([SUSERGUID])
);


GO
ALTER TABLE [dbo].[SESSIONRECORD] SET (LOCK_ESCALATION = DISABLE);


GO
CREATE NONCLUSTERED INDEX [IX_SESSIONRECORD_RECORDID]
    ON [dbo].[SESSIONRECORD]([RECORDID] ASC, [FORMID] ASC) WITH (FILLFACTOR = 80);


GO
CREATE NONCLUSTERED INDEX [IX_SESSIONRECORD_ROWVERSION]
    ON [dbo].[SESSIONRECORD]([RECORDID] ASC, [ROWVERSION] DESC, [ISEDIT] ASC) WITH (FILLFACTOR = 80);


GO
CREATE NONCLUSTERED INDEX [IX_SESSIONRECORD_FORMID]
    ON [dbo].[SESSIONRECORD]([FORMID] ASC);


GO
CREATE NONCLUSTERED INDEX [IX_SESSIONRECORD_ISEDIT_ACTIVETIME]
    ON [dbo].[SESSIONRECORD]([ISEDIT] ASC, [ACTIVETIME] ASC);

