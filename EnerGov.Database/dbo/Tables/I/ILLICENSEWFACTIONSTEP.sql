CREATE TABLE [dbo].[ILLICENSEWFACTIONSTEP] (
    [ILLICENSEWFACTIONSTEPID]       CHAR (36)       NOT NULL,
    [ILLICENSEWFSTEPID]             CHAR (36)       NOT NULL,
    [WFACTIONTYPEID]                INT             NOT NULL,
    [DESCRIPTION]                   NVARCHAR (MAX)  NULL,
    [PRIORITYORDER]                 INT             NOT NULL,
    [STARTDATE]                     DATETIME        NULL,
    [ENDDATE]                       DATETIME        NULL,
    [ROWVERSION]                    INT             NOT NULL,
    [LASTCHANGEDON]                 DATETIME        NOT NULL,
    [LASTCHANGEDBY]                 CHAR (36)       NOT NULL,
    [WORKFLOWSTATUSID]              INT             NOT NULL,
    [LOCATION]                      NVARCHAR (50)   NULL,
    [EXPECTEDDURATIONHOURS]         DECIMAL (6, 2)  NULL,
    [EVENTDATE]                     DATETIME        NULL,
    [NAME]                          NVARCHAR (100)  NOT NULL,
    [HEARINGTYPEID]                 CHAR (36)       NULL,
    [PASSDESCRIPTION]               NVARCHAR (30)   NOT NULL,
    [FAILDESCRIPTION]               NVARCHAR (30)   NOT NULL,
    [ALLOWREDO]                     BIT             NOT NULL,
    [REDODESCRIPTION]               NVARCHAR (30)   NULL,
    [ICON]                          VARBINARY (MAX) NULL,
    [DAYSTOCOMPLETE]                INT             NULL,
    [PLSUBMITTALTYPEID]             CHAR (36)       NULL,
    [MEETINGTYPEID]                 CHAR (36)       NULL,
    [ILLICENSEWFPARENTACTIONSTEPID] CHAR (36)       NULL,
    [VERSIONNUMBER]                 INT             NULL,
    [SORTORDER]                     INT             NOT NULL,
    [GENERALREASON]                 NVARCHAR (MAX)  NULL,
    [AUTORECEIVE]                   BIT             NOT NULL,
    [AUTOCOMPLETED]                 BIT             NOT NULL,
    [WORKFLOWCOMPLETETYPEID]        INT             NULL,
    [IMINSPECTIONTYPEID]            CHAR (36)       NULL,
    [PMPERMITTYPEID]                CHAR (36)       NULL,
    [PMPERMITWORKCLASSID]           CHAR (36)       NULL,
    [RPTREPORTID]                   CHAR (36)       NULL,
    [PLPLANTYPEID]                  CHAR (36)       NULL,
    [PLPLANWORKCLASSID]             CHAR (36)       NULL,
    [ILLICENSEACTIVITYTYPEID]       CHAR (36)       NULL,
    [TASKTYPEID]                    CHAR (36)       NULL,
    [NOPRIORITY]                    BIT             CONSTRAINT [DF_ILLICENSEWFACTIONSTEP_NOPRIORITY] DEFAULT ((0)) NOT NULL,
    [DUEDATE]                       DATETIME        NULL,
    [EXAMTYPEID]                    CHAR (36)       NULL,
    [CAFEETEMPLATEID]               CHAR (36)       NULL,
    [ISAUTOINVOICE]                 BIT             CONSTRAINT [DF_ILLICENSEWFACTIONSTEP_ISAUTOINVOICE] DEFAULT ((0)) NOT NULL,
    [ISREQUIREDFULLPAYMNENT]        BIT             CONSTRAINT [DF_ILLICENSEWFACTIONSTEP_ISREQUIRED] DEFAULT ((0)) NOT NULL,
    [PARENTINSPECTIONNUMBER]        NVARCHAR (50)   NULL,
    [COMPUTEFEEACTIONTYPEID]        INT             DEFAULT ((0)) NULL,
    [ISUSEACTIONDATEASFEEDATE]      BIT             DEFAULT ((0)) NOT NULL,
    [ISCOMPUTEMAINFEETEMPLATE]      BIT             DEFAULT ((0)) NOT NULL,
    [INSPECTIONSET]                 INT             CONSTRAINT [DF_ILLICENSEWFACTIONSTEP_SET] DEFAULT ((0)) NOT NULL,
    [CMCASETYPEID]                  CHAR (36)       NULL,
    CONSTRAINT [PK_ILLICENSEWFACTIONSTEP] PRIMARY KEY CLUSTERED ([ILLICENSEWFACTIONSTEPID] ASC) WITH (FILLFACTOR = 90),
    CONSTRAINT [FK_ILACTSTEP_CMCASETYPE] FOREIGN KEY ([CMCASETYPEID]) REFERENCES [dbo].[CMCASETYPE] ([CMCASETYPEID]),
    CONSTRAINT [FK_ILLICENSEACTSTEP_EXAMTYPE] FOREIGN KEY ([EXAMTYPEID]) REFERENCES [dbo].[EXAMTYPE] ([EXAMTYPEID]),
    CONSTRAINT [FK_ILLICENSEWFACTIONSTEP_CAFEETEMPLATE] FOREIGN KEY ([CAFEETEMPLATEID]) REFERENCES [dbo].[CAFEETEMPLATE] ([CAFEETEMPLATEID]),
    CONSTRAINT [FK_ILLICENSEWFACTIONSTEP_USERS] FOREIGN KEY ([LASTCHANGEDBY]) REFERENCES [dbo].[USERS] ([SUSERGUID]),
    CONSTRAINT [FK_ILLICWFACTSTEP_HEARINGTYPE] FOREIGN KEY ([HEARINGTYPEID]) REFERENCES [dbo].[HEARINGTYPE] ([HEARINGTYPEID]),
    CONSTRAINT [FK_ILLICWFACTSTEP_ILLICACTTYPE] FOREIGN KEY ([ILLICENSEACTIVITYTYPEID]) REFERENCES [dbo].[ILLICENSEACTIVITYTYPE] ([ILLICENSEACTIVITYTYPEID]),
    CONSTRAINT [FK_ILLICWFACTSTEP_ILLICWFACTSTEP] FOREIGN KEY ([ILLICENSEWFPARENTACTIONSTEPID]) REFERENCES [dbo].[ILLICENSEWFACTIONSTEP] ([ILLICENSEWFACTIONSTEPID]),
    CONSTRAINT [FK_ILLICWFACTSTEP_ILLICWFSTEP] FOREIGN KEY ([ILLICENSEWFSTEPID]) REFERENCES [dbo].[ILLICENSEWFSTEP] ([ILLICENSEWFSTEPID]),
    CONSTRAINT [FK_ILLICWFACTSTEP_IMINSPECTTYPE] FOREIGN KEY ([IMINSPECTIONTYPEID]) REFERENCES [dbo].[IMINSPECTIONTYPE] ([IMINSPECTIONTYPEID]),
    CONSTRAINT [FK_ILLICWFACTSTEP_MEETTYPE] FOREIGN KEY ([MEETINGTYPEID]) REFERENCES [dbo].[MEETINGTYPE] ([MEETINGTYPEID]),
    CONSTRAINT [FK_ILLICWFACTSTEP_PLSUBTYPE] FOREIGN KEY ([PLSUBMITTALTYPEID]) REFERENCES [dbo].[PLSUBMITTALTYPE] ([PLSUBMITTALTYPEID]),
    CONSTRAINT [FK_ILLICWFACTSTEP_PLTYPE] FOREIGN KEY ([PLPLANTYPEID]) REFERENCES [dbo].[PLPLANTYPE] ([PLPLANTYPEID]),
    CONSTRAINT [FK_ILLICWFACTSTEP_PLWKCLASS] FOREIGN KEY ([PLPLANWORKCLASSID]) REFERENCES [dbo].[PLPLANWORKCLASS] ([PLPLANWORKCLASSID]),
    CONSTRAINT [FK_ILLICWFACTSTEP_PMPERMITTYPE] FOREIGN KEY ([PMPERMITTYPEID]) REFERENCES [dbo].[PMPERMITTYPE] ([PMPERMITTYPEID]),
    CONSTRAINT [FK_ILLICWFACTSTEP_PMWKCLASS] FOREIGN KEY ([PMPERMITWORKCLASSID]) REFERENCES [dbo].[PMPERMITWORKCLASS] ([PMPERMITWORKCLASSID]),
    CONSTRAINT [FK_ILLICWFACTSTEP_RPTREPORT] FOREIGN KEY ([RPTREPORTID]) REFERENCES [dbo].[RPTREPORT] ([RPTREPORTID]),
    CONSTRAINT [FK_ILLICWFACTSTEP_TASKTYPE] FOREIGN KEY ([TASKTYPEID]) REFERENCES [dbo].[TASKTYPE] ([TASKTYPEID]),
    CONSTRAINT [FK_ILLICWFACTSTEP_WFACTTYPE] FOREIGN KEY ([WFACTIONTYPEID]) REFERENCES [dbo].[WFACTIONTYPE] ([WFACTIONTYPEID]),
    CONSTRAINT [FK_ILLICWFACTSTEP_WFCOMTYPE] FOREIGN KEY ([WORKFLOWCOMPLETETYPEID]) REFERENCES [dbo].[WORKFLOWCOMPLETETYPE] ([WORKFLOWCOMPLETETYPEID]),
    CONSTRAINT [FK_ILLICWFACTSTEP_WFSTATUS] FOREIGN KEY ([WORKFLOWSTATUSID]) REFERENCES [dbo].[WORKFLOWSTATUS] ([WORKFLOWSTATUSID]),
    CONSTRAINT [FK_ILWFACT_ACTIONTYPEID] FOREIGN KEY ([COMPUTEFEEACTIONTYPEID]) REFERENCES [dbo].[WFACTIONSYSTEMTYPE] ([WFACTIONSYSTEMTYPEID])
);


GO
CREATE NONCLUSTERED INDEX [ILLICENSEWFPARENTACTIONSTEPID_IDX]
    ON [dbo].[ILLICENSEWFACTIONSTEP]([ILLICENSEWFPARENTACTIONSTEPID] ASC) WITH (FILLFACTOR = 90);


GO
CREATE NONCLUSTERED INDEX [IX_ILLICENSEACTSTEP_STEP]
    ON [dbo].[ILLICENSEWFACTIONSTEP]([ILLICENSEWFSTEPID] ASC) WITH (FILLFACTOR = 90);


GO
CREATE NONCLUSTERED INDEX [IMPORT1]
    ON [dbo].[ILLICENSEWFACTIONSTEP]([ILLICENSEWFSTEPID] ASC) WITH (FILLFACTOR = 90);


GO
CREATE NONCLUSTERED INDEX [IMPORT2]
    ON [dbo].[ILLICENSEWFACTIONSTEP]([IMINSPECTIONTYPEID] ASC) WITH (FILLFACTOR = 90);


GO
CREATE NONCLUSTERED INDEX [IX_ILLICENSEWFACTIONSTEP_WORKFLOWSTATUSID]
    ON [dbo].[ILLICENSEWFACTIONSTEP]([WORKFLOWSTATUSID] ASC)
    INCLUDE([ILLICENSEWFACTIONSTEPID], [VERSIONNUMBER]);

