CREATE TABLE [dbo].[GISHISTORYQUEUE] (
    [GISHISTORYQUEUEID] CHAR (36)      NOT NULL,
    [MODULENAME]        VARCHAR (50)   NOT NULL,
    [CASEID]            CHAR (36)      NOT NULL,
    [CASENUMBER]        VARCHAR (200)  NOT NULL,
    [CASETYPE]          CHAR (36)      NOT NULL,
    [WORKCLASS]         CHAR (36)      NULL,
    [APPLICATIONDATE]   DATETIME       NULL,
    [PROJECTID]         CHAR (36)      NULL,
    [PROJECTNAME]       NVARCHAR (100) NULL,
    [SPATIALTYPE]       VARCHAR (50)   NOT NULL,
    [SPATIALID]         VARCHAR (150)  NOT NULL,
    [ISWRITTENTOGIS]    BIT            CONSTRAINT [DF_GISHistoryQueue_isWrittentoGIS] DEFAULT ((0)) NOT NULL,
    [CREATEDATE]        DATETIME       DEFAULT (getdate()) NOT NULL,
    [PROCESSEDDATE]     DATETIME       NULL,
    [RESULTLOG]         NVARCHAR (MAX) NULL,
    [RETRYCOUNT]        INT            DEFAULT ((0)) NULL,
    [SENTTOBUS]         BIT            DEFAULT ((0)) NULL,
    CONSTRAINT [PK_GISHistoryQueue] PRIMARY KEY NONCLUSTERED ([GISHISTORYQUEUEID] ASC) WITH (FILLFACTOR = 80)
);


GO
CREATE CLUSTERED INDEX [IX_GISHISTORYQUEUE_CREATEDATE]
    ON [dbo].[GISHISTORYQUEUE]([CREATEDATE] DESC) WITH (FILLFACTOR = 80);


GO
CREATE NONCLUSTERED INDEX [IX_GISHISTORYQUEUE]
    ON [dbo].[GISHISTORYQUEUE]([CASEID] ASC, [SPATIALID] ASC, [CREATEDATE] DESC, [ISWRITTENTOGIS] ASC)
    INCLUDE([GISHISTORYQUEUEID], [MODULENAME], [CASENUMBER], [CASETYPE], [WORKCLASS], [APPLICATIONDATE], [PROJECTID], [PROJECTNAME], [SPATIALTYPE], [PROCESSEDDATE], [RESULTLOG]) WITH (FILLFACTOR = 80);


GO
CREATE NONCLUSTERED INDEX [IX_GISHISTORYQUEUE_FOR_V1_LIST]
    ON [dbo].[GISHISTORYQUEUE]([ISWRITTENTOGIS] ASC, [PROCESSEDDATE] ASC, [CREATEDATE] DESC);

