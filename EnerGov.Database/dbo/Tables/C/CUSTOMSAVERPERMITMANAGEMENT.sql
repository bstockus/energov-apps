CREATE TABLE [dbo].[CUSTOMSAVERPERMITMANAGEMENT] (
    [ID]                                               CHAR (36)      NOT NULL,
    [AreasToBeExcavated]                               NVARCHAR (36)  NULL,
    [NumberOfTrafficLanesToBeClosed]                   INT            NULL,
    [NumberOfParkingLanesToBeClosed]                   INT            NULL,
    [PurposeOfExcavation]                              NVARCHAR (36)  NULL,
    [PurposeOfExcavationOther]                         NVARCHAR (MAX) NULL,
    [EstimatedStartDate]                               DATETIME       NULL,
    [EstimatedCompletionDate]                          DATETIME       NULL,
    [NumberOfDwellingUnits]                            INT            NULL,
    [CommercialSquareFootage]                          FLOAT (53)     NULL,
    [ResidentialSquareFootage]                         FLOAT (53)     NULL,
    [TotalSquareFootage]                               FLOAT (53)     NULL,
    [NumberOfSprinklerHeads]                           INT            NULL,
    [SquareFeetDisturbed]                              FLOAT (53)     NULL,
    [CubicFeetFilled]                                  FLOAT (53)     NULL,
    [CubicYardsExcavated]                              FLOAT (53)     NULL,
    [LinearFeetDisturbed]                              FLOAT (53)     NULL,
    [Over1AcreCPCPProvidedFromDNR]                     BIT            NULL,
    [FrontYardSetback]                                 FLOAT (53)     NULL,
    [RearYardSetback]                                  FLOAT (53)     NULL,
    [LeftSideYardSetback]                              FLOAT (53)     NULL,
    [RightSideYardSetback]                             FLOAT (53)     NULL,
    [HVACEquipmentBeingReplaced]                       NVARCHAR (36)  NULL,
    [FurnaceBTUs]                                      FLOAT (53)     NULL,
    [AirConditionerBTUs]                               FLOAT (53)     NULL,
    [WaterClosets]                                     INT            NULL,
    [BathTubs]                                         INT            NULL,
    [FloorDrains]                                      INT            NULL,
    [LaundryTubs]                                      INT            NULL,
    [Showers]                                          INT            NULL,
    [WaterSofteners]                                   INT            NULL,
    [CatchBasins]                                      INT            NULL,
    [GarbageDisposalUnits]                             INT            NULL,
    [RoofDrains]                                       INT            NULL,
    [Urinals]                                          INT            NULL,
    [DrinkingFountains]                                INT            NULL,
    [GreaseInterceptor]                                INT            NULL,
    [Sinks]                                            INT            NULL,
    [WaterHeaters]                                     INT            NULL,
    [OtherFixtures]                                    INT            NULL,
    [ElectricalConstructionType]                       NVARCHAR (36)  NULL,
    [ServiceSize]                                      FLOAT (53)     NULL,
    [Outlets]                                          INT            NULL,
    [ACUnits]                                          INT            NULL,
    [TemporaryService]                                 INT            NULL,
    [Ranges]                                           INT            NULL,
    [Heaters]                                          INT            NULL,
    [Signs]                                            INT            NULL,
    [Dryers]                                           INT            NULL,
    [Furnaces]                                         INT            NULL,
    [Motors]                                           INT            NULL,
    [NumberOfSignFaces]                                INT            NULL,
    [AreasToBeOccupied]                                NVARCHAR (36)  NULL,
    [OtherAreaToBeOccupied]                            NVARCHAR (50)  NULL,
    [PurposeOfDumpster]                                NVARCHAR (MAX) NULL,
    [WorkStartedWithoutPermit]                         BIT            NULL,
    [ExpeditedPermit]                                  BIT            NULL,
    [CityPulledPermit]                                 BIT            NULL,
    [BuildingType]                                     NVARCHAR (36)  NULL,
    [IsNewBuilding]                                    BIT            NULL,
    [AntennaType]                                      NVARCHAR (36)  NULL,
    [FirePumpAcceptanceTest]                           BIT            NULL,
    [NumberOfDetectors]                                INT            NULL,
    [AlarmPanelOnly]                                   BIT            NULL,
    [NumberOfWeeks]                                    INT            NULL,
    [MoreThanOneWeek]                                  BIT            NULL,
    [OccupantLoadCapacity]                             INT            NULL,
    [OccupantLoadBasedOn]                              NVARCHAR (36)  NULL,
    [PlumbingDistrict]                                 NVARCHAR (36)  NULL,
    [VehicleLicensePlateNumber]                        NVARCHAR (50)  NULL,
    [DaysToBill]                                       INT            NULL,
    [AdditionalConditions]                             NVARCHAR (MAX) NULL,
    [LoadType]                                         NVARCHAR (36)  NULL,
    [TripInfo]                                         NVARCHAR (MAX) NULL,
    [DaysOfAdvancedNoticeGiven]                        INT            NULL,
    [StartDateOfSale]                                  DATETIME       NULL,
    [EndDateOfSale]                                    DATETIME       NULL,
    [NatureOfOccupancy]                                NVARCHAR (MAX) NULL,
    [DateOfTermination]                                DATETIME       NULL,
    [ReasonsForThisSale]                               NVARCHAR (MAX) NULL,
    [MeansOfAdvertisingAndContentOfAdvertisement]      NVARCHAR (MAX) NULL,
    [PlaceAndTermsOfStockAquisition]                   NVARCHAR (MAX) NULL,
    [NumberOfMonumentSigns]                            INT            NULL,
    [NumberOfWallSigns]                                INT            NULL,
    [NumberOfCanopySigns]                              INT            NULL,
    [NumberOfAwningSigns]                              INT            NULL,
    [NumberOfProjectingSigns]                          INT            NULL,
    [NumberOfMarqueeSigns]                             INT            NULL,
    [StructuralAlteration]                             BIT            NULL,
    [BuildingAccessoryPlanReviewComments]              NVARCHAR (36)  NULL,
    [ExemptFromFees]                                   BIT            NULL,
    [AdditionalPlanReviewComments]                     NVARCHAR (MAX) NULL,
    [StateReviewedPlans]                               BIT            NULL,
    [SignLocation]                                     NVARCHAR (36)  NULL,
    [ExpeditedPermitLandDisturbance]                   BIT            NULL,
    [OriginalTenant]                                   BIT            NULL,
    [NewOrExistingBillboard]                           NVARCHAR (36)  NULL,
    [FootingFoundationNewOrRepair]                     NVARCHAR (36)  NULL,
    [BldgCommPlanReviewComments]                       NVARCHAR (36)  NULL,
    [BldgResPlanReviewComments]                        NVARCHAR (36)  NULL,
    [Unit1SquareFootage]                               FLOAT (53)     NULL,
    [Unit2SquareFootage]                               FLOAT (53)     NULL,
    [AirportHeightZone]                                NVARCHAR (36)  NULL,
    [TemporaryOccupancyPermitText]                     NVARCHAR (MAX) NULL,
    [Slope20PctOrGreater]                              BIT            NULL,
    [FireAlarmComponents]                              INT            NULL,
    [StormSewerConnectRelay]                           NVARCHAR (36)  NULL,
    [SanitarySewerConnectRelay]                        NVARCHAR (36)  NULL,
    [WaterConnectRelay]                                NVARCHAR (36)  NULL,
    [BldgAcyPlanReviewComments]                        NVARCHAR (36)  NULL,
    [PlumbingConnectOrRelayOnly]                       BIT            NULL,
    [ExemptFromLandDisturbanceFee]                     BIT            NULL,
    [RoofUnderlaymentType]                             NVARCHAR (36)  NULL,
    [RoofFlashingMaterial]                             NVARCHAR (36)  NULL,
    [RoofFlashingType]                                 NVARCHAR (36)  NULL,
    [RoofingMaterial]                                  NVARCHAR (36)  NULL,
    [RoofDeckMaterial]                                 NVARCHAR (36)  NULL,
    [RemovingExistingRoofingMaterial]                  BIT            NULL,
    [ApplyingOverExistingRoofingMaterial]              BIT            NULL,
    [NumberOfExistingLayersOfRoofingMaterial]          INT            NULL,
    [RoofSlope]                                        NVARCHAR (50)  NULL,
    [ConnectionToExistingWiring]                       BIT            NULL,
    [DuctworkNewAndExisting]                           NVARCHAR (36)  NULL,
    [MechanicalEquipmentConnectedtoPotableWaterSystem] BIT            NULL,
    [BackflowDeviceManufacturer]                       NVARCHAR (50)  NULL,
    [BackflowDeviceModelNumber]                        NVARCHAR (50)  NULL,
    [ChimneyConstruction]                              NVARCHAR (36)  NULL,
    [TypeOfChimneyLiner]                               NVARCHAR (36)  NULL,
    [ChimneyDimensions]                                NVARCHAR (50)  NULL,
    [SizeOfChimneyLiner]                               NVARCHAR (50)  NULL,
    [FinalOccupancyPermitText]                         NVARCHAR (MAX) NULL,
    [NumberOfStories]                                  INT            NULL,
    [PropertyType]                                     NVARCHAR (36)  NULL,
    [CityToRepairBlackTop]                             BIT            NULL,
    [LocationOfExcavation]                             NVARCHAR (MAX) NULL,
    [DiggersReferenceNumber]                           NVARCHAR (50)  NULL,
    [WorkOrderNumber]                                  NVARCHAR (50)  NULL,
    [DrivewayWidthAtSidewalk]                          FLOAT (53)     NULL,
    [DrivewayWidthAtCurb]                              NVARCHAR (50)  NULL,
    [DrawingAttached]                                  BIT            NULL,
    [DrivewayType]                                     NVARCHAR (36)  NULL,
    [DrivewaySubType]                                  NVARCHAR (36)  NULL,
    [FireSprinklerSystemType]                          NVARCHAR (36)  NULL,
    [FireSprinklerPlanReviewComments]                  NVARCHAR (36)  NULL,
    [FireAlarmPlanReviewComments]                      NVARCHAR (36)  NULL,
    [FireCleanAgentPlanReviewComments]                 NVARCHAR (36)  NULL,
    [FireSprayBoothPlanReviewComments]                 NVARCHAR (36)  NULL,
    [FireCommercialKitchenPlanReviewComments]          NVARCHAR (36)  NULL,
    [BoilerBTUs]                                       INT            NULL,
    [PlumbingCutAndCapOnly]                            BIT            NULL,
    [ConvertedPermit]                                  BIT            NULL,
    [DemolitionType]                                   NVARCHAR (36)  NULL,
    [BldgDemoPlanReviewComments]                       NVARCHAR (36)  NULL,
    [NumberOfCleanAgentSystems]                        INT            NULL,
    [NumberofPermitsToIssue]                           INT            NULL,
    [StormDamageRepairs]                               BIT            NULL,
    [FireDamageRepairs]                                BIT            NULL,
    [FloodDamageRepairs]                               BIT            NULL,
    [FireStorageTankPlanReviewComments]                NVARCHAR (36)  NULL,
    [ImpreviousSurfaceChanged]                         BIT            NULL,
    [StreetRepairBlacktop]                             FLOAT (53)     NULL,
    [StreetRepairConcreteSlab]                         FLOAT (53)     NULL,
    [StreetRepairConcreteSidewalk]                     FLOAT (53)     NULL,
    [StreetRepairCurbAndGutter]                        FLOAT (53)     NULL,
    [StreetRepairBlacktopSawingSmall]                  FLOAT (53)     NULL,
    [StreetRepairBlacktopSawingBig]                    FLOAT (53)     NULL,
    [StreetRepairConcreteSawingSmall]                  FLOAT (53)     NULL,
    [StreetRepairConcreteSawingBig]                    FLOAT (53)     NULL,
    [UtilityPurposeOfExcavation]                       NVARCHAR (36)  NULL,
    [TypeOfStreetWorkPerformed]                        NVARCHAR (36)  NULL,
    [StreetRepairSizeOfOpening]                        NVARCHAR (50)  NULL,
    [StreetRepairDeepStrength]                         NVARCHAR (50)  NULL,
    [StreetRepairSawed]                                NVARCHAR (50)  NULL,
    [StreetRepairNamesOfCrew]                          NVARCHAR (MAX) NULL,
    [FireNumberOfApartments]                           INT            NULL,
    [FireNumberOfHotelRooms]                           INT            NULL,
    [FireCommercialSquareFootage]                      FLOAT (53)     NULL,
    [FireHighLifeSafetySquareFootage]                  INT            NULL,
    [SFD]                                              BIT            NULL,
    [Duplex]                                           BIT            NULL,
    [Detachedgarage]                                   BIT            NULL,
    [Commercial]                                       BIT            NULL,
    [Industrial]                                       BIT            NULL,
    [Institutional]                                    BIT            NULL,
    [Shed]                                             BIT            NULL,
    [threeunitsandup]                                  BIT            NULL,
    [ZollOccupancyID]                                  NVARCHAR (50)  NULL,
    [HasElectricalWork]                                BIT            NULL,
    [HasFireAlarmWork]                                 BIT            NULL,
    [FurnaceType]                                      NVARCHAR (36)  NULL,
    [FurnaceManufacturerName]                          NVARCHAR (50)  NULL,
    [FurnaceModelNumber]                               NVARCHAR (50)  NULL,
    [FurnaceFuel]                                      NVARCHAR (36)  NULL,
    [AirConditionerType]                               NVARCHAR (36)  NULL,
    [AirConditionerManufacturer]                       NVARCHAR (50)  NULL,
    [AirConditionerModelNumber]                        NVARCHAR (50)  NULL,
    [OrganizationType]                                 NVARCHAR (36)  NULL,
    [PremiseDescriptionQuestion]                       NVARCHAR (MAX) NULL,
    [PremiseDescriptionStorageQuestion]                NVARCHAR (MAX) NULL,
    [WISellersPermitNbr]                               NVARCHAR (50)  NULL,
    [EventName]                                        NVARCHAR (50)  NULL,
    [EventDates]                                       NVARCHAR (MAX) NULL,
    [EventStartTime]                                   NVARCHAR (50)  NULL,
    [EventEndTime]                                     NVARCHAR (50)  NULL,
    [EventLocation]                                    NVARCHAR (36)  NULL,
    [DescriptionOfShowAnimals]                         NVARCHAR (MAX) NULL,
    [LateApplication]                                  BIT            NULL,
    [ChargeCCFee]                                      BIT            NULL,
    [IsPayingPermitOnline]                             BIT            NULL,
    [BoilerManufacturerName]                           NVARCHAR (50)  NULL,
    [BoilerModelNumber]                                NVARCHAR (50)  NULL,
    [BoilerFuel]                                       NVARCHAR (36)  NULL,
    [OccupancyName]                                    NVARCHAR (50)  NULL,
    [OccupancyComments]                                NVARCHAR (MAX) NULL,
    [TownOfMedary]                                     BIT            NULL,
    CONSTRAINT [PK_PermitManagement] PRIMARY KEY NONCLUSTERED ([ID] ASC) WITH (FILLFACTOR = 80)
);


GO

CREATE TRIGGER [TG_CUSTOMSAVERPERMITMANAGEMENT_UPDATE_ELASTIC] ON  CUSTOMSAVERPERMITMANAGEMENT
   AFTER UPDATE
AS 
BEGIN
	SET NOCOUNT ON;

    INSERT INTO [ELASTICSEARCHOBJECT]
    ( [ELASTICSEARCHOBJECTID] ,
        [OBJECTID] ,
        [OBJECTCLASSNAME] ,
        [ROWVERSION] ,
        [CREATEDATE] ,
        [PROCESSEDDATE] ,
        [OBJECTACTION] ,
        [INDEXNAME]
    )
	SELECT
		NEWID() ,
		[P].[PMPERMITID] ,
        'EnerGovBusiness.PermitManagement.Permit' ,
        [P].[ROWVERSION] ,
        GETDATE() ,
        NULL ,
        2 ,
        (SELECT STRINGVALUE FROM SETTINGS WITH (NOLOCK) WHERE NAME = 'ServiceBusTenant')
	FROM [Inserted]
	JOIN [PMPERMIT] AS [P] WITH (NOLOCK) ON [P].[PMPERMITID] = [Inserted].[ID];

END
