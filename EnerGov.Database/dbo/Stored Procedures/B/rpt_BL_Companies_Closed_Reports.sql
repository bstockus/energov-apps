

CREATE PROCEDURE [dbo].[rpt_BL_Companies_Closed_Reports]
@STARTDATE AS DATETIME,
@ENDDATE AS DATETIME
AS
SET @ENDDATE = DATEADD(S,-1,DATEADD(D,1,@ENDDATE))
SELECT GLOBALENTITY.GLOBALENTITYNAME AS CompanyName, DISTRICT.NAME AS District, BLEXTLOCATION.NAME AS Location, BLEXTSTATUS.NAME AS Status, 
       BLEXTCOMPANYTYPE.NAME AS CompanyType, BLGLOBALENTITYEXTENSION.DBA AS dba, BLGLOBALENTITYEXTENSION.OPENDATE AS OpenedDate, 
       BLGLOBALENTITYEXTENSION.CLOSEDATE AS ClosedDate, BLGLOBALENTITYEXTENSION.LASTAUDITDATE AS LastAuditDate, 
       BLGLOBALENTITYEXTENSION.DESCRIPTION AS Description, BLGLOBALENTITYEXTENSION.BLGLOBALENTITYEXTENSIONID
FROM BLGLOBALENTITYEXTENSION 
INNER JOIN GLOBALENTITY ON BLGLOBALENTITYEXTENSION.GLOBALENTITYID = GLOBALENTITY.GLOBALENTITYID 
INNER JOIN BLEXTSTATUS ON BLGLOBALENTITYEXTENSION.BLEXTSTATUSID = BLEXTSTATUS.BLEXTSTATUSID 
INNER JOIN DISTRICT ON BLGLOBALENTITYEXTENSION.DISTRICTID = DISTRICT.DISTRICTID 
INNER JOIN BLEXTLOCATION ON BLGLOBALENTITYEXTENSION.BLEXTLOCATIONID = BLEXTLOCATION.BLEXTLOCATIONID 
INNER JOIN BLEXTCOMPANYTYPE ON BLGLOBALENTITYEXTENSION.BLEXTCOMPANYTYPEID = BLEXTCOMPANYTYPE.BLEXTCOMPANYTYPEID
WHERE BLGLOBALENTITYEXTENSION.CLOSEDATE BETWEEN @STARTDATE AND @ENDDATE

