
CREATE PROCEDURE rpt_BL_SR_Batch_Renewal_Summary_Parameters

AS

BEGIN

CREATE INDEX TEMP1 ON BLBATCHRENEWALBLLICENSE(BLLICENSEID)
CREATE INDEX TEMP1 ON BLBATCHRENEWALBLINVOICE(BLLICENSEID)
CREATE INDEX TEMP2 ON BLBATCHRENEWALBLINVOICE(CAINVOICEID)
CREATE INDEX TEMP1 ON BLBATCHRENEWALLOG(BLLICENSEID)

SELECT DISTINCT BR.BLBATCHRENEWALID BLBATCHRENEWALID_PARAM, BR.BATCHRENEWALNUMBER BATCHRENEWALNUMBER_PARAM
FROM BLBATCHRENEWAL BR
INNER JOIN BLBATCHRENEWALBLLICENSE BRL ON BR.BLBATCHRENEWALID = BRL.BLBATCHRENEWALID
INNER JOIN BLBATCHRENEWALBLINVOICE BRI ON BRL.BLBATCHRENEWALID = BRI.BLBATCHRENEWALID 
                                AND BRL.BLLICENSEID = BRI.BLLICENSEID
INNER JOIN BLBATCHRENEWALLOG BRLOG ON BRL.BLBATCHRENEWALID = BRLOG.BLBATCHRENEWALID 
								AND BRL.BLLICENSEID = BRLOG.BLLICENSEID
INNER JOIN BLLICENSE L_ORIG ON BRL.BLLICENSEID = L_ORIG.BLLICENSEID

DROP INDEX TEMP1 ON BLBATCHRENEWALBLLICENSE;
DROP INDEX TEMP1 ON BLBATCHRENEWALBLINVOICE;
DROP INDEX TEMP2 ON BLBATCHRENEWALBLINVOICE;
DROP INDEX TEMP1 ON BLBATCHRENEWALLOG;

END
