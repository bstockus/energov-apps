CREATE PROCEDURE [dbo].[USP_USERS_INSERT]
(
	@SUSERGUID CHAR(36),
	@SROLEID CHAR(36),
	@SITEID NVARCHAR(10),
	@ID NVARCHAR(254),
	@FNAME NVARCHAR(30),
	@LNAME NVARCHAR(30),
	@PASSWORD NVARCHAR(100),
	@PHONE NVARCHAR(40),
	@EMAIL NVARCHAR(80),
	@BACTIVE BIT,
	@BGETINTERNETNOTES BIT,
	@BGETBUSINESSNOTES BIT,
	@BGETCODENEITES BIT,
	@LASTCHANGEDON DATETIME,
	@LASTCHANGEDBY CHAR(36),
	@GMAPID CHAR(36),
	@GLOBALENTITYID CHAR(36),
	@MAILINGADDRESSID CHAR(36),
	@ROWVERSION INT,
	@ISPASSWORDCHANGEREQUIRED BIT,
	@APPLICATIONERRORS BIT,
	@SECURITYISACTIVEDIRECTORY BIT,
	@COMPANY NVARCHAR(100),
	@MIDDLENAME NVARCHAR(50),
	@CREATEDON DATETIME,
	@TITLE VARCHAR(50),
	@CREDENTIALS VARCHAR(50),
	@OFFICEID CHAR(36),
	@LICENSE_SUITE NVARCHAR(MAX),
	@MAINMAPSORTORDER INT,
	@GLOBALPREFFERCOMMID INT
)
AS
DECLARE @OUTPUTTABLE as TABLE([ROWVERSION]  int)
INSERT INTO [dbo].[USERS](
	[SUSERGUID],
	[SROLEID],
	[SITEID],
	[ID],
	[FNAME],
	[LNAME],
	[PASSWORD],
	[PHONE],
	[EMAIL],
	[BACTIVE],
	[BGETINTERNETNOTES],
	[BGETBUSINESSNOTES],
	[BGETCODENEITES],
	[LASTCHANGEDON],
	[LASTCHANGEDBY],
	[GMAPID],
	[GLOBALENTITYID],
	[MAILINGADDRESSID],
	[ROWVERSION],
	[ISPASSWORDCHANGEREQUIRED],
	[APPLICATIONERRORS],
	[SECURITYISACTIVEDIRECTORY],
	[COMPANY],
	[MIDDLENAME],
	[CREATEDON],
	[TITLE],
	[CREDENTIALS],
	[OFFICEID],
	[LICENSE_SUITE],
	[MAINMAPSORTORDER],
	[GLOBALPREFFERCOMMID]
)
OUTPUT inserted.[ROWVERSION] INTO @OUTPUTTABLE
VALUES
(
	@SUSERGUID,
	@SROLEID,
	@SITEID,
	@ID,
	@FNAME,
	@LNAME,
	@PASSWORD,
	@PHONE,
	@EMAIL,
	@BACTIVE,
	@BGETINTERNETNOTES,
	@BGETBUSINESSNOTES,
	@BGETCODENEITES,
	@LASTCHANGEDON,
	@LASTCHANGEDBY,
	@GMAPID,
	@GLOBALENTITYID,
	@MAILINGADDRESSID,
	@ROWVERSION,
	@ISPASSWORDCHANGEREQUIRED,
	@APPLICATIONERRORS,
	@SECURITYISACTIVEDIRECTORY,
	@COMPANY,
	@MIDDLENAME,
	@CREATEDON,
	@TITLE,
	@CREDENTIALS,
	@OFFICEID,
	@LICENSE_SUITE,
	@MAINMAPSORTORDER,
	@GLOBALPREFFERCOMMID
)
SELECT * FROM @OUTPUTTABLE