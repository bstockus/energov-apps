

/****** OBJECT:  StoredProcedure [dbo].[rpt_OM_Object_Attached_Records_Report_Plan]    Script Date: 02/25/2011 15:58:52 ******/
CREATE PROCEDURE rpt_OM_SR_Object_Attached_Records_Report_Plan
@OMOBJECTID AS VARCHAR(36)
AS

SELECT	PLPLANOBJECT.OMOBJECTID, 
		PLPLAN.PLPLANID, PLPLAN.PLANNUMBER, 
		PLPLANTYPE.PLANNAME PLANTYPE, 
		PLPLANWORKCLASS.NAME PLANCLASS,
		PLPLANSTATUS.NAME PLPLANSTATUS,
		PLAN_CONTACTS.ISBILLING, PLAN_CONTACTS.CONTACTTYPE, PLAN_CONTACTS.GLOBALENTITYNAME, PLAN_CONTACTS.FIRSTNAME, PLAN_CONTACTS.LASTNAME

FROM	PLPLANOBJECT 
		INNER JOIN PLPLAN ON PLPLANOBJECT.PLPLANID = PLPLAN.PLPLANID
		INNER JOIN PLPLANTYPE ON PLPLAN.PLPLANTYPEID = PLPLANTYPE.PLPLANTYPEID
		INNER JOIN PLPLANWORKCLASS ON PLPLAN.PLPLANWORKCLASSID = PLPLANWORKCLASS.PLPLANWORKCLASSID
		INNER JOIN PLPLANSTATUS ON PLPLAN.PLPLANSTATUSID = PLPLANSTATUS.PLPLANSTATUSID
		
		LEFT OUTER JOIN (SELECT PLPLANCONTACT.PLPLANID, PLPLANCONTACT.ISBILLING,
								GLOBALENTITY.GLOBALENTITYNAME, GLOBALENTITY.FIRSTNAME, GLOBALENTITY.LASTNAME,
								LANDMANAGEMENTCONTACTTYPE.NAME CONTACTTYPE
						 FROM	PLPLANCONTACT 
								INNER JOIN LANDMANAGEMENTCONTACTTYPE ON PLPLANCONTACT.LANDMANAGEMENTCONTACTTYPEID = LANDMANAGEMENTCONTACTTYPE.LANDMANAGEMENTCONTACTTYPEID
								INNER JOIN GLOBALENTITY ON PLPLANCONTACT.GLOBALENTITYID = GLOBALENTITY.GLOBALENTITYID
						) AS PLAN_CONTACTS ON PLPLAN.PLPLANID = PLAN_CONTACTS.PLPLANID

WHERE	PLPLANOBJECT.OMOBJECTID = @OMOBJECTID

