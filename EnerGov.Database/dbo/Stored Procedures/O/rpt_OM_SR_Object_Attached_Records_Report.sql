
CREATE PROCEDURE rpt_OM_SR_Object_Attached_Records_Report
@OMOBJECTID VARCHAR(36)
AS


SELECT	OMOBJECT.OMOBJECTID, OMOBJECT.OBJECTNUMBER, OMOBJECT.CREATEDATE, 
		OMOBJECT.OPERATIONSTARTDATE, OMOBJECT.INSTALLDATE,  OMOBJECT.DESCRIPTION, 
		OMOBJECTSTATUS.NAME AS OBJECTSTATUS, 
		OMOBJECTTYPE.NAME AS OBJECTTYPE,
		OMOBJECTCLASSIFICATION.NAME AS OBJECTCLASSIFICATION,
		(SELECT R.[IMAGE] FROM RPTIMAGELIB R
			WHERE R.IMAGENAME = 'Municipality_Logo') LOGO,
		(SELECT CASE WHEN R.[IMAGE] IS NULL THEN 'N' ELSE 'Y' END FROM RPTIMAGELIB R
			WHERE R.IMAGENAME = 'Municipality_Logo') SHOWLOGO,
		(SELECT R.REPORTTEXT FROM RPTTEXTLIB R
			WHERE R.TEXTNAME = 'Municipality_Name') Municipality_Name,	   
		(SELECT R.REPORTTEXT FROM RPTTEXTLIB R
			WHERE R.TEXTNAME = 'Municipality_Page_Footer') Municipality_Page_Footer
						
FROM	OMOBJECT 
		INNER JOIN OMOBJECTTYPE ON OMOBJECT.OMOBJECTTYPEID = OMOBJECTTYPE.OMOBJECTTYPEID 
		INNER JOIN OMOBJECTSTATUS ON OMOBJECT.OMOBJECTSTATUSID = OMOBJECTSTATUS.OMOBJECTSTATUSID 
		INNER JOIN OMOBJECTCLASSIFICATION ON OMOBJECT.OMOBJECTCLASSIFICATIONID = OMOBJECTCLASSIFICATION.OMOBJECTCLASSIFICATIONID 
WHERE	OMOBJECT.OMOBJECTID = @OMOBJECTID

