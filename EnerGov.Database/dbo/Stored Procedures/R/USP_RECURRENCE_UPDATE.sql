CREATE PROCEDURE [dbo].[USP_RECURRENCE_UPDATE]
(
	@RECURRENCEID CHAR(36),
	@NAME VARCHAR(100),
	@DAILY BIT,
	@WEEKLY BIT,
	@MONTHLY BIT,
	@YEARLY BIT,
	@DAILYRECURSEVERYNODAYS VARCHAR(10),
	@DAILYRECURSEVERYWEEKDAY BIT,
	@WEEKLYRECURSEVERYNOWEEKS VARCHAR(10),
	@WEEKLYRECURSONMONDAY BIT,
	@WEEKLYRECURSONTUESDAY BIT,
	@WEEKLYRECURSONWEDNESDAY BIT,
	@WEEKLYRECURSONTHURSDAY BIT,
	@WEEKLYRECURSONFRIDAY BIT,
	@WEEKLYRECURSONSATURDAY BIT,
	@WEEKLYRECURSONSUNDAY BIT,
	@MONTHLYTHERECURPATTERN BIT,
	@MONTHLYEVERYDAYDAY VARCHAR(10),
	@MONTHLYEVERYNOOFMONTHS VARCHAR(10),
	@MONTHLYWEEKNUMBER VARCHAR(20),
	@MONTHLYWEEKDAY VARCHAR(50),
	@MONTHLYTHENOOFMONTHS VARCHAR(10),
	@YEARLYTHERECURPATTERN BIT,
	@YEARLYEVERYMONTH VARCHAR(20),
	@YEARLYEVERYDAY VARCHAR(10),
	@YEARLYTHEWEEK VARCHAR(20),
	@YEARLYTHEDAYOFWEEK VARCHAR(20),
	@YEARLYTHEMONTHOFYEAR VARCHAR(20),
	@STARTDATE DATETIME,
	@RECURSUNTILDATE DATETIME,
	@STARTTIME SMALLDATETIME,
	@ENDTIME SMALLDATETIME,
	@ALLDAYEVENT BIT,
	@MAXOCCURENCES INT,
	@EVERYXDAYS BIT,
	@EVERYXWEEKS BIT,
	@DAYOFXMONTH BIT,
	@DAYOFXYEAR BIT,
	@DUEON BIT,
	@DAILYRECURSFROM VARCHAR(50),
	@DAILYRECURSEXCLUDEWEEKENDS BIT,
	@WEEKLYRECURSEVRYNOWEEKSFROM VARCHAR(50),
	@WEEKLYRECURSEVRYNOWEEKS2 VARCHAR(10),
	@WEEKLYRECURSEVRYNOWEEKSFROM2 VARCHAR(50),
	@WEEKLYEXPIRESEVERYWEEK BIT,
	@WEEKLYEXPIRESEVERYWEEKFROMDATE BIT,
	@MONTHLYEVERYFROM VARCHAR(50),
	@MONTHLYWEEKFROM VARCHAR(50),
	@YEARLYFROMISSUEDATE BIT,
	@YEARLYEXPIRESEVERYNOYEARS VARCHAR(20),
	@DUEONMONTH VARCHAR(20),
	@DUEONDAYS VARCHAR(10),
	@DUEONYEAR VARCHAR(20),
	@DUEONTHEWEEK VARCHAR(20),
	@DUEONTHEDAYOFWEEK VARCHAR(20),
	@DUEONTHEMONTHOFYEAR VARCHAR(20),
	@DUEONTHEYEAR VARCHAR(20),
	@LICENSECYCLETYPEID INT,
	@DUEONON BIT,
	@DUEONONTHE BIT,
	@LASTCHANGEDBY CHAR(36),
	@LASTCHANGEDON DATETIME,
	@ROWVERSION INT
)
AS
DECLARE @OUTPUTTABLE as TABLE([ROWVERSION]  int)
UPDATE [dbo].[RECURRENCE] SET
	[NAME] = @NAME,
	[DAILY] = @DAILY,
	[WEEKLY] = @WEEKLY,
	[MONTHLY] = @MONTHLY,
	[YEARLY] = @YEARLY,
	[DAILYRECURSEVERYNODAYS] = @DAILYRECURSEVERYNODAYS,
	[DAILYRECURSEVERYWEEKDAY] = @DAILYRECURSEVERYWEEKDAY,
	[WEEKLYRECURSEVERYNOWEEKS] = @WEEKLYRECURSEVERYNOWEEKS,
	[WEEKLYRECURSONMONDAY] = @WEEKLYRECURSONMONDAY,
	[WEEKLYRECURSONTUESDAY] = @WEEKLYRECURSONTUESDAY,
	[WEEKLYRECURSONWEDNESDAY] = @WEEKLYRECURSONWEDNESDAY,
	[WEEKLYRECURSONTHURSDAY] = @WEEKLYRECURSONTHURSDAY,
	[WEEKLYRECURSONFRIDAY] = @WEEKLYRECURSONFRIDAY,
	[WEEKLYRECURSONSATURDAY] = @WEEKLYRECURSONSATURDAY,
	[WEEKLYRECURSONSUNDAY] = @WEEKLYRECURSONSUNDAY,
	[MONTHLYTHERECURPATTERN] = @MONTHLYTHERECURPATTERN,
	[MONTHLYEVERYDAYDAY] = @MONTHLYEVERYDAYDAY,
	[MONTHLYEVERYNOOFMONTHS] = @MONTHLYEVERYNOOFMONTHS,
	[MONTHLYWEEKNUMBER] = @MONTHLYWEEKNUMBER,
	[MONTHLYWEEKDAY] = @MONTHLYWEEKDAY,
	[MONTHLYTHENOOFMONTHS] = @MONTHLYTHENOOFMONTHS,
	[YEARLYTHERECURPATTERN] = @YEARLYTHERECURPATTERN,
	[YEARLYEVERYMONTH] = @YEARLYEVERYMONTH,
	[YEARLYEVERYDAY] = @YEARLYEVERYDAY,
	[YEARLYTHEWEEK] = @YEARLYTHEWEEK,
	[YEARLYTHEDAYOFWEEK] = @YEARLYTHEDAYOFWEEK,
	[YEARLYTHEMONTHOFYEAR] = @YEARLYTHEMONTHOFYEAR,
	[STARTDATE] = @STARTDATE,
	[RECURSUNTILDATE] = @RECURSUNTILDATE,
	[STARTTIME] = @STARTTIME,
	[ENDTIME] = @ENDTIME,
	[ALLDAYEVENT] = @ALLDAYEVENT,
	[MAXOCCURENCES] = @MAXOCCURENCES,
	[EVERYXDAYS] = @EVERYXDAYS,
	[EVERYXWEEKS] = @EVERYXWEEKS,
	[DAYOFXMONTH] = @DAYOFXMONTH,
	[DAYOFXYEAR] = @DAYOFXYEAR,
	[DUEON] = @DUEON,
	[DAILYRECURSFROM] = @DAILYRECURSFROM,
	[DAILYRECURSEXCLUDEWEEKENDS] = @DAILYRECURSEXCLUDEWEEKENDS,
	[WEEKLYRECURSEVRYNOWEEKSFROM] = @WEEKLYRECURSEVRYNOWEEKSFROM,
	[WEEKLYRECURSEVRYNOWEEKS2] = @WEEKLYRECURSEVRYNOWEEKS2,
	[WEEKLYRECURSEVRYNOWEEKSFROM2] = @WEEKLYRECURSEVRYNOWEEKSFROM2,
	[WEEKLYEXPIRESEVERYWEEK] = @WEEKLYEXPIRESEVERYWEEK,
	[WEEKLYEXPIRESEVERYWEEKFROMDATE] = @WEEKLYEXPIRESEVERYWEEKFROMDATE,
	[MONTHLYEVERYFROM] = @MONTHLYEVERYFROM,
	[MONTHLYWEEKFROM] = @MONTHLYWEEKFROM,
	[YEARLYFROMISSUEDATE] = @YEARLYFROMISSUEDATE,
	[YEARLYEXPIRESEVERYNOYEARS] = @YEARLYEXPIRESEVERYNOYEARS,
	[DUEONMONTH] = @DUEONMONTH,
	[DUEONDAYS] = @DUEONDAYS,
	[DUEONYEAR] = @DUEONYEAR,
	[DUEONTHEWEEK] = @DUEONTHEWEEK,
	[DUEONTHEDAYOFWEEK] = @DUEONTHEDAYOFWEEK,
	[DUEONTHEMONTHOFYEAR] = @DUEONTHEMONTHOFYEAR,
	[DUEONTHEYEAR] = @DUEONTHEYEAR,
	[LICENSECYCLETYPEID] = @LICENSECYCLETYPEID,
	[DUEONON] = @DUEONON,
	[DUEONONTHE] = @DUEONONTHE,
	[LASTCHANGEDBY] = @LASTCHANGEDBY,
	[LASTCHANGEDON] = @LASTCHANGEDON,
	[ROWVERSION] = @ROWVERSION + 1
OUTPUT inserted.[ROWVERSION] INTO @OUTPUTTABLE
WHERE
	[RECURRENCEID] = @RECURRENCEID AND 
	[ROWVERSION]= @ROWVERSION

SELECT * FROM @OUTPUTTABLE