CREATE PROCEDURE [dbo].[USP_RECURRENCE_INSERT]
(
	@RECURRENCEID CHAR(36),
	@NAME VARCHAR(100),
	@DAILY BIT,
	@WEEKLY BIT,
	@MONTHLY BIT,
	@YEARLY BIT,
	@DAILYRECURSEVERYNODAYS VARCHAR(10),
	@DAILYRECURSEVERYWEEKDAY BIT,
	@WEEKLYRECURSEVERYNOWEEKS VARCHAR(10),
	@WEEKLYRECURSONMONDAY BIT,
	@WEEKLYRECURSONTUESDAY BIT,
	@WEEKLYRECURSONWEDNESDAY BIT,
	@WEEKLYRECURSONTHURSDAY BIT,
	@WEEKLYRECURSONFRIDAY BIT,
	@WEEKLYRECURSONSATURDAY BIT,
	@WEEKLYRECURSONSUNDAY BIT,
	@MONTHLYTHERECURPATTERN BIT,
	@MONTHLYEVERYDAYDAY VARCHAR(10),
	@MONTHLYEVERYNOOFMONTHS VARCHAR(10),
	@MONTHLYWEEKNUMBER VARCHAR(20),
	@MONTHLYWEEKDAY VARCHAR(50),
	@MONTHLYTHENOOFMONTHS VARCHAR(10),
	@YEARLYTHERECURPATTERN BIT,
	@YEARLYEVERYMONTH VARCHAR(20),
	@YEARLYEVERYDAY VARCHAR(10),
	@YEARLYTHEWEEK VARCHAR(20),
	@YEARLYTHEDAYOFWEEK VARCHAR(20),
	@YEARLYTHEMONTHOFYEAR VARCHAR(20),
	@STARTDATE DATETIME,
	@RECURSUNTILDATE DATETIME,
	@STARTTIME SMALLDATETIME,
	@ENDTIME SMALLDATETIME,
	@ALLDAYEVENT BIT,
	@MAXOCCURENCES INT,
	@EVERYXDAYS BIT,
	@EVERYXWEEKS BIT,
	@DAYOFXMONTH BIT,
	@DAYOFXYEAR BIT,
	@DUEON BIT,
	@DAILYRECURSFROM VARCHAR(50),
	@DAILYRECURSEXCLUDEWEEKENDS BIT,
	@WEEKLYRECURSEVRYNOWEEKSFROM VARCHAR(50),
	@WEEKLYRECURSEVRYNOWEEKS2 VARCHAR(10),
	@WEEKLYRECURSEVRYNOWEEKSFROM2 VARCHAR(50),
	@WEEKLYEXPIRESEVERYWEEK BIT,
	@WEEKLYEXPIRESEVERYWEEKFROMDATE BIT,
	@MONTHLYEVERYFROM VARCHAR(50),
	@MONTHLYWEEKFROM VARCHAR(50),
	@YEARLYFROMISSUEDATE BIT,
	@YEARLYEXPIRESEVERYNOYEARS VARCHAR(20),
	@DUEONMONTH VARCHAR(20),
	@DUEONDAYS VARCHAR(10),
	@DUEONYEAR VARCHAR(20),
	@DUEONTHEWEEK VARCHAR(20),
	@DUEONTHEDAYOFWEEK VARCHAR(20),
	@DUEONTHEMONTHOFYEAR VARCHAR(20),
	@DUEONTHEYEAR VARCHAR(20),
	@LICENSECYCLETYPEID INT,
	@DUEONON BIT,
	@DUEONONTHE BIT,
	@LASTCHANGEDBY CHAR(36),
	@LASTCHANGEDON DATETIME,
	@ROWVERSION INT
)
AS
DECLARE @OUTPUTTABLE as TABLE([ROWVERSION]  int)
INSERT INTO [dbo].[RECURRENCE](
	[RECURRENCEID],
	[NAME],
	[DAILY],
	[WEEKLY],
	[MONTHLY],
	[YEARLY],
	[DAILYRECURSEVERYNODAYS],
	[DAILYRECURSEVERYWEEKDAY],
	[WEEKLYRECURSEVERYNOWEEKS],
	[WEEKLYRECURSONMONDAY],
	[WEEKLYRECURSONTUESDAY],
	[WEEKLYRECURSONWEDNESDAY],
	[WEEKLYRECURSONTHURSDAY],
	[WEEKLYRECURSONFRIDAY],
	[WEEKLYRECURSONSATURDAY],
	[WEEKLYRECURSONSUNDAY],
	[MONTHLYTHERECURPATTERN],
	[MONTHLYEVERYDAYDAY],
	[MONTHLYEVERYNOOFMONTHS],
	[MONTHLYWEEKNUMBER],
	[MONTHLYWEEKDAY],
	[MONTHLYTHENOOFMONTHS],
	[YEARLYTHERECURPATTERN],
	[YEARLYEVERYMONTH],
	[YEARLYEVERYDAY],
	[YEARLYTHEWEEK],
	[YEARLYTHEDAYOFWEEK],
	[YEARLYTHEMONTHOFYEAR],
	[STARTDATE],
	[RECURSUNTILDATE],
	[STARTTIME],
	[ENDTIME],
	[ALLDAYEVENT],
	[MAXOCCURENCES],
	[EVERYXDAYS],
	[EVERYXWEEKS],
	[DAYOFXMONTH],
	[DAYOFXYEAR],
	[DUEON],
	[DAILYRECURSFROM],
	[DAILYRECURSEXCLUDEWEEKENDS],
	[WEEKLYRECURSEVRYNOWEEKSFROM],
	[WEEKLYRECURSEVRYNOWEEKS2],
	[WEEKLYRECURSEVRYNOWEEKSFROM2],
	[WEEKLYEXPIRESEVERYWEEK],
	[WEEKLYEXPIRESEVERYWEEKFROMDATE],
	[MONTHLYEVERYFROM],
	[MONTHLYWEEKFROM],
	[YEARLYFROMISSUEDATE],
	[YEARLYEXPIRESEVERYNOYEARS],
	[DUEONMONTH],
	[DUEONDAYS],
	[DUEONYEAR],
	[DUEONTHEWEEK],
	[DUEONTHEDAYOFWEEK],
	[DUEONTHEMONTHOFYEAR],
	[DUEONTHEYEAR],
	[LICENSECYCLETYPEID],
	[DUEONON],
	[DUEONONTHE],
	[LASTCHANGEDBY],
	[LASTCHANGEDON],
	[ROWVERSION]
)
OUTPUT inserted.[ROWVERSION] INTO @OUTPUTTABLE
VALUES
(
	@RECURRENCEID,
	@NAME,
	@DAILY,
	@WEEKLY,
	@MONTHLY,
	@YEARLY,
	@DAILYRECURSEVERYNODAYS,
	@DAILYRECURSEVERYWEEKDAY,
	@WEEKLYRECURSEVERYNOWEEKS,
	@WEEKLYRECURSONMONDAY,
	@WEEKLYRECURSONTUESDAY,
	@WEEKLYRECURSONWEDNESDAY,
	@WEEKLYRECURSONTHURSDAY,
	@WEEKLYRECURSONFRIDAY,
	@WEEKLYRECURSONSATURDAY,
	@WEEKLYRECURSONSUNDAY,
	@MONTHLYTHERECURPATTERN,
	@MONTHLYEVERYDAYDAY,
	@MONTHLYEVERYNOOFMONTHS,
	@MONTHLYWEEKNUMBER,
	@MONTHLYWEEKDAY,
	@MONTHLYTHENOOFMONTHS,
	@YEARLYTHERECURPATTERN,
	@YEARLYEVERYMONTH,
	@YEARLYEVERYDAY,
	@YEARLYTHEWEEK,
	@YEARLYTHEDAYOFWEEK,
	@YEARLYTHEMONTHOFYEAR,
	@STARTDATE,
	@RECURSUNTILDATE,
	@STARTTIME,
	@ENDTIME,
	@ALLDAYEVENT,
	@MAXOCCURENCES,
	@EVERYXDAYS,
	@EVERYXWEEKS,
	@DAYOFXMONTH,
	@DAYOFXYEAR,
	@DUEON,
	@DAILYRECURSFROM,
	@DAILYRECURSEXCLUDEWEEKENDS,
	@WEEKLYRECURSEVRYNOWEEKSFROM,
	@WEEKLYRECURSEVRYNOWEEKS2,
	@WEEKLYRECURSEVRYNOWEEKSFROM2,
	@WEEKLYEXPIRESEVERYWEEK,
	@WEEKLYEXPIRESEVERYWEEKFROMDATE,
	@MONTHLYEVERYFROM,
	@MONTHLYWEEKFROM,
	@YEARLYFROMISSUEDATE,
	@YEARLYEXPIRESEVERYNOYEARS,
	@DUEONMONTH,
	@DUEONDAYS,
	@DUEONYEAR,
	@DUEONTHEWEEK,
	@DUEONTHEDAYOFWEEK,
	@DUEONTHEMONTHOFYEAR,
	@DUEONTHEYEAR,
	@LICENSECYCLETYPEID,
	@DUEONON,
	@DUEONONTHE,
	@LASTCHANGEDBY,
	@LASTCHANGEDON,
	@ROWVERSION
)
SELECT * FROM @OUTPUTTABLE