CREATE PROCEDURE [dbo].[GET_TABLE_CUSTOMFIELDS_BY_OBJECTIDS]
(
	@RECORDIDS RECORDIDS READONLY
)
AS
BEGIN
SET NOCOUNT ON;

SELECT TABLECUSTOMFIELDS.* FROM 
(
	SELECT OBJECTID, CFTABLECOLUMNREFID, NULL AS STRINGVALUE,NULL AS NUMBERVALUE,NULL AS DATEVALUE, BITVALUE AS BOOLEANVALUE, NULL AS MONEYVALUE, ROWNUMBER 
	FROM CUSTOMSAVERTBLCOL_BLN
	UNION ALL
	SELECT OBJECTID, CFTABLECOLUMNREFID, NULL AS STRINGVALUE,NULL AS NUMBERVALUE, DATEVALUE AS DATEVALUE, NULL AS BOOLEANVALUE, NULL AS MONEYVALUE, ROWNUMBER 
	FROM CUSTOMSAVERTBLCOL_DATE
	UNION ALL
	SELECT OBJECTID, CFTABLECOLUMNREFID, NULL AS STRINGVALUE, FLOATVALUE AS NUMBERVALUE,NULL AS DATEVALUE, NULL AS BOOLEANVALUE, NULL AS MONEYVALUE, ROWNUMBER 
	FROM CUSTOMSAVERTBLCOL_FLT
	UNION ALL
	SELECT OBJECTID, CFTABLECOLUMNREFID, NULL AS STRINGVALUE, INTVALUE AS NUMBERVALUE, NULL AS DATEVALUE, NULL AS BOOLEANVALUE, NULL AS MONEYVALUE, ROWNUMBER 
	FROM CUSTOMSAVERTBLCOL_INT
	UNION ALL
	SELECT OBJECTID, CFTABLECOLUMNREFID, CUSTOMFIELDPICKLISTITEM.SVALUE AS STRINGVALUE,NULL  AS NUMBERVALUE,NULL AS DATEVALUE, NULL AS BOOLEANVALUE, NULL AS MONEYVALUE, ROWNUMBER 
	FROM CUSTOMSAVERTBLCOL_LST
	LEFT OUTER JOIN CUSTOMFIELDPICKLISTITEM ON CUSTOMSAVERTBLCOL_LST.PICKLISTVALUE = CUSTOMFIELDPICKLISTITEM.GCUSTOMFIELDPICKLISTITEM
	UNION ALL
	SELECT OBJECTID, CFTABLECOLUMNREFID, MEMO_VALUE AS STRINGVALUE,NULL AS NUMBERVALUE,NULL AS DATEVALUE, NULL AS BOOLEANVALUE, NULL AS MONEYVALUE, ROWNUMBER 
	FROM CUSTOMSAVERTBLCOL_MEM
	UNION ALL
	SELECT OBJECTID, CFTABLECOLUMNREFID, NULL AS STRINGVALUE,NULL AS NUMBERVALUE,NULL AS DATEVALUE, NULL AS BOOLEANVALUE, CURRENCYVALUE AS MONEYVALUE, ROWNUMBER 
	FROM CUSTOMSAVERTBLCOL_MNY
	UNION ALL
	SELECT OBJECTID, CFTABLECOLUMNREFID, STRINGVALUE,NULL,NULL, NULL, NULL, ROWNUMBER FROM CUSTOMSAVERTBLCOL_STR
) AS TABLECUSTOMFIELDS
WHERE
	 TABLECUSTOMFIELDS.OBJECTID  IN (SELECT RECORDID FROM @RECORDIDS)
END