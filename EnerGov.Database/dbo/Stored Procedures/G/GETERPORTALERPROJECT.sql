CREATE PROCEDURE [dbo].[GETERPORTALERPROJECT]
-- Add the parameters for the stored procedure here
@CaseID char(36),
@ModuleID int
AS
BEGIN
	IF @ModuleID = 1
	BEGIN	
		SELECT	DISTINCT ERPROJECT.ERPROJECTID,
				ERPROJECT.PLPLANID AS CASEID,
				ERPROJECT.ERPROJECTSTATUSID,				
				ERPROJECT.PROJECTNUM,
				ERPROJECT.UPLOADFOLDER,
				ERPROJECT.LOCKED,
				ERPROJECT.ROWVERSION,
				ERPROJECT.ALLOWFILEUPLOAD,
				ERPROJECTSTATUS.ERPROJECTSYSTEMSTATUSID,
				1 AS MODULEID,
				'Plan' AS MODULENAME
		FROM ERPROJECT		
		INNER JOIN ERPROJECTSTATUS ON ERPROJECTSTATUS.ERPROJECTSTATUSID = ERPROJECT.ERPROJECTSTATUSID		
		WHERE ERPROJECT.PLPLANID = @CaseID
	END
	ELSE IF @ModuleID = 2
	BEGIN
		SELECT	DISTINCT ERPROJECT.ERPROJECTID,
				ERPROJECT.PMPERMITID AS CASEID,
				ERPROJECT.ERPROJECTSTATUSID,				
				ERPROJECT.PROJECTNUM,
				ERPROJECT.UPLOADFOLDER,
				ERPROJECT.LOCKED,
				ERPROJECT.ROWVERSION,
				ERPROJECT.ALLOWFILEUPLOAD,
				ERPROJECTSTATUS.ERPROJECTSYSTEMSTATUSID,
				2 AS MODULEID,
				'Permit' AS MODULENAME
		FROM ERPROJECT		
		INNER JOIN ERPROJECTSTATUS ON ERPROJECTSTATUS.ERPROJECTSTATUSID = ERPROJECT.ERPROJECTSTATUSID		
		WHERE ERPROJECT.PMPERMITID = @CaseID
	END	
END