CREATE PROCEDURE [dbo].[LINKED_INSPECTIONCASES_COUNT]
	@LINKEDCASEID char(36),
	@USER_ID char(36), 
	@TOTAL_INSPECTIONCASE_COUNT int = null OUTPUT
AS
SET NOCOUNT ON;
BEGIN
SELECT @TOTAL_INSPECTIONCASE_COUNT = Count(1)
FROM     IMINSPECTIONCASE INNER JOIN 
IMINSPECTIONCASETYPE ON IMINSPECTIONCASE.IMINSPECTIONCASETYPEID = IMINSPECTIONCASETYPE.IMINSPECTIONCASETYPEID INNER JOIN
IMINSPECTIONCASESTATUS ON IMINSPECTIONCASE.IMINSPECTIONCASESTATUSID = IMINSPECTIONCASESTATUS.IMINSPECTIONCASESTATUSID 
INNER JOIN GETUSERVISIBLERECORDTYPES(@USER_ID) u on IMINSPECTIONCASE.IMINSPECTIONCASETYPEID = u.RECORDTYPEID
WHERE (IMINSPECTIONCASE.LINKID = @LINKEDCASEID)
END