

CREATE PROCEDURE [dbo].[RPT_PM_PERMITS_ISSUED_BY_CONTRACTOR]
@STARTDATE AS DATETIME,
@ENDDATE AS DATETIME
AS
SET @ENDDATE = DATEADD(S,-1,DATEADD(D,1,@ENDDATE))
SELECT PMPERMIT.PERMITNUMBER AS PERMITNUMBER, GLOBALENTITY.GLOBALENTITYNAME AS COMPANYNAME, GLOBALENTITY.FIRSTNAME AS FIRSTNAME, 
       GLOBALENTITY.LASTNAME AS LASTNAME, PMPERMITWORKCLASS.NAME AS WORKCLASS, PMPERMITTYPE.NAME AS PERMITTYPE, 
       PMPERMITSTATUS.NAME AS PERMITSTATUS, PMPERMIT.ISSUEDATE AS ISSUEDATE, PMPERMIT.PMPERMITID AS PMPERMITID
FROM PMPERMIT 
INNER JOIN PMPERMITCONTACT ON PMPERMIT.PMPERMITID = PMPERMITCONTACT.PMPERMITID 
INNER JOIN GLOBALENTITY ON PMPERMITCONTACT.GLOBALENTITYID = GLOBALENTITY.GLOBALENTITYID 
INNER JOIN LANDMANAGEMENTCONTACTTYPE ON PMPERMITCONTACT.LANDMANAGEMENTCONTACTTYPEID = LANDMANAGEMENTCONTACTTYPE.LANDMANAGEMENTCONTACTTYPEID 
INNER JOIN PMPERMITTYPE ON PMPERMIT.PMPERMITTYPEID = PMPERMITTYPE.PMPERMITTYPEID 
INNER JOIN PMPERMITWORKCLASS ON PMPERMIT.PMPERMITWORKCLASSID = PMPERMITWORKCLASS.PMPERMITWORKCLASSID 
INNER JOIN PMPERMITSTATUS ON PMPERMIT.PMPERMITSTATUSID = PMPERMITSTATUS.PMPERMITSTATUSID
WHERE PMPERMIT.ISSUEDATE BETWEEN @STARTDATE AND @ENDDATE 
AND LANDMANAGEMENTCONTACTTYPE.NAME = 'Contractor'

