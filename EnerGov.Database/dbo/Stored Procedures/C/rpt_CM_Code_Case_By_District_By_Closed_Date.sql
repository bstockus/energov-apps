


CREATE PROCEDURE [dbo].[rpt_CM_Code_Case_By_District_By_Closed_Date]
@STARTDATE AS DATETIME,
@ENDDATE AS DATETIME
AS
SET @ENDDATE = DATEADD(S,-1,DATEADD(D,1,@ENDDATE))

SELECT CMCaseType.NAME AS CaseType, CMCodeCase.CASENUMBER, 
       MailingAddress.PREDIRECTION, MailingAddress.ADDRESSLINE1, MailingAddress.ADDRESSLINE2, 
       MailingAddress.ADDRESSLINE3, MailingAddress.POSTDIRECTION, MailingAddress.STREETTYPE, 
       MailingAddress.CITY, MailingAddress.STATE, MailingAddress.POSTALCODE, Users.FNAME, 
       Users.LNAME, GlobalEntity.FIRSTNAME, GlobalEntity.LASTNAME, CMCodeCaseStatus.NAME AS CaseStatus, 
       CMCodeCase.CLOSEDDATE, District.NAME AS District
FROM CMCODECASE
INNER JOIN CMCASETYPE ON CMCODECASE.CMCASETYPEID = CMCASETYPE.CMCASETYPEID
INNER JOIN CMCODECASESTATUS ON CMCODECASESTATUS.CMCODECASESTATUSID = CMCODECASE.CMCODECASESTATUSID
LEFT OUTER JOIN DISTRICT ON DISTRICT.DISTRICTID = CMCODECASE.DISTRICTID
LEFT OUTER JOIN CMCODECASEADDRESS ON CMCODECASEADDRESS.CMCODECASEID = CMCODECASE.CMCODECASEID
LEFT OUTER JOIN MAILINGADDRESS ON MAILINGADDRESS.MAILINGADDRESSID = CMCODECASEADDRESS.MAILINGADDRESSID
LEFT OUTER JOIN CMCODECASECONTACT ON CMCODECASECONTACT.CMCODECASEID = CMCODECASE.CMCODECASEID
LEFT OUTER JOIN GLOBALENTITY ON GLOBALENTITY.GLOBALENTITYID = CMCODECASECONTACT.GLOBALENTITYID
LEFT OUTER JOIN USERS ON CMCODECASE.ASSIGNEDTO = USERS.SUSERGUID

WHERE CMCODECASE.CLOSEDDATE BETWEEN @STARTDATE AND @ENDDATE

ORDER BY DISTRICT.NAME


