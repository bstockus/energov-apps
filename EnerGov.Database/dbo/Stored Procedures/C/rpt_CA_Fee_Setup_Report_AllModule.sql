


CREATE PROCEDURE  [dbo].[rpt_CA_Fee_Setup_Report_AllModule]

AS


BEGIN

SELECT DISTINCT CAMODULE.NAME AS MODULE, 
       ISNULL(CONVERT(VARCHAR(10),CASCHEDULE.STARTDATE, 101),'N/A')STARTDATE , 
       ISNULL(CONVERT(VARCHAR(10),CASCHEDULE.ENDDATE,101),'N/A') ENDDATE,
       CAFEETEMPLATE.CAFEETEMPLATENAME AS FEE_TEMPLATE,
       CAFEE.NAME AS FEE_NAME,CAFEE.DESCRIPTION AS FEE_DESCRIP,
       CACOMPUTATIONTYPE.NAME AS FEE_TYPE,
       CASE CAFEETEMPLATEFEE.ISMANUAL WHEN 1 THEN 'Y' ELSE 'N' END AS MANUAL,
       CASE CAFEE.ACTIVE WHEN 1 THEN 'Y' ELSE 'N' END AS ACTIVE,
       CREDIT_ACCOUNT.ACCOUNTNUMBER AS CREDIT_GLACCOUNT,
       DEBIT_ACCCOUNT.ACCOUNTNUMBER AS DEBIT_GLACCOUNT
      
FROM  CAFEE 
INNER JOIN CAFEETEMPLATEFEE ON CAFEE.CAFEEID = CAFEETEMPLATEFEE.CAFEEID 
INNER JOIN CAFEETEMPLATE ON CAFEETEMPLATE.CAFEETEMPLATEID = CAFEETEMPLATEFEE.CAFEETEMPLATEID
INNER JOIN CAMODULEFEEXREF ON CAFEE.CAFEEID = CAMODULEFEEXREF.CAFEEID
INNER JOIN CAMODULE ON CAMODULEFEEXREF.CAMODULEID  = CAMODULE.CAMODULEID
INNER JOIN CACOMPUTATIONTYPE ON CAFEE.CACOMPUTATIONTYPEID = CACOMPUTATIONTYPE.CACOMPUTATIONTYPEID
LEFT OUTER JOIN CAFEESETUP ON CAFEE.CAFEEID = CAFEESETUP.CAFEEID
LEFT OUTER JOIN CASCHEDULE ON CAFEESETUP.CASCHEDULEID = CASCHEDULE.CASCHEDULEID 
LEFT OUTER JOIN CAFEEGLACCOUNTXREF ON CAFEE.CAFEEID = CAFEEGLACCOUNTXREF.CAFEEID
LEFT OUTER JOIN (SELECT * from GLACCOUNT WHERE NOT(NAME LIKE 'Bonds%')) CREDIT_ACCOUNT ON CAFEEGLACCOUNTXREF.CREDITGLACCOUNTID = CREDIT_ACCOUNT.GLACCOUNTID
LEFT OUTER JOIN (SELECT * from GLACCOUNT WHERE NOT(NAME LIKE 'Bonds%')) DEBIT_ACCCOUNT ON CAFEEGLACCOUNTXREF.DEBITGLACCOUNTID = DEBIT_ACCCOUNT.GLACCOUNTID
ORDER BY CAMODULE.NAME 


END



