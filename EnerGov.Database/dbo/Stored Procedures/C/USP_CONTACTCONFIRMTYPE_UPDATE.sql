CREATE PROCEDURE [dbo].[USP_CONTACTCONFIRMTYPE_UPDATE]
(
	@CONTACTCONFIRMTYPEID CHAR(36),
	@LANDMANAGEMENTCONTACTTYPEID CHAR(36),
	@MODULETYPE INT,
	@ISREQUIRE BIT,
	@HASEDITRIGHT BIT,
	@CANCREATESUBRECORD BIT,
	@LASTCHANGEDBY CHAR(36),
	@LASTCHANGEDON DATETIME,
	@ROWVERSION INT
)
AS

DECLARE @OUTPUTTABLE AS TABLE([ROWVERSION]  INT)
UPDATE	[dbo].[CONTACTCONFIRMTYPE]
SET		[LANDMANAGEMENTCONTACTTYPEID] = @LANDMANAGEMENTCONTACTTYPEID,
		[MODULETYPE] = @MODULETYPE,
		[ISREQUIRE] = @ISREQUIRE,
		[HASEDITRIGHT] = @HASEDITRIGHT,
		[CANCREATESUBRECORD] = @CANCREATESUBRECORD,
		[LASTCHANGEDBY] = @LASTCHANGEDBY,
		[LASTCHANGEDON] = @LASTCHANGEDON,
		[ROWVERSION] = @ROWVERSION + 1
OUTPUT inserted.[ROWVERSION] INTO @OUTPUTTABLE
WHERE
	[CONTACTCONFIRMTYPEID] = @CONTACTCONFIRMTYPEID AND
	[ROWVERSION]= @ROWVERSION

SELECT * FROM @OUTPUTTABLE