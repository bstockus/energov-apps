
CREATE PROCEDURE rpt_SR_SR_Data_Conversion_Standard_Verification_Type

AS

SELECT 'BUSINESS' RecordModule, xt.NAME RecordType, '' RecordClass, COUNT(1) RecordCount, 'a' as a
FROM BLGLOBALENTITYEXTENSION x
INNER JOIN BLEXTCOMPANYTYPE xt ON x.BLEXTCOMPANYTYPEID = xt.BLEXTCOMPANYTYPEID
GROUP BY xt.NAME
UNION ALL
SELECT 'CERTIFICATION', xt.NAME, '', COUNT(1), 'a' as a
FROM COLICENSECERTIFICATION x
INNER JOIN COLICENSECERTIFICATIONTYPE xt ON x.COSIMPLELICCERTTYPEID = xt.COSIMPLELICCERTTYPEID
GROUP BY xt.NAME
UNION ALL
SELECT 'PROFESSIONAL LICENSE', xt.NAME, xc.NAME, COUNT(1), 'a' as a
FROM ILLICENSE x
INNER JOIN ILLICENSETYPE xt ON x.ILLICENSETYPEID = xt.ILLICENSETYPEID
INNER JOIN ILLICENSECLASSIFICATION xc ON x.ILLICENSECLASSIFICATIONID = xc.ILLICENSECLASSIFICATIONID
GROUP BY xt.NAME, xc.NAME
UNION ALL
SELECT 'BUSINESS LICENSE', xt.NAME, xc.NAME, COUNT(1), 'a' as a
FROM BLLICENSE x
INNER JOIN BLLICENSETYPE xt ON x.BLLICENSETYPEID = xt.BLLICENSETYPEID
INNER JOIN BLLICENSECLASS xc ON x.BLLICENSECLASSID = xc.BLLICENSECLASSID
GROUP BY xt.NAME, xc.NAME
UNION ALL
SELECT 'PROJECT', xt.NAME, '', COUNT(1), 'a' as a
FROM PRPROJECT x
INNER JOIN PRPROJECTTYPE xt ON x.PRPROJECTTYPEID = xt.PRPROJECTTYPEID
GROUP BY xt.NAME
UNION ALL
SELECT 'CODE CASE', xt.NAME, '', COUNT(1), 'a' as a
FROM CMCODECASE x
INNER JOIN CMCASETYPE xt ON x.CMCASETYPEID = xt.CMCASETYPEID
GROUP BY xt.NAME
UNION ALL
SELECT 'REQUEST', xt.NAME, '', COUNT(1), 'a' as a
FROM CITIZENREQUEST x
INNER JOIN CITIZENREQUESTTYPE xt ON x.CITIZENREQUESTTYPEID = xt.CITIZENREQUESTTYPEID
GROUP BY xt.NAME
UNION ALL
SELECT 'PERMIT', xt.NAME, xc.NAME, COUNT(1), 'a' as a
FROM PMPERMIT x
INNER JOIN PMPERMITTYPE xt ON x.PMPERMITTYPEID = xt.PMPERMITTYPEID
INNER JOIN PMPERMITWORKCLASS xc ON x.PMPERMITWORKCLASSID = xc.PMPERMITWORKCLASSID
GROUP BY xt.NAME, xc.NAME
UNION ALL
SELECT 'PLAN', xt.PLANNAME, xc.NAME, COUNT(1), 'a' as a
FROM PLPLAN x
INNER JOIN PLPLANTYPE xt ON x.PLPLANTYPEID = xt.PLPLANTYPEID
INNER JOIN PLPLANWORKCLASS xc ON x.PLPLANWORKCLASSID = xc.PLPLANWORKCLASSID
GROUP BY xt.PLANNAME, xc.NAME

