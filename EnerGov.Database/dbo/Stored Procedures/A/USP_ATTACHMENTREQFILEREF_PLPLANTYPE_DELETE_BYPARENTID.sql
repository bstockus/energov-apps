CREATE PROCEDURE [dbo].[USP_ATTACHMENTREQFILEREF_PLPLANTYPE_DELETE_BYPARENTID]  
(  
@PLANTYPEID CHAR(36),
@PLANTYPEWORKCLASSID CHAR(36)
)  
AS  
DELETE [dbo].[ATTACHMENTREQFILEREF] FROM [dbo].[ATTACHMENTREQFILEREF]
INNER JOIN [dbo].[PLPLANTYPEWORKCLASS] ON [dbo].[ATTACHMENTREQFILEREF].[OBJECTTYPEID] = [dbo].[PLPLANTYPEWORKCLASS].[PLPLANTYPEWORKCLASSID]
WHERE
	[dbo].[PLPLANTYPEWORKCLASS].[PLPLANTYPEID] = @PLANTYPEID AND (@PLANTYPEWORKCLASSID IS NULL OR [dbo].[ATTACHMENTREQFILEREF].[OBJECTTYPEID] = @PLANTYPEWORKCLASSID)