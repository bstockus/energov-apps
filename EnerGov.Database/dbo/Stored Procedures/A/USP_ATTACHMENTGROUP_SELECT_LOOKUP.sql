CREATE PROCEDURE [dbo].[USP_ATTACHMENTGROUP_SELECT_LOOKUP]
(
	@ATTACHMENTGROUPMODULETYPE INT,
	@ROLEID CHAR(36) = NULL
)
AS
SET NOCOUNT ON;
SELECT	
	[dbo].[ATTACHMENTGROUP].[ATTACHMENTGROUPID],
	[dbo].[ATTACHMENTGROUP].[NAME]
FROM [dbo].[ATTACHMENTGROUP]
	LEFT JOIN [dbo].[ATTACHMENTGROUPROLEXREF] ON [dbo].[ATTACHMENTGROUPROLEXREF].[ATTACHMENTGROUPID] = [dbo].[ATTACHMENTGROUP].[ATTACHMENTGROUPID]
		AND [dbo].[ATTACHMENTGROUPROLEXREF].[ROLEID] = @ROLEID
WHERE (CASE 
			WHEN @ATTACHMENTGROUPMODULETYPE=1 THEN AVAILINPERMIT --Permits
			WHEN @ATTACHMENTGROUPMODULETYPE=2 THEN AVAILINPLAN --Plans
			WHEN @ATTACHMENTGROUPMODULETYPE=3 THEN AVAILINCODE --code	
			WHEN @ATTACHMENTGROUPMODULETYPE=4 THEN AVAILINCRM --CRM
			WHEN @ATTACHMENTGROUPMODULETYPE=5 THEN AVAILINPROJECT --project
			WHEN @ATTACHMENTGROUPMODULETYPE=6 THEN AVAILINWORKORDER --work order
			WHEN @ATTACHMENTGROUPMODULETYPE=7 THEN AVAILINASSET --asset
			WHEN @ATTACHMENTGROUPMODULETYPE=8 THEN AVAILININVOICE --invoice
			WHEN @ATTACHMENTGROUPMODULETYPE=9 THEN AVAILINPAYMENT --payment
			WHEN @ATTACHMENTGROUPMODULETYPE=10 THEN AVAILININSPECTION --inspection
			WHEN @ATTACHMENTGROUPMODULETYPE=11 THEN AVAILINCONTACT --contact
			WHEN @ATTACHMENTGROUPMODULETYPE=12 THEN AVAILINBUSINESSLICENSE --business license
			WHEN @ATTACHMENTGROUPMODULETYPE=14 THEN AVAILINBUSINESS --business
			WHEN @ATTACHMENTGROUPMODULETYPE=13 THEN AVAILINPROLICENSE --professional license
			WHEN @ATTACHMENTGROUPMODULETYPE=19 THEN AVAILINEXAMSITTING --exam sitting
			WHEN @ATTACHMENTGROUPMODULETYPE=18 THEN AVAILINEXAMREQUEST --exam request
			WHEN @ATTACHMENTGROUPMODULETYPE=17 THEN AVAILINEXAMLANDLORD --landlord license
			WHEN @ATTACHMENTGROUPMODULETYPE=16 THEN AVAILINEXAMRENTALPROPERTY --rental property
			WHEN @ATTACHMENTGROUPMODULETYPE=15 THEN AVAILINEXAMTAXREMITTANCE --tax remittance
			WHEN @ATTACHMENTGROUPMODULETYPE=25 THEN AVAILINCAP --cap		
			WHEN @ATTACHMENTGROUPMODULETYPE=23 THEN AVAILINOBJEC --object MGMT
			WHEN @ATTACHMENTGROUPMODULETYPE=24 THEN AVAILINIMPACTCASE --impact case
			WHEN @ATTACHMENTGROUPMODULETYPE=35 THEN AVAILINFIREOCCUPANCY --fire occupancy
		END)=1	
		AND (@ROLEID IS NULL OR [dbo].[ATTACHMENTGROUPROLEXREF].[ROLEID] = @ROLEID)
ORDER BY [dbo].[ATTACHMENTGROUP].[NAME]