CREATE PROCEDURE [dbo].[USP_QUERYACTIONATTACHDOC_DELETE_BYPARENTID]
(
	@QUERYID CHAR(36),
	@QUERYACTIONID CHAR(36)
)
AS
DELETE [dbo].[QUERYACTIONATTACHDOC] 
FROM [dbo].[QUERYACTIONATTACHDOC]
JOIN [dbo].[QUERYACTION] ON [dbo].[QUERYACTIONATTACHDOC].QUERYACTIONID = [dbo].[QUERYACTION].QUERYACTIONID
WHERE
	([dbo].[QUERYACTION].[QUERYID] = @QUERYID) AND
	(@QUERYACTIONID IS NULL OR [dbo].[QUERYACTIONATTACHDOC].QUERYACTIONID = @QUERYACTIONID)