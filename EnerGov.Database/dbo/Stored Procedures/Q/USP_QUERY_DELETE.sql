CREATE PROCEDURE [dbo].[USP_QUERY_DELETE]
(
	@QUERYID CHAR(36),
	@ROWVERSION INT
)
AS
SET NOCOUNT ON;

-- Delete Query Actions
EXEC [dbo].[USP_QUERYACTION_DELETE_BYPARENTID] @QUERYID

SET NOCOUNT OFF;

DELETE FROM [dbo].[QUERY]
WHERE [dbo].[QUERY].[QUERYID] = @QUERYID AND [dbo].[QUERY].[ROWVERSION] = @ROWVERSION