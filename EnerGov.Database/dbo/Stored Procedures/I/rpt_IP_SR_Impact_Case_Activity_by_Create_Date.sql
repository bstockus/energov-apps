
CREATE PROCEDURE rpt_IP_SR_Impact_Case_Activity_by_Create_Date
	@STARTDATE AS DATETIME,
	@ENDDATE AS DATETIME
AS

SET @STARTDATE = DATEADD(dd, DATEDIFF(dd, 0, @startdate), 0)
SET @ENDDATE = DATEADD(S,-1,DATEADD(D,1,@ENDDATE)) 

SELECT IPCASE.IPCASEID, IPCASE.CASENUMBER, IPCASETYPE.NAME AS CaseType, IPCASE.DESCRIPTION, IPCASE.CREATEDDATE, IPCASE.SOURCECASENUMBER,
		--(SELECT R.[IMAGE] FROM RPTIMAGELIB R
		--	WHERE R.IMAGENAME = 'Municipality_Logo') LOGO,
		(SELECT CASE WHEN R.[IMAGE] IS NULL THEN 'N' ELSE 'Y' END FROM RPTIMAGELIB R
			WHERE R.IMAGENAME = 'Municipality_Logo') SHOWLOGO,
		(SELECT R.REPORTTEXT FROM RPTTEXTLIB R
			WHERE R.TEXTNAME = 'Municipality_Name') Municipality_Name,	   
		(SELECT R.REPORTTEXT FROM RPTTEXTLIB R
			WHERE R.TEXTNAME = 'Municipality_Page_Footer') Municipality_Page_Footer
FROM IPCASE
INNER JOIN IPCASETYPE ON IPCASE.IPCASETYPEID = IPCASETYPE.IPCASETYPEID

WHERE IPCASE.CREATEDDATE BETWEEN @STARTDATE AND @ENDDATE

