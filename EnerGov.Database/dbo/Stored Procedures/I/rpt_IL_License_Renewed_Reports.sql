


CREATE PROCEDURE [dbo].[rpt_IL_License_Renewed_Reports]
@STARTDATE AS DATETIME,
@ENDDATE AS DATETIME
AS
SET @ENDDATE = DATEADD(S,-1,DATEADD(D,1,@ENDDATE))

SELECT GLOBALENTITY.GLOBALENTITYNAME AS CompanyName, ILLICENSE.LICENSENUMBER AS LicenseNumber, ILLICENSE.APPLIEDDATE AS AppliedDate, 
       ILLICENSE.ISSUEDATE AS IssueDate, ILLICENSE.EXPIRATIONDATE AS ExpirationDate, ILLICENSE.LASTRENEWALDATE AS LastRenewalDate, 
       DISTRICT.NAME AS District, ILLICENSECLASSIFICATION.NAME AS Classification, ILLICENSESTATUS.NAME AS Status, ILLICENSETYPE.NAME AS LicenseType,
       ILLICENSE.LICENSEYEAR AS LicenseYear
FROM ILLICENSE 
INNER JOIN ILLICENSETYPE ON ILLICENSE.ILLICENSETYPEID = ILLICENSETYPE.ILLICENSETYPEID
INNER JOIN ILLICENSECLASSIFICATION ON ILLICENSE.ILLICENSECLASSIFICATIONID = ILLICENSECLASSIFICATION.ILLICENSECLASSIFICATIONID 
INNER JOIN ILLICENSESTATUS ON ILLICENSE.ILLICENSESTATUSID = ILLICENSESTATUS.ILLICENSESTATUSID 
INNER JOIN DISTRICT ON ILLICENSE.DISTRICTID = DISTRICT.DISTRICTID 
INNER JOIN GLOBALENTITY ON ILLICENSE.GLOBALENTITYID = GLOBALENTITY.GLOBALENTITYID 
WHERE ILLICENSE.LASTRENEWALDATE BETWEEN @STARTDATE AND @ENDDATE


