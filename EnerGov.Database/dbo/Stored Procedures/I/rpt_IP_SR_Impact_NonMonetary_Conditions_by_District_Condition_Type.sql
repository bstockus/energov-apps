
CREATE PROCEDURE rpt_IP_SR_Impact_NonMonetary_Conditions_by_District_Condition_Type

AS

BEGIN
SET NOCOUNT ON;

SELECT	DISTRICT.NAME AS DISTRICTNAME, 
		IPCONDITION.CONDITIONNUMBER, IPCONDITION.DESCRIPTION AS IPCONDITIONDESCRIPTION,
		IPCONDITIONTYPE.NAME AS IPCONDITIONTYPE, 
		IPCASE.SOURCECASENUMBER, IPCASE.IPCASEID, IPCASE.CASENUMBER,
		--(SELECT R.[IMAGE] FROM RPTIMAGELIB R
		--	WHERE R.IMAGENAME = 'Municipality_Logo') LOGO,
		(SELECT CASE WHEN R.[IMAGE] IS NULL THEN 'N' ELSE 'Y' END FROM RPTIMAGELIB R
			WHERE R.IMAGENAME = 'Municipality_Logo') SHOWLOGO,
		(SELECT R.REPORTTEXT FROM RPTTEXTLIB R
			WHERE R.TEXTNAME = 'Municipality_Name') Municipality_Name,	   
		(SELECT R.REPORTTEXT FROM RPTTEXTLIB R
			WHERE R.TEXTNAME = 'Municipality_Page_Footer') Municipality_Page_Footer

FROM	IPCASE
		INNER JOIN IPCASETYPE ON IPCASE.IPCASETYPEID = IPCASETYPE.IPCASETYPEID
		INNER JOIN IPCONDITION ON IPCASE.IPCASEID = IPCONDITION.IPCASEID
		INNER JOIN IPCONDITIONTYPE ON IPCONDITION.IPCONDITIONTYPEID = IPCONDITIONTYPE.IPCONDITIONTYPEID
		INNER JOIN DISTRICT ON IPCASE.DISTRICTID = DISTRICT.DISTRICTID

WHERE IPCONDITION.MONETARY = 0

END

