CREATE PROCEDURE [dbo].[USP_INTEGRATION_GET_BATCH_REFUND_CONTACT_INFO]
	@GLOBALENTITYID AS CHAR(36)
AS

BEGIN

SELECT TOP 1 
CASE WHEN LTRIM(RTRIM(COALESCE(GLOBALENTITYNAME, ''))) = '' THEN COALESCE(FIRSTNAME + ' ', '') + COALESCE(LASTNAME, '') ELSE GLOBALENTITYNAME END AS ContactName, 
ADDRESSLINE1, PREDIRECTION, ADDRESSLINE2, STREETTYPE, POSTDIRECTION, UNITORSUITE, CITY, STATE, POSTALCODE
FROM GLOBALENTITY
LEFT OUTER JOIN GLOBALENTITYMAILINGADDRESS ON GLOBALENTITYMAILINGADDRESS.GLOBALENTITYID = GLOBALENTITY.GLOBALENTITYID
LEFT OUTER JOIN MAILINGADDRESS ON GLOBALENTITYMAILINGADDRESS.MAILINGADDRESSID = MAILINGADDRESS.MAILINGADDRESSID
WHERE GLOBALENTITY.GLOBALENTITYID = @GLOBALENTITYID

END