CREATE PROCEDURE [maps].[USP_MAPTILE_UPDATE]
(
	@MAPTILEID VARCHAR(36),
	@MAPNAME VARCHAR(35),
	@MAPDESCRIPTION VARCHAR(200),
	@MAPURL VARCHAR(MAX),
	@MAPIMAGE VARCHAR(MAX),
	@USERID CHAR(36),
	@LASTCHANGEDBY CHAR(36),
	@LASTCHANGEDON DATETIME,
	@ROWVERSION INT
)
AS
BEGIN
	DECLARE @OUTPUTTABLE as TABLE([ROWVERSION]  int)
	UPDATE [dbo].[MAPTILE] 
		SET [MAPNAME] = @MAPNAME,
			[MAPDESCRIPTION] = @MAPDESCRIPTION,
			[MAPURL] = @MAPURL,
			[MAPIMAGE] = @MAPIMAGE,
			[USERID] = @USERID,
			[LASTCHANGEDBY] = @LASTCHANGEDBY,
			[LASTCHANGEDON] = @LASTCHANGEDON,
			[ROWVERSION] = @ROWVERSION + 1
	OUTPUT inserted.[ROWVERSION] INTO @OUTPUTTABLE
	WHERE 
		MAPTILEID = @MAPTILEID AND [ROWVERSION]= @ROWVERSION

	SELECT * FROM @OUTPUTTABLE
END