CREATE PROCEDURE [energovhub].[USP_HUB_PROJECTDATAADDRESS]
AS
BEGIN
  SET NOCOUNT ON;

 SELECT
        [PRPROJECT].[PRPROJECTID],
		[PRPROJECT].[PROJECTNUMBER], 
		MAILINGADDRESS.ADDRESSLINE1,
		MAILINGADDRESS.ADDRESSLINE2,
		MAILINGADDRESS.ADDRESSLINE3,
		MAILINGADDRESS.ADDRESSTYPE,
		MAILINGADDRESS.ATTN,
		MAILINGADDRESS.CITY,
		MAILINGADDRESS.COMPSITE,
		MAILINGADDRESS.COUNTRY,
		MAILINGADDRESSCOUNTRYTYPE.MAILINGADDRESSCOUNTRYTYPEID,
		MAILINGADDRESSCOUNTRYTYPE.MAILINGADDRESSCOUNTRYTYPENAME,
		[PRPROJECTADDRESS].MAIN,
		MAILINGADDRESS.POBOX,
		MAILINGADDRESS.POSTALCODE,
		MAILINGADDRESS.POSTDIRECTION,
		MAILINGADDRESS.PREDIRECTION,
		MAILINGADDRESS.PROVINCE,
		MAILINGADDRESS.RURALROUTE,
		MAILINGADDRESS.STATE,
		MAILINGADDRESS.STATION,
		MAILINGADDRESS.STREETTYPE,
		MAILINGADDRESS.UNITORSUITE,
		MAILINGADDRESS.ADDRESSID
 FROM [dbo].[PRPROJECTADDRESS]
    INNER JOIN [dbo].[MAILINGADDRESS] ON [PRPROJECTADDRESS].[MAILINGADDRESSID] = [MAILINGADDRESS].[MAILINGADDRESSID]
    INNER JOIN [dbo].[PRPROJECT] ON [PRPROJECTADDRESS].[PRPROJECTID] = [PRPROJECT].[PRPROJECTID]
	INNER JOIN MAILINGADDRESSCOUNTRYTYPE ON MAILINGADDRESS.COUNTRYTYPE = MAILINGADDRESSCOUNTRYTYPE.MAILINGADDRESSCOUNTRYTYPEID
    WHERE [PRPROJECTADDRESS].[PRPROJECTID] = [PRPROJECT].[PRPROJECTID]
    ORDER BY [PRPROJECTADDRESS].[MAIN] DESC
END