CREATE PROCEDURE [energovhub].[USP_PLANPERMITBOND_GETALL]    
AS  
BEGIN    
SET NOCOUNT ON;

 SELECT   
		[PMPERMITBOND].[BONDID],
		[BOND].[BONDEXPIRATIONDATE],
		[BOND].[AMOUNT],
		[BONDSTATUS].[NAME] AS BONDSTATUSNAME,
		[BOND].[BONDNUMBER],
		[PMPERMIT].[PERMITNUMBER],	
		'Permit' AS MODULETYPEID,
		[BONDTYPE].[NAME] AS BONDTYPENAME
 FROM  [dbo].[PMPERMITBOND]
		 INNER JOIN [dbo].[BOND] ON [PMPERMITBOND].[BONDID] = [BOND].[BONDID]
		 INNER JOIN [dbo].[BONDTYPE] ON [BOND].[BONDTYPEID] = [BONDTYPE].[BONDTYPEID]
		 INNER JOIN [dbo].[BONDSTATUS] ON [BOND].[BONDSTATUSID] = [BONDSTATUS].[BONDSTATUSID]
		 INNER JOIN [dbo].[PMPERMIT] ON [PMPERMITBOND].[PMPERMITID] = [PMPERMIT].[PMPERMITID]

  UNION ALL

  SELECT   
		[PLPLANBOND].[BONDID],
		[BOND].[BONDEXPIRATIONDATE],
		[BOND].[AMOUNT],
		[BONDSTATUS].[NAME] AS BONDSTATUSNAME,
		[BOND].[BONDNUMBER],
		[PLPLAN].[PLANNUMBER],
		'Plan' AS MODULETYPEID,
		[BONDTYPE].[NAME] AS BONDTYPENAME
  FROM  [dbo].[PLPLANBOND]
		INNER JOIN [dbo].[BOND] ON [PLPLANBOND].[BONDID] = [BOND].[BONDID]
		INNER JOIN [dbo].[BONDSTATUS] ON [BOND].[BONDSTATUSID] = [BONDSTATUS].[BONDSTATUSID]
		INNER JOIN [dbo].[PLPLAN] ON [PLPLANBOND].[PLPLANID] = [PLPLAN].[PLPLANID]
		INNER JOIN [dbo].[BONDTYPE] ON [BOND].[BONDTYPEID] = [BONDTYPE].[BONDTYPEID]
END