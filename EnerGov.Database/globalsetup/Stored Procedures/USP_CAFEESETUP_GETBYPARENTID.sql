CREATE PROCEDURE [globalsetup].[USP_CAFEESETUP_GETBYPARENTID]
(
	@PARENTID CHAR(36)
)
AS
BEGIN
	SET NOCOUNT ON;
	SELECT 
		[dbo].[CAFEESETUP].[CAFEESETUPID],
		[dbo].[CAFEESETUP].[CAFEEID],
		[dbo].[CAFEESETUP].[CASCHEDULEID],
		[dbo].[CAFEESETUP].[AMOUNT],
		[dbo].[CAFEESETUP].[MINIMUMAMOUNT],
		[dbo].[CAFEESETUP].[MAXIMUMAMOUNT],
		[dbo].[CAFEESETUP].[COMPUTATIONVALUE],
		[dbo].[CAFEESETUP].[COMPUTATIONVALUENAME],
		[dbo].[CAFEESETUP].[ROUNDINGTYPEID],
		[dbo].[CAFEESETUP].[ROUNDINGVALUE],
		[dbo].[CAFEESETUP].[ROWVERSION],
		[dbo].[CAFEESETUP].[LASTCHANGEDBY],
		[dbo].[CAFEESETUP].[LASTCHANGEDON],
		[dbo].[CAFEESETUP].[CAPRORATESCHEDULEID],
		[dbo].[CAFEESETUP].[CAPRORATIONMODELID],
		[dbo].[CAFEESETUP].[CACPITYPEID],
		[dbo].[CAFEESETUP].[CPIORIGINALFEEDATE],
		[dbo].[CAFEESETUP].[CAFEECOMPOUNDINGFREQUENCYTYPEID],
		[dbo].[CACPITYPE].[NAME] AS [CACPITYPENAME]
	FROM [dbo].[CAFEESETUP]
	LEFT JOIN [dbo].[CASCHEDULE] WITH (NOLOCK) ON [dbo].[CASCHEDULE].[CASCHEDULEID] = [dbo].[CAFEESETUP].[CASCHEDULEID]
	LEFT JOIN [dbo].[CACPITYPE] WITH (NOLOCK) ON [dbo].[CACPITYPE].[CACPITYPEID] = [dbo].[CAFEESETUP].[CACPITYPEID]
	WHERE [dbo].[CAFEESETUP].[CAFEEID] = @PARENTID
	ORDER BY CASE 
		WHEN [dbo].[CASCHEDULE].[NAME] IS NOT NULL THEN 1
		ELSE 0
		END
END