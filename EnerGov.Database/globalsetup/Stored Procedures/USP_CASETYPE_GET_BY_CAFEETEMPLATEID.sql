CREATE PROCEDURE [globalsetup].[USP_CASETYPE_GET_BY_CAFEETEMPLATEID]
(
  @CAFEETEMPLATEID AS CHAR(36)
)
AS
BEGIN
SET NOCOUNT ON;
SELECT * FROM
(
  -- Pemit
 SELECT 1 AS ENTITYID,
    [dbo].[PMPERMITTYPE].[PMPERMITTYPEID] AS TYPEID,
    [dbo].[PMPERMITTYPE].[NAME] AS TYPENAME,
    [dbo].[PMPERMITWORKCLASS].[NAME] AS WORKCLASSNAME,
    (SELECT NAME FROM [dbo].[CAENTITY] WHERE [dbo].[CAENTITY].[CAENTITYID] = 1) AS MODULENAME
   FROM [dbo].[PMPERMITTYPE]
     INNER JOIN [dbo].[PMPERMITTYPEWORKCLASS] ON [dbo].[PMPERMITTYPE].[PMPERMITTYPEID] = [dbo].[PMPERMITTYPEWORKCLASS].[PMPERMITTYPEID]
     INNER JOIN [dbo].[PMPERMITWORKCLASS] ON [dbo].[PMPERMITWORKCLASS].[PMPERMITWORKCLASSID] = [dbo].[PMPERMITTYPEWORKCLASS].[PMPERMITWORKCLASSID]
   WHERE [dbo].[PMPERMITTYPEWORKCLASS].[CAFEETEMPLATEID] = @CAFEETEMPLATEID

   UNION ALL
  -- Code
  SELECT 2 AS ENTITYID,
    [dbo].[CMCASETYPE].CMCASETYPEID AS TYPEID,
    [dbo].[CMCASETYPE].[NAME] AS TYPENAME,
    NULL AS WORKCLASSNAME,
	 (SELECT NAME FROM [dbo].[CAENTITY] WHERE [dbo].[CAENTITY].[CAENTITYID] = 2) AS MODULENAME
   FROM [dbo].[CMCASETYPE]
   WHERE [dbo].[CMCASETYPE].[CAFEETEMPLATEID] = @CAFEETEMPLATEID

    UNION ALL
  -- Application
  SELECT 4 AS ENTITYID,
    [dbo].[PLAPPLICATIONTYPE].[PLAPPLICATIONTYPEID] AS TYPEID,
    [dbo].[PLAPPLICATIONTYPE].[APPLICATIONTYPENAME] AS TYPENAME,
    NULL AS WORKCLASSNAME,
    (SELECT NAME FROM [dbo].[CAENTITY] WHERE [dbo].[CAENTITY].[CAENTITYID] = 4) AS MODULENAME
   FROM [dbo].[PLAPPLICATIONTYPE]
   WHERE [dbo].[PLAPPLICATIONTYPE].[CAFEETEMPLATEID] = @CAFEETEMPLATEID

    UNION ALL
   --Plan
  SELECT 5 AS ENTITYID,
    [dbo].[PLPLANTYPE].[PLPLANTYPEID] AS TYPEID,
    [dbo].[PLPLANTYPE].[PLANNAME] AS TYPENAME,
    [dbo].[PLPLANWORKCLASS].[NAME] AS WORKCLASSNAME,
    (SELECT NAME FROM [dbo].[CAENTITY] WHERE [dbo].[CAENTITY].[CAENTITYID] = 5) AS MODULENAME
   FROM [dbo].[PLPLANTYPE]
     INNER JOIN [dbo].[PLPLANTYPEWORKCLASS] ON [dbo].[PLPLANTYPE].[PLPLANTYPEID] = [dbo].[PLPLANTYPEWORKCLASS].[PLPLANTYPEID]
     INNER JOIN  [dbo].[PLPLANWORKCLASS] ON [dbo].[PLPLANWORKCLASS].[PLPLANWORKCLASSID] = [dbo].[PLPLANTYPEWORKCLASS].[PLPLANWORKCLASSID]
   WHERE [dbo].[PLPLANTYPEWORKCLASS].[CAFEETEMPLATEID] = @CAFEETEMPLATEID

   UNION ALL
  -- Project
  SELECT 6 AS ENTITYID,
    [dbo].[PRPROJECTTYPE].PRPROJECTTYPEID AS TYPEID,
    [dbo].[PRPROJECTTYPE].[NAME] AS TYPENAME,
    NULL AS WORKCLASSNAME,
    (SELECT NAME FROM [dbo].[CAENTITY] WHERE [dbo].[CAENTITY].[CAENTITYID] = 6) AS MODULENAME
   FROM [dbo].[PRPROJECTTYPE]
   WHERE [dbo].[PRPROJECTTYPE].[CAFEETEMPLATEID] = @CAFEETEMPLATEID

    UNION ALL
  -- Business License
  SELECT 7 AS ENTITYID,
    [dbo].[BLLICENSETYPE].[BLLICENSETYPEID] AS TYPEID,
    [dbo].[BLLICENSETYPE].[NAME] AS TYPENAME,
    [dbo].[BLLICENSECLASS].[NAME] AS WORKCLASSNAME,
    (SELECT NAME FROM [dbo].[CAENTITY] WHERE [dbo].[CAENTITY].[CAENTITYID] = 7) AS MODULENAME
   FROM [dbo].[BLLICENSETYPE]
    INNER JOIN [dbo].[BLLICENSETYPECLASS] ON [dbo].[BLLICENSETYPE].[BLLICENSETYPEID] = [dbo].[BLLICENSETYPECLASS].[BLLICENSETYPEID]
    INNER JOIN  [dbo].[BLLICENSECLASS] ON [dbo].[BLLICENSECLASS].[BLLICENSECLASSID] = [dbo].[BLLICENSETYPECLASS].[BLLICENSECLASSID]
   WHERE [dbo].[BLLICENSETYPECLASS].[CAFEETEMPLATEID] = @CAFEETEMPLATEID

    UNION ALL
  -- Professional License
  SELECT 8 AS ENTITYID,
    [dbo].[ILLICENSETYPE].[ILLICENSETYPEID] AS TYPEID,
    [dbo].[ILLICENSETYPE].[NAME] AS TYPENAME,
    [dbo].[ILLICENSECLASSIFICATION].[NAME] AS WORKCLASSNAME,
    (SELECT NAME FROM [dbo].[CAENTITY] WHERE [dbo].[CAENTITY].[CAENTITYID] = 8) AS MODULENAME
   FROM [dbo].[ILLICENSETYPE]
    INNER JOIN [dbo].[ILLICENSETYPELICENSECLASS] ON [dbo].[ILLICENSETYPE].[ILLICENSETYPEID] = [dbo].[ILLICENSETYPELICENSECLASS].[ILLICENSETYPEID]
    INNER JOIN  [dbo].[ILLICENSECLASSIFICATION] ON [dbo].[ILLICENSECLASSIFICATION].[ILLICENSECLASSIFICATIONID] = [dbo].[ILLICENSETYPELICENSECLASS].[ILLICENSECLASSIFICATIONID]
   WHERE [dbo].[ILLICENSETYPELICENSECLASS].[CAFEETEMPLATEID] = @CAFEETEMPLATEID

   UNION ALL
  -- Tax Remittance Management
  SELECT 9 AS ENTITYID,
    [dbo].[TXREMITTANCETYPE].TXREMITTANCETYPEID AS TYPEID,
    [dbo].[TXREMITTANCETYPE].[NAME] AS TYPENAME,
    NULL AS WORKCLASSNAME,
     (SELECT NAME FROM [dbo].[CAENTITY] WHERE [dbo].[CAENTITY].[CAENTITYID] = 9) AS MODULENAME
    FROM [dbo].[TXREMITTANCETYPE]
   WHERE [dbo].[TXREMITTANCETYPE].[CAFEETEMPLATEID] = @CAFEETEMPLATEID

   UNION ALL
     -- Landlord License
  SELECT 11 AS ENTITYID,
    [dbo].[RPLANDLORDLICENSETYPE].[RPLANDLORDLICENSETYPEID] AS TYPEID,
    [dbo].[RPLANDLORDLICENSETYPE].[NAME] AS TYPENAME,
    NULL AS WORKCLASSNAME,
     (SELECT NAME FROM [dbo].[CAENTITY] WHERE [dbo].[CAENTITY].[CAENTITYID] = 11) AS MODULENAME
    FROM [dbo].[RPLANDLORDLICENSETYPE]
   WHERE [dbo].[RPLANDLORDLICENSETYPE].[CAFEETEMPLATEID] = @CAFEETEMPLATEID

   UNION ALL
    ---- Inspection
  SELECT 12 AS ENTITYID,
    [dbo].[IMINSPECTIONTYPE].[IMINSPECTIONTYPEID] AS TYPEID,
    [dbo].[IMINSPECTIONTYPE].[NAME] AS TYPENAME,
    NULL AS WORKCLASSNAME,
    (SELECT NAME FROM [dbo].[CAENTITY] WHERE [dbo].[CAENTITY].[CAENTITYID] = 12) AS MODULENAME
   FROM [dbo].[IMINSPECTIONTYPE]
   WHERE [dbo].[IMINSPECTIONTYPE].[CAFEETEMPLATEID] = @CAFEETEMPLATEID

   UNION ALL
    ---- Impact Condition
  SELECT 13 AS ENTITYID,
    [dbo].[IPCONDITIONTYPE].[IPCONDITIONTYPEID] AS TYPEID,
    [dbo].[IPCONDITIONTYPE].[NAME] AS TYPENAME,
    NULL AS WORKCLASSNAME,
    (SELECT NAME FROM [dbo].[CAENTITY] WHERE [dbo].[CAENTITY].[CAENTITYID] = 13) AS MODULENAME
   FROM [dbo].[IPCONDITIONTYPE]
   WHERE [dbo].[IPCONDITIONTYPE].[CAFEETEMPLATEID] = @CAFEETEMPLATEID) AS FEETEMPLATECASETYPES
   ORDER BY FEETEMPLATECASETYPES.MODULENAME,FEETEMPLATECASETYPES.TYPENAME,FEETEMPLATECASETYPES.WORKCLASSNAME 
END