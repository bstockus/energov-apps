CREATE PROCEDURE [globalsetup].[USP_SERVICETASKHISTORY_RESULT_FILTERS_BYCRITERIA]
(
	@SERVICETASKID	INT,
	@STARTDATETIME	DATE = NULL,
	@ENDDATETIME	DATE = NULL
)
AS
BEGIN
SET NOCOUNT ON;

SELECT DISTINCT	[dbo].[SERVICETASKHISTORY].[RESULT]
FROM 
	[dbo].[SERVICETASKHISTORY]
WHERE
		[dbo].[SERVICETASKHISTORY].[SERVICETASKID] = @SERVICETASKID
	AND 
		(@STARTDATETIME IS NULL OR [dbo].[SERVICETASKHISTORY].[STARTTIME] >= @STARTDATETIME )
	AND 
		(@ENDDATETIME IS NULL OR [dbo].[SERVICETASKHISTORY].[STARTTIME] < @ENDDATETIME)
END