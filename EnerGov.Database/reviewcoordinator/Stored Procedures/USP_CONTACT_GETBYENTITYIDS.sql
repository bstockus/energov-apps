CREATE PROCEDURE [reviewcoordinator].[USP_CONTACT_GETBYENTITYIDS]
	@ENTITYIDS AS RECORDIDS READONLY
AS
BEGIN

SET NOCOUNT ON;
SELECT 
	PMPERMITCONTACT.PMPERMITID ENTITYID,
	GLOBALENTITY.FIRSTNAME,
	GLOBALENTITY.LASTNAME,
	LANDMANAGEMENTCONTACTTYPE.NAME TYPENAME,
	GLOBALENTITY.EMAIL,
	GLOBALENTITY.GLOBALENTITYNAME,
	GLOBALENTITY.GLOBALENTITYID
FROM PMPERMITCONTACT
INNER JOIN LANDMANAGEMENTCONTACTTYPE on PMPERMITCONTACT.LANDMANAGEMENTCONTACTTYPEID = LANDMANAGEMENTCONTACTTYPE.LANDMANAGEMENTCONTACTTYPEID
INNER JOIN GLOBALENTITY on GLOBALENTITY.GLOBALENTITYID = PMPERMITCONTACT.GLOBALENTITYID
WHERE PMPERMITCONTACT.PMPERMITID IN (SELECT RECORDID from @ENTITYIDS)
UNION ALL
SELECT 
	PLPLANCONTACT.PLPLANID ENTITYID,
	GLOBALENTITY.FIRSTNAME,
	GLOBALENTITY.LASTNAME,
	LANDMANAGEMENTCONTACTTYPE.NAME TYPENAME,
	GLOBALENTITY.EMAIL,
	GLOBALENTITY.GLOBALENTITYNAME,
	GLOBALENTITY.GLOBALENTITYID
FROM PLPLANCONTACT
INNER JOIN LANDMANAGEMENTCONTACTTYPE on PLPLANCONTACT.LANDMANAGEMENTCONTACTTYPEID = LANDMANAGEMENTCONTACTTYPE.LANDMANAGEMENTCONTACTTYPEID
INNER JOIN GLOBALENTITY on GLOBALENTITY.GLOBALENTITYID = PLPLANCONTACT.GLOBALENTITYID
WHERE PLPLANCONTACT.PLPLANID IN (SELECT RECORDID from @ENTITYIDS)

END