CREATE PROCEDURE [managebusiness].[USP_FIREOCCUPANTBUSINESSCONTACTADDRESS_GETBYGLOBALENTITYIDS]
(
	@GLOBALENTITYIDS RecordIDs READONLY
)
AS
BEGIN
	SET NOCOUNT ON;  
	SELECT 
		GLOBALENTITYMAILINGADDRESS.GLOBALENTITYID,
		GLOBALENTITYMAILINGADDRESS.GLOBALENTITYMAILINGADDRESSID, 
		MAILINGADDRESS.ADDRESSLINE1,
		MAILINGADDRESS.ADDRESSLINE2,
		MAILINGADDRESS.ADDRESSLINE3,
		MAILINGADDRESS.ADDRESSTYPE,
		MAILINGADDRESS.ATTN,
		MAILINGADDRESS.CITY,
		MAILINGADDRESS.COMPSITE,
		MAILINGADDRESS.COUNTRY,
		MAILINGADDRESSCOUNTRYTYPE.MAILINGADDRESSCOUNTRYTYPEID,
		MAILINGADDRESSCOUNTRYTYPE.MAILINGADDRESSCOUNTRYTYPENAME,
		GLOBALENTITYMAILINGADDRESS.MAIN,
		MAILINGADDRESS.POBOX,
		MAILINGADDRESS.POSTALCODE,
		MAILINGADDRESS.POSTDIRECTION,
		MAILINGADDRESS.PREDIRECTION,
		MAILINGADDRESS.PROVINCE,
		MAILINGADDRESS.RURALROUTE,
		MAILINGADDRESS.STATE,
		MAILINGADDRESS.STATION,
		MAILINGADDRESS.STREETTYPE,
		MAILINGADDRESS.UNITORSUITE,
		MAILINGADDRESS.ADDRESSID
	FROM GLOBALENTITYMAILINGADDRESS 
	INNER JOIN MAILINGADDRESS ON GLOBALENTITYMAILINGADDRESS.MAILINGADDRESSID = MAILINGADDRESS.MAILINGADDRESSID
	INNER JOIN MAILINGADDRESSCOUNTRYTYPE ON MAILINGADDRESS.COUNTRYTYPE = MAILINGADDRESSCOUNTRYTYPE.MAILINGADDRESSCOUNTRYTYPEID
	WHERE GLOBALENTITYMAILINGADDRESS.GLOBALENTITYID in (SELECT RECORDID FROM @GLOBALENTITYIDS) AND GLOBALENTITYMAILINGADDRESS.MAIN = 1
END