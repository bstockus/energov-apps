CREATE PROCEDURE [managebusiness].[USP_GETBALANCEDUE_BY_BLGLOBALENTITYEXTENDIONID]
(
    @BLGLOBALENTITYEXTENSIONID CHAR(36),
    @CURRENTDATE DATETIME
)
AS
BEGIN
    SET NOCOUNT ON;
    ;WITH DUEAMOUNT (DUE) AS (
		SELECT [MANAGEBUSINESS].[UFN_GET_BLLICENSE_BALANCE_DUE](@BLGLOBALENTITYEXTENSIONID, @CURRENTDATE) DUE
	UNION ALL
		SELECT [MANAGEBUSINESS].[UFN_GET_TAXREMITTANCE_BALANCE_DUE](@BLGLOBALENTITYEXTENSIONID) DUE
    UNION ALL
		SELECT [MANAGEBUSINESS].[UFN_GET_BLGLOBALENTITYEXTENSIONPARENTC_BALANCE_DUE](@BLGLOBALENTITYEXTENSIONID) DUE
    UNION ALL
		SELECT [MANAGEBUSINESS].[UFN_GET_BLGLOBALENTITYEXTENSION_BALANCE_DUE](@BLGLOBALENTITYEXTENSIONID) DUE
    UNION ALL
		SELECT [MANAGEBUSINESS].[UFN_GET_CMCODECASE_BALANCE_DUE](@BLGLOBALENTITYEXTENSIONID) DUE)
    SELECT SUM(DUE) AS BALANCEDUE
    FROM DUEAMOUNT;
END;