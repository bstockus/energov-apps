CREATE PROCEDURE [managebusiness].[USP_FIREOCCUPANTBUSINESSADDRESS_GETBYGLOBALENTITYEXTENSIONID]
(
@BLGLOBALENTITYEXTENSIONID CHAR(36)
)
AS
BEGIN
	SET NOCOUNT ON;

	DECLARE @businessSystemActionTypeId CHAR(36) ='4C8DD115-5DDD-47F7-858D-0D388D4B21AE'
	DECLARE @locationSystemActionTypeId CHAR(36) = '5ddc7c6b-e72a-4c58-976d-b87e8222632e'

	SELECT 
		BLGLOBALENTITYEXTENSIONADDRESS.BLGLOBALENTITYEXTENSIONID,
		BLGLOBALENTITYEXTENSIONADDRESS.BLGLOBALENTITYEXTADDRESSID, 
		MAILINGADDRESS.ADDRESSLINE1,
		MAILINGADDRESS.ADDRESSLINE2,
		MAILINGADDRESS.ADDRESSLINE3,
		MAILINGADDRESS.ADDRESSTYPE,
		MAILINGADDRESS.ATTN,
		MAILINGADDRESS.CITY,
		MAILINGADDRESS.COMPSITE,
		MAILINGADDRESS.COUNTRY,
		MAILINGADDRESSCOUNTRYTYPE.MAILINGADDRESSCOUNTRYTYPEID,
		MAILINGADDRESSCOUNTRYTYPE.MAILINGADDRESSCOUNTRYTYPENAME,
		BLGLOBALENTITYEXTENSIONADDRESS.MAIN,
		MAILINGADDRESS.POBOX,
		MAILINGADDRESS.POSTALCODE,
		MAILINGADDRESS.POSTDIRECTION,
		MAILINGADDRESS.PREDIRECTION,
		MAILINGADDRESS.PROVINCE,
		MAILINGADDRESS.RURALROUTE,
		MAILINGADDRESS.STATE,
		MAILINGADDRESS.STATION,
		MAILINGADDRESS.STREETTYPE,
		MAILINGADDRESS.UNITORSUITE,
		MAILINGADDRESS.ADDRESSID,
		PARCEL.PARCELID,
		PARCEL.TAXNUMBER
	FROM BLGLOBALENTITYEXTENSIONADDRESS 
	INNER JOIN MAILINGADDRESS ON BLGLOBALENTITYEXTENSIONADDRESS.MAILINGADDRESSID = MAILINGADDRESS.MAILINGADDRESSID
	INNER JOIN MAILINGADDRESSCOUNTRYTYPE ON MAILINGADDRESS.COUNTRYTYPE = MAILINGADDRESSCOUNTRYTYPE.MAILINGADDRESSCOUNTRYTYPEID
	INNER JOIN MAILINGADDRESSTYPE ON MAILINGADDRESSTYPE.MAILINGADDRESSTYPENAME = MAILINGADDRESS.ADDRESSTYPE
	LEFT OUTER JOIN PARCEL ON PARCEL.PARCELID = MAILINGADDRESS.PARCELID
	WHERE BLGLOBALENTITYEXTENSIONADDRESS.BLGLOBALENTITYEXTENSIONID = @BLGLOBALENTITYEXTENSIONID
	AND MAILINGADDRESSTYPE.SYSTEMACTIONID IN (@businessSystemActionTypeId, @locationSystemActionTypeId)
END