CREATE PROCEDURE [managecontacts].[USP_INVOICES_DUE_ADDRESS_CHILDREN]        
(@GLOBALENTITYID CHAR(36))        
AS        
BEGIN        
    SET NOCOUNT ON;        

SELECT     
[GLOBALENTITY].[GLOBALENTITYID] AS PARENTID,
[GLOBALENTITYMAILINGADDRESS].[GLOBALENTITYMAILINGADDRESSID] AS ENTITYID,
[MAILINGADDRESS].[ADDRESSLINE1],    
[MAILINGADDRESS].[ADDRESSLINE2],    
[MAILINGADDRESS].[ADDRESSLINE3],
[MAILINGADDRESS].[ADDRESSTYPE] AS ADDRESSTYPENAME,
[MAILINGADDRESS].[ATTN],
[MAILINGADDRESS].[CITY],
[MAILINGADDRESS].[COMPSITE] AS CompSite,
[MAILINGADDRESS].[COUNTRY] AS COUNTRYNAME,
[MAILINGADDRESSCOUNTRYTYPE].[MAILINGADDRESSCOUNTRYTYPEID] AS COUNTRYTYPEID,
[MAILINGADDRESSCOUNTRYTYPE].[MAILINGADDRESSCOUNTRYTYPENAME] AS COUNTRYTYPENAME,
[GLOBALENTITYMAILINGADDRESS].[MAIN] AS ISMAIN,
[MAILINGADDRESS].[POBOX],
[MAILINGADDRESS].[POSTALCODE],
[MAILINGADDRESS].[POSTDIRECTION] AS POSTALDIRECTION,
[MAILINGADDRESS].[PREDIRECTION],
[MAILINGADDRESS].[PROVINCE] AS PROVINCENAME,
[MAILINGADDRESS].[RURALROUTE],
[MAILINGADDRESS].[STATE],
[MAILINGADDRESS].[STATION],
[MAILINGADDRESS].[STREETTYPE] AS STREETTYPENAME,
[MAILINGADDRESS].[UNITORSUITE],
[MAILINGADDRESS].[ADDRESSID]
FROM     
[dbo].[GLOBALENTITY] 
JOIN [dbo].[GLOBALENTITYMAILINGADDRESS] ON [GLOBALENTITY].[GLOBALENTITYID] = [GLOBALENTITYMAILINGADDRESS].[GLOBALENTITYID]  
JOIN [dbo].[MAILINGADDRESS] ON [MAILINGADDRESS].[MAILINGADDRESSID] = [GLOBALENTITYMAILINGADDRESS].[MAILINGADDRESSID]    
LEFT OUTER JOIN [dbo].[MAILINGADDRESSCOUNTRYTYPE] ON [MAILINGADDRESS].[COUNTRYTYPE] = [MAILINGADDRESSCOUNTRYTYPE].[MAILINGADDRESSCOUNTRYTYPEID]
WHERE [GLOBALENTITY].[GLOBALENTITYID] = @GLOBALENTITYID    
   
END;