CREATE PROCEDURE [managebusinesslicense].[USP_BLBATCHRENEWAL_GET_BY_ID]
(
	@BULKRENEWALID AS CHAR(36)
)
AS
BEGIN
	SELECT	[dbo].[BLBATCHRENEWAL].[BLBATCHRENEWALID], 
				[dbo].[BLBATCHRENEWAL].[BATCHRENEWALNUMBER], 
				[dbo].[BLLICENSETYPEMODULE].[BLLICENSETYPEMODULEID] AS MODULEID, 
				[dbo].[BLLICENSETYPEMODULE].[NAME] AS MODULENAME, 
				[dbo].[BLBATCHRENEWAL].[PROCESSEDDATE],
				BatchRecords.TOTALCOUNT, 
				BatchRecords.PROCESSEDCOUNT,
				BatchRecords.[FAILEDCOUNT], 
				[dbo].[USERS].[FNAME], 
				[dbo].[USERS].[LNAME], 
				[dbo].[BLBATCHRENEWAL].[CREATEDATE]
	FROM [dbo].[BLBATCHRENEWAL]
	JOIN [managebusinesslicense].[UDF_GET_BULKRENEWAL_COUNTS]() BatchRecords ON [dbo].[BLBATCHRENEWAL].[BLBATCHRENEWALID] = BatchRecords.[BLBATCHRENEWALID]
	LEFT JOIN [dbo].[USERS] ON [dbo].[BLBATCHRENEWAL].[CREATEDBY] = [dbo].[USERS].[SUSERGUID]
	LEFT JOIN [dbo].[BLLICENSETYPEMODULE] ON [dbo].[BLBATCHRENEWAL].[BLLICENSETYPEMODULEID] = [dbo].[BLLICENSETYPEMODULE].[BLLICENSETYPEMODULEID]
	WHERE [dbo].[BLBATCHRENEWAL].[BLBATCHRENEWALID] = @BULKRENEWALID

	EXEC [managebusinesslicense].[USP_BLBATCHRENEWALBLLICENSE_GET_BY_PARENTID] @BULKRENEWALID
	EXEC [managebusinesslicense].[USP_BLBATCHRENEWALLOG_GET_BY_PARENTID] @BULKRENEWALID
END