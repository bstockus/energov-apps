CREATE PROCEDURE [teams].[USP_TEAMINFO_GETBYMEMBERS_LISTING]
	@TeamMembers RecordIDs readonly,
	@RESOURCE_SYSTEM_TYPE_ID INT
AS

SELECT DISTINCT
	[dbo].[TEAM].[TEAMID],
	[dbo].[TEAM].[NAME] AS TEAMNAME,
	[dbo].[TEAM].[USERID],
	[dbo].[USERS].[FNAME] AS USERFIRSTNAME,
	[dbo].[USERS].[LNAME] AS USERLASTNAME,
	[dbo].[TEAM].[TEAMIMAGE]
FROM [dbo].[TEAM]
INNER JOIN [dbo].[USERS] ON [dbo].[TEAM].[USERID] = [dbo].[USERS].[SUSERGUID]
WHERE [dbo].[TEAM].[USERID] IN (SELECT RECORDID FROM @TEAMMEMBERS) OR 
TEAM.TEAMID IN 
(SELECT TEAMID
	FROM [dbo].[TEAMRESOURCE]
	INNER JOIN [dbo].[RESOURCETYPE] ON [dbo].[RESOURCETYPE].[RESOURCETYPEID] = [dbo].[TEAMRESOURCE].[RESOURCETYPEID]
	WHERE [dbo].[RESOURCETYPE].[RESOURCESYSTEMTYPEID] = @RESOURCE_SYSTEM_TYPE_ID
	AND ([dbo].[TEAMRESOURCE].[USERID] IN (SELECT RECORDID FROM @TEAMMEMBERS)
))
ORDER BY [TEAM].[NAME]