CREATE PROCEDURE [teams].[USP_TEAM_MEMBERS_GETBYTEAMIDS_LISTING]
	@Teams RecordIDs readonly,
	@RESOURCE_SYSTEM_TYPE_ID INT
AS
SET NOCOUNT ON;
SELECT DISTINCT
	[dbo].[TEAM].[TEAMID],
	[dbo].[TEAM].[NAME] AS TEAMNAME,
	[dbo].[USERS].[SUSERGUID] AS USERID,
	[dbo].[USERS].[FNAME] AS USERFIRSTNAME,
	[dbo].[USERS].[LNAME] AS USERLASTNAME,
	[dbo].[TEAM].[TEAMIMAGE]
FROM [dbo].[TEAMRESOURCE]
INNER JOIN [dbo].[TEAM] ON [dbo].[TEAM].[TEAMID] = [dbo].[TEAMRESOURCE].[TEAMID]
INNER JOIN [dbo].[USERS] ON [dbo].[TEAM].[USERID] = [dbo].[USERS].[SUSERGUID] OR [dbo].[TEAMRESOURCE].[USERID] = [dbo].[USERS].[SUSERGUID]
INNER JOIN [dbo].[RESOURCETYPE] ON [dbo].[RESOURCETYPE].[RESOURCETYPEID] = [dbo].[TEAMRESOURCE].[RESOURCETYPEID]
WHERE  
	[dbo].[RESOURCETYPE].[RESOURCESYSTEMTYPEID] = @RESOURCE_SYSTEM_TYPE_ID
	AND [dbo].[TEAM].[TEAMID] IN (SELECT RECORDID FROM @Teams)
ORDER BY [dbo].[TEAM].[NAME]