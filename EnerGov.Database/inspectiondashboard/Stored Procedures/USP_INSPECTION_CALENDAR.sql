CREATE PROCEDURE [inspectiondashboard].[USP_INSPECTION_CALENDAR]
(	
	@ID CHAR(36)
)
AS

SET NOCOUNT ON;

DECLARE @CALENDARID AS CHAR(36) = 
(
	SELECT TOP 1 [dbo].[IMINSPECTIONCALENDAR].[IMINSPECTIONCALENDARID] 
	FROM [dbo].[IMINSPECTIONCALENDAR]
	INNER JOIN [dbo].[IMINSPECTIONTYPE] ON 
		[dbo].[IMINSPECTIONTYPE].[IMINSPECTIONTYPEID] = @ID AND 
		[dbo].[IMINSPECTIONTYPE].[IMINSPECTIONCALENDARID] = [dbo].[IMINSPECTIONCALENDAR].[IMINSPECTIONCALENDARID]
)

SELECT
	[dbo].[IMINSPECTIONCALENDAR].[IMINSPECTIONCALENDARID],
	[dbo].[IMINSPECTIONCALENDAR].[USESYSTEMHOLIDAYS]
FROM [dbo].[IMINSPECTIONCALENDAR]
WHERE [dbo].[IMINSPECTIONCALENDAR].[IMINSPECTIONCALENDARID] = @CALENDARID


SELECT
	[dbo].[IMINSPECTIONTYPE].[IMINSPECTIONTYPEID]
FROM [dbo].[IMINSPECTIONTYPE]
WHERE [dbo].[IMINSPECTIONTYPE].[IMINSPECTIONCALENDARID] = @CALENDARID
ORDER BY [dbo].[IMINSPECTIONTYPE].[IMINSPECTIONTYPEID]

SELECT
	[dbo].[IMINSPECTIONCALHOLIDAY].[HOLIDAYDATE]
FROM [dbo].[IMINSPECTIONCALHOLIDAY]
WHERE [dbo].[IMINSPECTIONCALHOLIDAY].[IMINSPECTIONCALENDARID] = @CALENDARID
ORDER BY [dbo].[IMINSPECTIONCALHOLIDAY].[HOLIDAYDATE]

SELECT
	[dbo].[IMINSPECTIONCALWORKWEEK].[DAYOFWEEK]
FROM [dbo].[IMINSPECTIONCALWORKWEEK]
WHERE [dbo].[IMINSPECTIONCALWORKWEEK].[IMINSPECTIONCALENDARID] = @CALENDARID AND [dbo].[IMINSPECTIONCALWORKWEEK].[ISWORKINGDAY] = 1
ORDER BY [dbo].[IMINSPECTIONCALWORKWEEK].[DAYOFWEEK]