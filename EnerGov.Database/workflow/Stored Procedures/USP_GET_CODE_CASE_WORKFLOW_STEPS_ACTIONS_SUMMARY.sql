CREATE PROCEDURE [workflow].[USP_GET_CODE_CASE_WORKFLOW_STEPS_ACTIONS_SUMMARY]
	@ID CHAR(36)
	
AS
SET NOCOUNT ON;

SELECT
	[dbo].[CMCODEWFSTEP].[CMCODEWFSTEPID],
	[dbo].[CMCODEWFSTEP].[WORKFLOWSTATUSID],
	[dbo].[CMCODEWFSTEP].[PRIORITYORDER],
	[dbo].[CMCODEWFSTEP].[SORTORDER],
	[dbo].[CMCODEWFSTEP].[NOPRIORITY],
	[dbo].[CMCODEWFSTEP].[NAME],
	[dbo].[CMCODEWFSTEP].[VERSIONNUMBER],
	[dbo].[CMCODEWFSTEP].[WFSTEPTYPEID],
	[dbo].[CMCODEWFSTEP].[CMCODEWFPARENTSTEPID]
FROM [dbo].[CMCODEWFSTEP]
WHERE [dbo].[CMCODEWFSTEP].[CMCODECASEID] = @ID
ORDER BY [dbo].[CMCODEWFSTEP].[PRIORITYORDER], [dbo].[CMCODEWFSTEP].[SORTORDER]


SELECT
	[dbo].[CMCODEWFACTIONSTEP].[CMCODEWFACTIONSTEPID],
	[dbo].[CMCODEWFACTIONSTEP].[CMCODEWFSTEPID],
	[dbo].[CMCODEWFACTIONSTEP].[WORKFLOWSTATUSID],
	[dbo].[CMCODEWFACTIONSTEP].[PRIORITYORDER],
	[dbo].[CMCODEWFACTIONSTEP].[SORTORDER],
	[dbo].[CMCODEWFACTIONSTEP].[NOPRIORITY],
	[dbo].[CMCODEWFACTIONSTEP].[NAME],
	[dbo].[CMCODEWFACTIONSTEP].[VERSIONNUMBER],
	[dbo].[CMCODEWFACTIONSTEP].[STARTDATE],
	[dbo].[CMCODEWFACTIONSTEP].[ENDDATE],
	[dbo].[CMCODEWFACTIONSTEP].[WFACTIONTYPEID],
	[dbo].[WFACTIONTYPE].[NAME],
	[dbo].[CMCODEWFACTIONSTEP].[RPTREPORTID],
	[dbo].[CMCODEWFACTIONSTEP].[CMCODEWFPARENTACTIONSTEPID],
	[dbo].[CMCODEWFACTIONSTEP].[LASTCHANGEDBY],
	'' AS SUBMITTALS,
	[dbo].[CMCODEWFACTIONSTEP].[IMINSPECTIONTYPEID]
FROM [dbo].[CMCODEWFACTIONSTEP]
INNER JOIN [dbo].[CMCODEWFSTEP] ON [dbo].[CMCODEWFSTEP].[CMCODEWFSTEPID] = [dbo].[CMCODEWFACTIONSTEP].[CMCODEWFSTEPID]
INNER JOIN [dbo].[WFACTIONTYPE] ON [dbo].[WFACTIONTYPE].[WFACTIONTYPEID] = [dbo].[CMCODEWFACTIONSTEP].[WFACTIONTYPEID]
INNER JOIN [dbo].[USERS] ON [dbo].[USERS].[SUSERGUID] = [dbo].[CMCODEWFACTIONSTEP].[LASTCHANGEDBY]
WHERE [dbo].[CMCODEWFSTEP].[CMCODECASEID] = @ID
ORDER BY [dbo].[CMCODEWFACTIONSTEP].[CMCODEWFSTEPID], [dbo].[CMCODEWFACTIONSTEP].[PRIORITYORDER], [dbo].[CMCODEWFACTIONSTEP].[SORTORDER]